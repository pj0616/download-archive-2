!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.InfiniteList=t():e.InfiniteList=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){var r=n(2),i=n(3),o=n(5),f=n(6),a=n(4);DEFAULT_ITEM_HEIGHT=2;var u=function(e){function t(e,t){return y=e,s(e),T=new i(E),H=new f(e,x,v,p,function(){D=!0},function(){console.error("done refreshing"),D=!1,g(!0)}),w=new r(y,function(e){O=e||0,M=!0},t),w.setDimensions(Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),window.addEventListener("resize",m.bind(this)),u(),m(),this}function n(){o.stopAnimationLoop(),y.removeChild(E),window.removeEventListener("resize",m.bind(this))}function u(){o.startAnimationLoop(function(){M&&h()})}function l(e){if(v.itemHeightGetter)for(var t=e||0;t<=v.itemsCount;++t)R[t]=v.itemHeightGetter(t)}function s(e){x=document.createElement("div"),a.applyElementStyle(x,{position:"absolute",top:0,bottom:0}),E=document.createElement("div"),a.applyElementStyle(E,{position:"relative",height:e.clientHeight+"px",width:e.clientWidth+"px",overflow:"hidden"}),E.appendChild(x),e.appendChild(E)}function m(){var e=H.getRenderedItems()[0],t=e&&e.getItemIndex()||0,n=e&&e.getItemOffset()||0,r=O-n;I=y.clientHeight,a.applyElementStyle(E,{height:y.clientHeight+"px",width:y.clientWidth+"px"}),H.refresh(),l(),T.refresh(),d(t,!1,r)}function g(e){var t=v.itemsCount-1+(v.hasMore?1:0),n=H.getRenderedItems(),r=n[n.length-1],i=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,f=v.pullToRefresh.height;n.length>0&&0==n[0].getItemIndex()&&(i=n[0].getItemOffset()),r&&r.getItemIndex()==t&&(o=r.getItemOffset()+r.getItemHeight()-I),i=D?i-f:i,w.setDimensions(i,o),e&&i>O&&w.scrollTo(i,!0)}function h(){var e;g(),a.applyTransformStyle(x,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+-O+", 0, 1)"),M=H.render(O,L,b,w.isPressed&&w.isPressed()),e=H.getRenderedItems(),L=null,b=null,e.forEach(function(e){R[e.getItemIndex()]=e.getItemHeight()});for(var t=0,n=0,r=0;r<R.length;++r)"number"==typeof R[r]&&(t+=R[r],n++);t/=n,T.render(t*e[0].getItemIndex()+O-e[0].getItemOffset(),t*v.itemsCount)}function p(){v.pageFetcher(v.itemsCount,function(e,t){v.hasMore=t,v.itemsCount+=e,l(v.itemsCount-e),w.scrollTo(H.getRenderedItems()[H.getRenderedItems().length-1].getItemOffset()-I)})}function d(e,t,n){var r=0;if(v.itemHeightGetter)for(var i=0;i<e;++i)r+=v.itemHeightGetter(i);else L=e;b=n||0,w.scrollTo(r,v.itemHeightGetter&&t)}function c(e){var t=H.getRenderedItems(),n=t.filter(function(t){return t.getItemIndex()==e})[0];if(n){var r=v.itemHeightGetter&&v.itemHeightGetter(e);n.getItemOffset();r||(r=n.getDomElement().clientHeight),n.setItemHeight(r);var i=n.getItemIndex()-t[0].getItemIndex(),o=t[i+1];if(n.getItemOffset()<O)for(;o&&n;)n.setItemOffset(o.getItemOffset()-n.getItemHeight()),o=n,n=t[--i];else for(;o&&n;)o.setItemOffset(n.getItemOffset()+n.getItemHeight()),n=o,o=t[++i+1]}}var I,v={itemHeightGetter:null,itemRenderer:null,itemTypeGetter:null,pageFetcher:null,loadMoreRenderer:function(e,t){t.innerHTML='<div style="margin-left:14px;height:50px">Loading...</div>'},hasMore:!1,pullToRefresh:{height:null,idleRenderer:null,busyRenderer:null,beginRefreshAtOffset:null,onRefresh:null},itemsCount:0},y=null,E=null,x=null,T=null,H=null,w=null,R=[],O=0,L=0,b=0,M=!0,D=!1;for(var G in e)e.hasOwnProperty(G)&&(v[G]=e[G]);var S=e.initialPage;return S&&(v.itemsCount=S.itemsCount||0,v.hasMore=S.hasMore||!1),{attach:t,detach:n,scrollToItem:d,refresh:m,refreshItemHeight:c}};e.exports=u},function(e,t){var n=525,r=function(e,t){function r(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function i(e){x=e,t(e)}function o(){var e,t,r;if(v)if(e=Date.now()-h,t=v*Math.exp(-e/n),r=T-t,r<p){if(T-t>=p-2)return void i(p);f(!0)}else if(r>d){if(T-t<=d+2)return void i(d);f(!1)}else t>2||t<-2?(i(T-t),requestAnimationFrame(o)):i(T)}function f(e){var t=e?p:d,r=e&&v>0||!e&&v<0;if(0!=v){var o=Date.now()-h,a=v*Math.exp(-o/(T==t?125:n));if(r&&Math.abs(a)<2)return void i(e?p:d);i(T-a),r?T!=t&&(T=t,v=T-x,h=new Date):(T=t-.1*(t-T),v=T-x),requestAnimationFrame(function(){f(e)})}}function a(e){y=!0,E=r(e),I=v=0,c=x,h=Date.now(),l(e),e.stopPropagation()}function u(e){var t,n,o=x<p||x>d?.5:1;y&&(l(e),t=r(e),n=E-t,(n>2||n<-2)&&(E=t,i(x+n*o))),e.preventDefault(),e.stopPropagation()}function l(e){var t=e.touches||[{pageX:e.pageX,pageY:e.pageY}],n=e.timeStamp,r=t[0].pageY;2===t.length&&(r=Math.abs(t[0].pageY+t[1].pageY)/2),H.push({offset:r,timestamp:n}),H.length>60&&H.splice(0,30)}function s(e){y=!1;for(var t=H.length-1,n=t-1,r=t-1;r>0&&H[r].timestamp>H[t].timestamp-100;r-=1)n=r;var i=H[t].timestamp-H[n].timestamp,f=H[t].offset-H[n].offset,a=-1e3*f/(1+i);I=.8*a+.2*I,v=1*I,T=Math.round(x+v),h=Date.now(),requestAnimationFrame(o),e.stopPropagation()}function m(e,t){var n=4e3;t?(e-x>n?x=e-n:x-e>n&&(x=e+n),v=e-x,T=e,h=Date.now(),requestAnimationFrame(o)):(v=0,i(e))}function g(e,t){p=e,d=t}var h=0,p=0,d=0,c=0,I=0,v=0,y=0,E=0,x=0,T=0,H=[];return e.addEventListener("touchstart",a),e.addEventListener("touchmove",u),e.addEventListener("touchend",s),e.addEventListener("mousedown",a),e.addEventListener("mousemove",u),e.addEventListener("mouseup",s),{setDimensions:g,scrollTo:m,isPressed:function(){return y}}};e.exports=r},function(e,t,n){var r=n(4),i=function(e){function t(t,n){var f=(e.parentElement,Math.max(10,Math.floor(o/n*o))),a=Math.floor(t/(n-o)*(o-f)),u=f+"px";r.applyElementStyle(i,{height:u}),r.applyTransformStyle(i,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+a+", 0, 1)")}function n(){o=e.parentElement.clientHeight}var i=document.createElement("div"),o=e.parentElement.clientHeight;return r.applyElementStyle(i,{position:"absolute",top:"0px",right:"0px",marginRight:"3px",opacity:.3,width:"5px",backgroundColor:"#333"}),e.appendChild(i),{render:t,refresh:n}};e.exports=i},function(e,t){var n=function(e,t){Object.keys(t).forEach(function(n){e.style[n]!=t[n]&&(e.style[n]=t[n])})},r=function(e,t){var r={};["webkit","Moz","O","ms"].forEach(function(e){r[e+"Transform"]=t}),n(e,r)};e.exports={applyElementStyle:n,applyTransformStyle:r}},function(e,t){function n(e){var t=(new Date).getTime(),n=0;f=!0;var r=function(){var i=(new Date).getTime();n++,i-t>200&&(o=Math.min(60,1e3*n/(i-t)),t=i,n=0),e(),f&&requestAnimationFrame(r)};requestAnimationFrame(r)}function r(){f=!1}function i(){return o}var o=60,f=!1;e.exports={startAnimationLoop:n,stopAnimationLoop:r,getFPS:i}},function(e,t,n){var r=n(7),i=n(8),o=(n(4),n(5),30),f=1e3/o,a=function(e,t,n,o,a,u){function l(e,t,r,i){var o=(new Date).getTime();if("number"==typeof t&&t>=0){for(;E.length>0;)x.addLayer(E.pop());var a=g(t);a.setItemOffset(e-(r||0)),E.push(a)}for(var u=E[0],p=E[E.length-1];u&&u.getItemOffset()>e&&u.getItemIndex()>0;)if(u=s(u),(new Date).getTime()-o>f)return!0;if(0==u.getItemIndex()&&h(e,u.getItemOffset(),i),p.getItemIndex()<n.itemsCount&&"$LoadMore"==p.getIdentifier()){var d=p.getItemIndex();if(x.addLayer(E.pop()),!(E.length>0))return l(e,d);p=E[E.length-1]}for(;p&&p.getItemOffset()+p.getItemHeight()<e+v&&p.getItemIndex()<n.itemsCount;)if(p=m(p),(new Date).getTime()-o>f)return!0;for(;E.length>1&&u&&u.getItemOffset()+u.getItemHeight()<e;)x.addLayer(E.shift()),u=E[0];for(;E.length>1&&p&&p.getItemOffset()>e+v;)x.addLayer(E.pop()),p=E[E.length-1];return!1}function s(e){var t=g(e.getItemIndex()-1);return t&&(t.setItemOffset(e.getItemOffset()-t.getItemHeight()),E.unshift(t)),t}function m(e){var t=g(e.getItemIndex()+1);return t&&(t.setItemOffset(e.getItemOffset()+e.getItemHeight()),E.push(t)),t}function g(e){if(e==n.itemsCount)return n.hasMore?d():null;var t=n.itemTypeGetter?n.itemTypeGetter(e):"",r=n.itemHeightGetter&&n.itemHeightGetter(e),i=p(e,t,r);return n.itemRenderer(e,i.getDomElement()),i}function h(e,t,r){if(n.pullToRefresh&&n.pullToRefresh.height){var i=n.pullToRefresh,o=i.height,f=i.idleRenderer,l=i.busyRenderer,s=i.beginRefreshAtOffset,m=i.onRefresh;if(e<t){if(!T){var g="$pullToRefresh$";T=p(-1,g,o),f(T.getDomElement())}var h=t-e;h>=(s||o)&&(r||w)||H?l(T.getDomElement()):f(T.getDomElement()),!H&&h>=(s||o)&&!r&&w&&(H=!0,a(o),m(function(){H=!1,u()})),w=r,T.setItemOffset(t-o)}}}function p(e,i,o){var f=i||(n.itemTypeGetter?n.itemTypeGetter(e):""),a=x.borrowLayerWithIdentifier(f);null==a&&(a=new r(t));var u=o||n.itemHeightGetter&&n.itemHeightGetter(e);return a.attach(e,y-9,u,f),a}function d(){if(0==E.length||"$LoadMore"!=E[E.length-1].getIdentifier()){var e=p(n.itemsCount,"$LoadMore");return n.loadMoreRenderer(n.itemsCount,e.getDomElement()),o(),e}return E[E.length-1]}function c(){v=e.clientHeight,y=e.clientWidth,E.forEach(function(e){x.addLayer(e,!0)}),E=[]}function I(){return E}var v=e.clientHeight,y=e.clientWidth,E=[],x=new i,T=null,H=!1,w=!1;return n.pullToRefresh&&h(),{render:l,refresh:c,getRenderedItems:I}};e.exports=a},function(e,t,n){var r=n(4),i=function(e){function t(e,t,n,i){return p=e,d=n,r.applyElementStyle(m,{width:t+"px",height:n+"px",overflow:"hidden"}),d=n,g=i,this}function n(){return p}function i(){return m}function o(){return g}function f(){return h}function a(e){r.applyTransformStyle(m,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+e+", 0, 1)"),h=e}function u(){return d||(d=i().clientHeight)}function l(e){d=e}function s(){var e=document.createElement("div");return r.applyElementStyle(e,{position:"absolute",top:0,left:0}),e}var m=null,g="",h=-1,p=-1,d=0;return m=s(),e.appendChild(m),{attach:t,getItemIndex:n,getDomElement:i,getItemOffset:f,setItemOffset:a,getItemHeight:u,setItemHeight:l,getIdentifier:o}};e.exports=i},function(e,t,n){var r=n(4),i=function(){function e(e,t){var i=e.getIdentifier();null==n[i]&&(n[i]=[]),n[i].push(e),e.setItemOffset(-1e4),r.applyElementStyle(e.getDomElement(),{display:"none"}),t&&r.applyElementStyle(e.getDomElement(),{display:"none"})}function t(e){if(null==n[e])return null;var t=n[e].pop();return null!=t&&r.applyElementStyle(t.getDomElement(),{display:"block"}),t}var n={};return{addLayer:e,borrowLayerWithIdentifier:t}};e.exports=i}])});