{
  "componentChunkName": "component---src-templates-directory-index-js",
  "path": "/cheatsheets/db",
  "result": {
    "pageContext": {
      "slug": "cheatsheets/db",
      "hasIndex": false,
      "meta": {
        "id": "d80cd99f-66ca-55ed-bd82-9045462e43e3",
        "name": "db",
        "absolutePath": "/opt/build/repo/md/cheatsheets/db",
        "relativePath": "md/cheatsheets/db",
        "children": {
          "dirs": [],
          "md": [
            {
              "id": "62eeaf1e-cd36-5fb2-872d-07480314785c",
              "fileAbsolutePath": "/opt/build/repo/md/cheatsheets/db/db-misc.md",
              "html": "<!-- @TODO - Should this become /db/index.md? Separate web section? -->\n<h2 id=\"resources\" style=\"position:relative;\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Resources</h2>\n<table>\n<thead>\n<tr>\n<th>What &#x26; Link</th>\n<th>Type</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Fireship - <a href=\"https://www.youtube.com/watch?v=W2Z7fbCLSTw\" target=\"_blank\" rel=\"nofollow noopener\">7 Database Paradigms</a></td>\n<td>YT Video</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"browser-based-databases-comparison\" style=\"position:relative;\"><a href=\"#browser-based-databases-comparison\" aria-label=\"browser based databases comparison permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Browser Based Databases Comparison</h2>\n<p>See my blog post: <a href=\"https://joshuatz.com/posts/2020/offline-first-database-options-for-web-applications-in-2020/\" target=\"_blank\" rel=\"nofollow noopener\">\"Offline-First Database Options for Web Applications in 2020\"</a></p>",
              "fields": {
                "title": "Db Misc",
                "slug": "/cheatsheets/db/db-misc/",
                "modifiedStampMs": 1602573076000,
                "createdStampMs": 1600725324000
              },
              "parent": {
                "absolutePath": "/opt/build/repo/md/cheatsheets/db/db-misc.md",
                "relativePath": "cheatsheets/db/db-misc.md",
                "base": "db-misc.md",
                "name": "db-misc"
              }
            },
            {
              "id": "a7e8b593-9921-5be8-9eec-315197d4e5bc",
              "fileAbsolutePath": "/opt/build/repo/md/cheatsheets/db/dexie-js.md",
              "html": "<h2 id=\"resources\" style=\"position:relative;\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Resources</h2>\n<p>Some important links:</p>\n<ul>\n<li><a href=\"https://dexie.org/docs/Version/Version.stores()\" target=\"_blank\" rel=\"nofollow noopener\">Schema definition and examples</a></li>\n</ul>\n<h2 id=\"how-do-i\" style=\"position:relative;\"><a href=\"#how-do-i\" aria-label=\"how do i permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>How Do I...</h2>\n<ul>\n<li>\n<p>Prevent conflicts / duplicates</p>\n<ul>\n<li>Easiest is to specify a <em>unique key</em>, with the <code>&#x26;</code> prefix in <a href=\"https://dexie.org/docs/Version/Version.stores()\" target=\"_blank\" rel=\"nofollow noopener\">the schema definition</a></li>\n<li>If you want to allow duplicates a majority of the time, but in one instance only insert if data is not already there (e.g. when running a seeder), you can use <a href=\"https://dexie.org/docs/Table/Table.put()\" target=\"_blank\" rel=\"nofollow noopener\"><code>put</code> operations</a> (modifies if already existing, inserts if not), lookup manually before inserting, or use an in-between table to track seeding runs.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"tips-and-tricks\" style=\"position:relative;\"><a href=\"#tips-and-tricks\" aria-label=\"tips and tricks permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Tips and Tricks</h2>\n<ul>\n<li>\n<p>Be careful / thoughtful when using transactions (<code>.transaction()</code>) and debugging related issues</p>\n<ul>\n<li>For example, you might get <code>specified object store was not found</code> error if you forget to explicitly pass in a table that you try to use inside the transaction.</li>\n</ul>\n</li>\n<li>\n<p>If you get an error like <code>\"Failed to execute 'put' on 'IDBObjectStore': Evaluating the object store's key path did not yield a value.</code>, there is a good chance you forgot to include the actual object property that is mapped to the <code>key</code>.</p>\n<ul>\n<li>For example you might have accidentally used something like <code>myTable.put({propA: valA}, keyVal)</code> when you needed to use <code>myTable.put({key: keyVal, propA: valA})</code></li>\n<li>See <a href=\"https://dexie.org/docs/Table/Table.put()\" target=\"_blank\" rel=\"nofollow noopener\"><code>Table.put()</code> docs</a> for details</li>\n</ul>\n</li>\n</ul>",
              "fields": {
                "title": "Dexie.js IndexedDB Library - Assorted Notes",
                "slug": "/cheatsheets/db/dexie-js/",
                "modifiedStampMs": 1602647546000,
                "createdStampMs": 1602573061000
              },
              "parent": {
                "absolutePath": "/opt/build/repo/md/cheatsheets/db/dexie-js.md",
                "relativePath": "cheatsheets/db/dexie-js.md",
                "base": "dexie-js.md",
                "name": "dexie-js"
              }
            },
            {
              "id": "b217387a-b5d0-51fe-b0fb-572245a1d32f",
              "fileAbsolutePath": "/opt/build/repo/md/cheatsheets/db/postgresql.md",
              "html": "<h1 id=\"wip\" style=\"position:relative;\"><a href=\"#wip\" aria-label=\"wip permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>WIP</h1>\n<hr>\n<!--\n# Resources\nWhat | Type | Link\n--- | --- | ---\n-->\n<h1 id=\"schemas\" style=\"position:relative;\"><a href=\"#schemas\" aria-label=\"schemas permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Schemas</h1>\n<p>Schemas are kind of like a combination of the concept of a <em>namespace</em> and <em>scoped silo</em>. Schemas allow you to define subsections of a single DB, which are unique in a few different ways:</p>\n<ul>\n<li>\n<p>DB component/object separation:</p>\n<ul>\n<li>You can separate tables, views, and more, by schema</li>\n<li>In this way, a schema can be thought of acting like a <em>subdirectory</em> or <em>sub-database</em> of the main.</li>\n</ul>\n</li>\n<li>\n<p>Namespace separation</p>\n<ul>\n<li>\n<p>With schemas, you can have multiple tables with identical table names, as long as they are separated by schemas.</p>\n<ul>\n<li>Without schemas this is not possible</li>\n</ul>\n</li>\n<li>The separate namespaces makes it ideal when integrating third-party connectors / sources, since you don't have to worry about name collisions - just use sep. schema.</li>\n</ul>\n</li>\n<li>\n<p>Scoped access and separation</p>\n<ul>\n<li>You can actually separate users by schema and only grant access to some vs all.</li>\n<li>This is kind of where <code>schema</code> acts like a <em>sub-database</em>, since normally, you can't scope sections of a database (tables, views, etc.) to certain users; it is more of an all or nothing thing.</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"primary-key-and-sequences\" style=\"position:relative;\"><a href=\"#primary-key-and-sequences\" aria-label=\"primary key and sequences permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Primary Key and Sequences</h1>\n<p>Assuming an auto-incrementing integer primary key, there are a few things to know:</p>\n<h2 id=\"retrieving-the-current-sequence\" style=\"position:relative;\"><a href=\"#retrieving-the-current-sequence\" aria-label=\"retrieving the current sequence permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Retrieving the current sequence</h2>\n<ul>\n<li>You can use <code>SELECT MAX(id) FROM {tableName}</code> to get the current max ID</li>\n<li>\n<p>You can use a sequence manipulation function to get lower level info</p>\n<ul>\n<li>\n<p><code>LASTVAL()</code> - get the last value returned by <code>nextval</code></p>\n<ul>\n<li>basically, \"where is the sequence at?\"</li>\n</ul>\n</li>\n<li><code>CURRVAL(regclass)</code> - same as <code>lastval</code>, but you can use <code>regclass</code> to specify target</li>\n<li><code>NEXTVAL(regclass)</code> - advances the sequence 1 step, and returns value</li>\n<li><code>SETVAL(regclass, bigint)</code> - Sets the sequence's current value to whatever you want</li>\n</ul>\n</li>\n<li>\n<p>If the above fail due to cross-session issues, here are some more tricks:</p>\n<ul>\n<li><code>SELECT last_value FROM {sequenceName}</code></li>\n<li><code>SELECT MAX(id) FROM {tableName}</code></li>\n<li>Use a function and/or stored procedure (see below)</li>\n</ul>\n</li>\n</ul>\n<p>Here is a custom function I whipped up:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> get_last_id<span class=\"token punctuation\">(</span>TABLE_NAME <span class=\"token keyword\">TEXT</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">RETURNS</span> <span class=\"token keyword\">BIGINT</span> <span class=\"token keyword\">AS</span> $id$\n<span class=\"token keyword\">DECLARE</span>\n\tSEQ_NAME <span class=\"token keyword\">TEXT</span><span class=\"token punctuation\">;</span>\n\tSEQ_INT <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\n\tSEQ_NAME :<span class=\"token operator\">=</span> PG_GET_SERIAL_SEQUENCE<span class=\"token punctuation\">(</span>TABLE_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">EXECUTE</span> CONCAT<span class=\"token punctuation\">(</span><span class=\"token string\">'SELECT last_value FROM '</span><span class=\"token punctuation\">,</span> SEQ_NAME<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">INTO</span> SEQ_INT<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">RETURN</span> SEQ_INT<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n$id$\n<span class=\"token keyword\">LANGUAGE</span> PLPGSQL<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/* Once you create, you can call with: */</span>\n<span class=\"token comment\">/* SELECT get_last_id('my_table_name'); */</span></code></pre></div>\n<h3 id=\"regclass-note\" style=\"position:relative;\"><a href=\"#regclass-note\" aria-label=\"regclass note permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Regclass note</h3>\n<p>You can either access by <code>CURRVAL('{schema}.{table}_id_seq'::regclass)</code>, or, without needing to know seq name: <code>CURRVAL(PG_GET_SERIAL_SEQUENCE({tableName}, 'id'))</code></p>\n<p>For more details, see the docs on <a href=\"https://www.postgresql.org/docs/8.1/functions-sequence.html\" target=\"_blank\" rel=\"nofollow noopener\">Sequence Manipulation Functions</a>.</p>\n<h2 id=\"resetting-the-sequence\" style=\"position:relative;\"><a href=\"#resetting-the-sequence\" aria-label=\"resetting the sequence permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Resetting the sequence</h2>\n<p>If the sequence gets screwed up due to migrations / rollbacks / etc., you have some options for fixing. For bulk resets, see <a href=\"https://wiki.postgresql.org/wiki/Fixing_Sequences\" target=\"_blank\" rel=\"nofollow noopener\">https://wiki.postgresql.org/wiki/Fixing_Sequences</a>.</p>\n<p>For individual fixes, you can always use <code>SETVAL</code> combined with <code>SELECT MAX()</code>, like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> SETVAL<span class=\"token punctuation\">(</span><span class=\"token string\">'{sequenceName}'</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">SELECT</span> <span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> {tableName}<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"auto-generated-sequence-names\" style=\"position:relative;\"><a href=\"#auto-generated-sequence-names\" aria-label=\"auto generated sequence names permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Auto generated sequence names</h2>\n<p>With an auto-increment PK, generally PG will automatically create a named sequence, that looks something like: <code>{schemaName}.{tableName}_id_seq</code>. So, for example: <code>admin.master_log_id_seq</code>.</p>\n<p>You can manually get the name with <code>SELECT PG_GET_SERIAL_SEQUENCE('{tableName}', 'id');</code></p>\n<hr>\n<p>Various issues / common FAQ</p>\n<ul>\n<li>\n<p><code>RAISE NOTICE</code> has no effect</p>\n<ul>\n<li>relies on certain logging features being enabled. Maybe the client you are using does not support them?</li>\n<li>For example, the HeidiSQL desktop client <a href=\"https://www.heidisql.com/forum.php?t=26661\" target=\"_blank\" rel=\"nofollow noopener\">does not support them</a>.</li>\n</ul>\n</li>\n<li>\n<p>I can't seem to return anything, and/or getting <code>return cannot have parameter</code></p>\n<ul>\n<li>\n<p>Are you trying to return from an anonymous code block, and not a function?</p>\n<ul>\n<li>You can basically only return from a function</li>\n<li>You definitely cannot return from a <code>DO</code> block / anonymous block</li>\n</ul>\n</li>\n<li>\n<p>There are two workarounds if you can't use functions:</p>\n<ul>\n<li>Use <code>RAISE NOTICE</code> to log the output</li>\n<li>Create a <em>temp</em> table and save the results there, then select and output, and then cleanup</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>How do I drop all rows from all tables?</p>\n<ul>\n<li>Indiscriminately dropping all rows from a table is known as <em>\"truncating\"</em></li>\n<li>Here is a nice PgSQL function you can use to accomplish this: <a href=\"https://stackoverflow.com/a/2829485/11447682\" target=\"_blank\" rel=\"nofollow noopener\">S/O Answer</a></li>\n</ul>\n</li>\n</ul>",
              "fields": {
                "title": "PostgreSQL Cheatsheet",
                "slug": "/cheatsheets/db/postgresql/",
                "modifiedStampMs": 1583947702000,
                "createdStampMs": 1571635393000
              },
              "parent": {
                "absolutePath": "/opt/build/repo/md/cheatsheets/db/postgresql.md",
                "relativePath": "cheatsheets/db/postgresql.md",
                "base": "postgresql.md",
                "name": "postgresql"
              }
            },
            {
              "id": "d80cd99f-66ca-55ed-bd82-9045462e43e3",
              "fileAbsolutePath": "/opt/build/repo/md/cheatsheets/db/sql.md",
              "html": "<h1 id=\"comments\" style=\"position:relative;\"><a href=\"#comments\" aria-label=\"comments permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Comments</h1>\n<p>You can use a double dash with spacing around it:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> Users <span class=\"token keyword\">WHERE</span> Users<span class=\"token punctuation\">.</span>isAdmin <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span> <span class=\"token comment\">-- Get admin users</span></code></pre></div>\n<p>Or, typical block comment type:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">/* Get admin users */</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> Users <span class=\"token keyword\">WHERE</span> Users<span class=\"token punctuation\">.</span>isAdmin <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span></code></pre></div>\n<h1 id=\"aliases\" style=\"position:relative;\"><a href=\"#aliases\" aria-label=\"aliases permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Aliases</h1>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">/* Combine selecting all PLUS an alias in one query */</span>\n\t<span class=\"token comment\">/* Actually should work without anything special */</span>\n\t<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> <span class=\"token function\">AVG</span><span class=\"token punctuation\">(</span>MY_COLUMN<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token string\">'average'</span> <span class=\"token keyword\">FROM</span> MY_TABLE <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">[</span>MY_FILTER<span class=\"token punctuation\">]</span>\n\t<span class=\"token comment\">/* Can also prefix to be careful */</span>\n\t<span class=\"token keyword\">SELECT</span> MY_TABLE<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> <span class=\"token function\">AVG</span><span class=\"token punctuation\">(</span>MY_TABLE<span class=\"token punctuation\">.</span>MY_COLUMN<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token string\">'average'</span> <span class=\"token keyword\">FROM</span> MY_TABLE <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">[</span>MY_FILTER<span class=\"token punctuation\">]</span>\n\t\n<span class=\"token comment\">/* You can alias entire tables to make queries shorter */</span>\n\t<span class=\"token comment\">/* something like... */</span>\n\t<span class=\"token keyword\">SELECT</span> s<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>dob<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>gender<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>enroll_date<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>phone<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>curr_level<span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">.</span>gpa\n\t<span class=\"token keyword\">FROM</span> student_records <span class=\"token keyword\">AS</span> s<span class=\"token punctuation\">,</span> student_grades <span class=\"token keyword\">as</span> g\n\t<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> student_grades\n\t<span class=\"token keyword\">ON</span> s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>g<span class=\"token punctuation\">.</span>student_id\n\t<span class=\"token comment\">/* You can also alias within a function like join, like so: */</span>\n\t<span class=\"token keyword\">SELECT</span> s<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>dob<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>gender<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>enroll_date<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>phone<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>curr_level<span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">.</span>gpa\n\t<span class=\"token keyword\">FROM</span> student_records <span class=\"token keyword\">AS</span> s\n\t<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> student_grades <span class=\"token keyword\">as</span> g\n\t<span class=\"token keyword\">ON</span> s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>g<span class=\"token punctuation\">.</span>student_id</code></pre></div>\n<h1 id=\"tricks\" style=\"position:relative;\"><a href=\"#tricks\" aria-label=\"tricks permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Tricks</h1>\n<h2 id=\"fake-constants\" style=\"position:relative;\"><a href=\"#fake-constants\" aria-label=\"fake constants permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Fake constants</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">/* Inserting a fake constant that you can use to join with, etc. */</span>\n<span class=\"token comment\">/* --- > As easy as simply putting \"[VALUE] AS [COLUMN_NAME]\"\n\n\t/* Adding a dummy int */</span>\n\t<span class=\"token keyword\">SELECT</span> id<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> <span class=\"token keyword\">AS</span> dummyint <span class=\"token keyword\">FROM</span> records\n\n\t<span class=\"token comment\">/* or a string */</span>\n\t<span class=\"token keyword\">select</span> id<span class=\"token punctuation\">,</span> <span class=\"token string\">'foobar'</span> <span class=\"token keyword\">AS</span> dummystring <span class=\"token keyword\">FROM</span> records\n\n<span class=\"token comment\">/* Using fake constant to join on unrelated aggregate columns */</span>\n\t<span class=\"token keyword\">SELECT</span> uploads<span class=\"token punctuation\">,</span> downloads <span class=\"token keyword\">FROM</span>\n\t<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token string\">\"uploads\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">dummy</span> <span class=\"token keyword\">FROM</span> stats <span class=\"token keyword\">WHERE</span> stats<span class=\"token punctuation\">.</span>category <span class=\"token operator\">=</span> <span class=\"token string\">\"image-host\"</span> <span class=\"token operator\">AND</span> stats<span class=\"token punctuation\">.</span><span class=\"token keyword\">action</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"upload\"</span><span class=\"token punctuation\">)</span> U\n\t<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span>\n\t<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token string\">\"downloads\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">dummy</span> <span class=\"token keyword\">FROM</span> stats <span class=\"token keyword\">WHERE</span> stats<span class=\"token punctuation\">.</span>category <span class=\"token operator\">=</span> <span class=\"token string\">\"image-host\"</span> <span class=\"token operator\">AND</span> stats<span class=\"token punctuation\">.</span><span class=\"token keyword\">action</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"download\"</span><span class=\"token punctuation\">)</span> D\n\t<span class=\"token keyword\">ON</span> U<span class=\"token punctuation\">.</span><span class=\"token keyword\">dummy</span> <span class=\"token operator\">=</span> D<span class=\"token punctuation\">.</span><span class=\"token keyword\">dummy</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h1 id=\"joins\" style=\"position:relative;\"><a href=\"#joins\" aria-label=\"joins permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Joins</h1>\n<h2 id=\"add-a-single-column-from-a-related-table-based-on-shared-join\" style=\"position:relative;\"><a href=\"#add-a-single-column-from-a-related-table-based-on-shared-join\" aria-label=\"add a single column from a related table based on shared join permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Add a single column from a related table, based on shared join</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> students<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> contact_entries<span class=\"token punctuation\">.</span>email\n<span class=\"token keyword\">FROM</span> students\n<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> contact_entries\n<span class=\"token keyword\">ON</span> students<span class=\"token punctuation\">.</span>contact_id <span class=\"token operator\">=</span> contact_entries<span class=\"token punctuation\">.</span>id</code></pre></div>\n<h2 id=\"join-with-subquery\" style=\"position:relative;\"><a href=\"#join-with-subquery\" aria-label=\"join with subquery permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Join with subquery</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">FROM</span> orders\n<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> <span class=\"token punctuation\">(</span>\n\t\t<span class=\"token keyword\">SELECT</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>order_total<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> past_spend\n\t\t<span class=\"token keyword\">FROM</span> orders\n\t\t<span class=\"token keyword\">WHERE</span> fulfilled <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\t\t<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> customer_id\n<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> past_orders_summed\n<span class=\"token keyword\">ON</span> orders<span class=\"token punctuation\">.</span>customer_id <span class=\"token operator\">=</span> past_orders_summed<span class=\"token punctuation\">.</span>customer_id\n<span class=\"token keyword\">WHERE</span> orders<span class=\"token punctuation\">.</span>fulfilled <span class=\"token operator\">=</span> <span class=\"token number\">0</span></code></pre></div>\n<h2 id=\"join-keep-all-columns-of-original-table-and-only-certain-columns-of-joined\" style=\"position:relative;\"><a href=\"#join-keep-all-columns-of-original-table-and-only-certain-columns-of-joined\" aria-label=\"join keep all columns of original table and only certain columns of joined permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Join, keep all columns of original table, and only certain columns of joined</h2>\n<p>In your select statement, use:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> origin_table<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> joined_table<span class=\"token punctuation\">.</span>my_col</code></pre></div>\n<h2 id=\"multiple-on\" style=\"position:relative;\"><a href=\"#multiple-on\" aria-label=\"multiple on permalink\" class=\"anchor before\"><?xml version=\"1.0\" ?><svg id=\"Outlined\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><title/><g id=\"Fill\"><path fill=\"currentColor\" d=\"M29.35,6.88,25.11,2.63a3,3,0,0,0-4.23,0L14.64,8.81a3,3,0,0,0,0,4.25l1.44,1.45-1.54,1.54-1.42-1.42a3,3,0,0,0-4.24,0L2.65,20.8a3,3,0,0,0,0,4.26L6.88,29.3A3,3,0,0,0,9,30.17a3,3,0,0,0,2.11-.86l6.23-6.19A3,3,0,0,0,18.24,21a3,3,0,0,0-.88-2.13L16,17.46l1.54-1.54,1.39,1.38a3,3,0,0,0,4.23,0l6.23-6.18A2.94,2.94,0,0,0,30.23,9,3,3,0,0,0,29.35,6.88ZM15.94,20.29a1,1,0,0,1,.3.71,1,1,0,0,1-.3.7L9.71,27.89a1,1,0,0,1-1.41,0L4.06,23.64a1,1,0,0,1-.3-.71,1,1,0,0,1,.3-.71L10.29,16a1,1,0,0,1,1.41,0l1.42,1.42-2.83,2.83,1.42,1.42,2.83-2.83Zm12-10.58L21.7,15.89a1,1,0,0,1-1.41,0l-1.38-1.38,2.8-2.8-1.42-1.42-2.8,2.8-1.44-1.44a1,1,0,0,1,0-1.42l6.23-6.18A1,1,0,0,1,23,3.76a1,1,0,0,1,.71.29l4.24,4.24a1,1,0,0,1,0,1.42Z\"/></g></svg></a>Multiple ON</h2>\n<p>You can use multiple ON conditions with a join - just use parenthesis for grouping:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> ___\n<span class=\"token keyword\">ON</span> <span class=\"token punctuation\">(</span>___ <span class=\"token operator\">AND</span> ___<span class=\"token punctuation\">)</span></code></pre></div>\n<p><a href=\"https://stackoverflow.com/a/23901947/11447682\" target=\"_blank\" rel=\"nofollow noopener\">Related S/O</a></p>",
              "fields": {
                "title": "SQL Notes and Tricks",
                "slug": "/cheatsheets/db/sql/",
                "modifiedStampMs": 1599099903000,
                "createdStampMs": 1569413805000
              },
              "parent": {
                "absolutePath": "/opt/build/repo/md/cheatsheets/db/sql.md",
                "relativePath": "cheatsheets/db/sql.md",
                "base": "sql.md",
                "name": "sql"
              }
            }
          ],
          "paths": []
        }
      }
    }
  },
  "staticQueryHashes": [
    "2563531922",
    "3649515864",
    "3795822034"
  ]
}
