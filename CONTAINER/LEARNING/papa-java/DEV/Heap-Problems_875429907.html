<!DOCTYPE html>
<html>
    <head>
        <title>DevOps : Heap Problems</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DevOps</a></span>
                            </li>
                                                    <li>
                                <span><a href="DevOps-Home_603226548.html">DevOps Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Tutorials_278921431.html">Tutorials</a></span>
                            </li>
                                                    <li>
                                <span><a href="Java-Problems_858619905.html">Java Problems</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DevOps : Heap Problems
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Nicholas Guner</span>, last modified on Jan 23, 2021
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <style type='text/css'>/*<![CDATA[*/
div.rbtoc1613190976088 {padding: 0px;}
div.rbtoc1613190976088 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1613190976088 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1613190976088'>
<ul class='toc-indentation'>
<li><a href='#HeapProblems-MergeSortedArrays'>MergeSortedArrays</a></li>
<li><a href='#HeapProblems-CitySkyline'>CitySkyline</a></li>
<li><a href='#HeapProblems-KthElement'>KthElement</a>
<ul class='toc-indentation'>
<li><a href='#HeapProblems-kthLargest'>kthLargest</a></li>
<li><a href='#HeapProblems-kthSmallest'>kthSmallest</a></li>
</ul>
</li>
<li><a href='#HeapProblems-LongestConsecutiveSequence'>LongestConsecutiveSequence</a></li>
<li><a href='#HeapProblems-Median'>Median</a></li>
<li><a href='#HeapProblems-MeetingRooms'>MeetingRooms</a></li>
<li><a href='#HeapProblems-SetPartition'>SetPartition</a></li>
</ul>
</div><h2 id="HeapProblems-MergeSortedArrays"><br/>MergeSortedArrays</h2><p>See also <a href="https://nickguner.atlassian.net/wiki/spaces/DEV/pages/858718211/Arrays+Problems#mergeSorted" data-card-appearance="inline" rel="nofollow">https://nickguner.atlassian.net/wiki/spaces/DEV/pages/858718211/Arrays+Problems#mergeSorted</a> </p><div class="table-wrap"><table data-layout="full-width" class="confluenceTable"><colgroup><col style="width: 630.0px;"/><col style="width: 907.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>MergeSortedArrays</p></th><th class="confluenceTh"><p>Tests</p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static int[] mergeSortedArrays(int[] a, int[] b)
{
    PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;();
    pq.addAll(Arrays.stream(a).boxed().collect(Collectors.toList()));
    pq.addAll(Arrays.stream(b).boxed().collect(Collectors.toList()));
    int[] result = new int[a.length + b.length];
    Arrays.setAll(result, i -&gt; pq.poll());
    return result;
}</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static boolean testsPass()
{
    int[] a = {1, 3, 5, 7, 9};
    int[] b = {2, 4, 6, 8};
    boolean check = Arrays.equals(new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9}, mergeSortedArrays(a, b));
    if(!check)
    {
        return false;
    }
    return true;
}</pre>
</div></div></td></tr></tbody></table></div><h2 id="HeapProblems-CitySkyline">CitySkyline</h2><div class="table-wrap"><table data-layout="full-width" class="confluenceTable"><colgroup><col style="width: 846.0px;"/><col style="width: 691.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>CitySkyline</p></th><th class="confluenceTh"><p>Tests</p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">Buildings are represented with [x1, x2, y} coordinates, for example:
    [ [2 9 10], [3 7 15], [5 12 12], [15 20 10], [19 24 8] ]
SkyLine is represented with [ x, y ] coordinates, for example:
    [ [2 10], [3 15], [7 12], [9, 12], [12 0], [15 10], [20 8], [24, 0] ]
Approach:
1.  Represent a rectangle with two edges: left and right.
2.  For Left edges:
    a.  For edges with same x coordinate, the edge with largest height prevails
3.  For right edges:
    a. Edge prevails if it is a last edge in the chain of consecutive buildings
Design:
Edge: x, y, Left/Right
Edge Comparator:
  If edges do not share x coordinate, sort by ascending height
  If edges do share same x coordinate
    If they are both start edges, sort descending by height
    If they are both end edges, sort ascending by height
    If one is left and the other is right, left comes before right
Find dominant height among buildings at each coordinate
  Use PriorityQueue to make sure the tallest edge dominates
  Once we detect the right edge of the tallest building, we need to remove left edge from Priority Queue</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">public class CitySkyline
{
    static class Edge
    {
        enum Type {LEFT, RIGHT};
        int pos;
        int height;
        Type type;

        Edge(int pos, int height, Type type)
        {
            this.pos = pos;
            this.height = height;
            this.type = type;
        }

        @Override
        public boolean equals(Object o)
        {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            Edge edge = (Edge) o;
            return pos == edge.pos &amp;&amp;
                    height == edge.height &amp;&amp;
                    type == edge.type;
        }

        @Override
        public int hashCode()
        {
            return Objects.hash(pos, height, type);
        }
    }

    static List&lt;int[]&gt; generateSkyline(int[][] buildings)
    {
        //  Create Edges
        List&lt;Edge&gt; edges = Arrays.stream(buildings)
                .map((int[] a) -&gt; new Edge(a[0], a[2], Edge.Type.LEFT)).collect(Collectors.toList());
        edges.addAll(Arrays.stream(buildings)
                .map((int[] a) -&gt; new Edge(a[1], a[2], Edge.Type.RIGHT)).collect(Collectors.toList()));

        //  Sort Edges
        edges.sort((e1, e2) -&gt; {
            if(e1.pos != e2.pos) return e1.pos - e2.pos;
            if(e1.type == e2.type &amp;&amp; e1.type == Edge.Type.LEFT) return e2.height - e1.height;
            if(e1.type == e2.type &amp;&amp; e1.type == Edge.Type.RIGHT) return e1.height - e2.height;
            return e1.type.compareTo(e2.type);
        });

        PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;(Collections.reverseOrder());
        List&lt;int[]&gt; result = new ArrayList&lt;&gt;();

        for(Edge edge : edges)
        {
            if(edge.type == Edge.Type.LEFT)
            {
                if(pq.isEmpty() || pq.peek() &lt; edge.height)
                {
                    result.add(new int[] {edge.pos, edge.height});
                }
                pq.offer(edge.height);
            }
            else
            {
                pq.remove(edge.height);
                int[] pt = {edge.pos, pq.isEmpty() ? 0 : pq.peek()};
                result.add(pt);
            }
        }

        return result;
    }
}</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static boolean testsPass()
{
    int[][] buildings = {
            {2, 9, 10},
            {3, 7, 15},
            {5, 12, 12},
            {15, 20, 10},
            {19, 24, 8}
    };
    List&lt;int[]&gt; result = generateSkyline(buildings);
    boolean check = Arrays.equals(new int[] {2, 10}, result.get(0)) &amp;&amp;
                    Arrays.equals(new int[] {3, 15}, result.get(1)) &amp;&amp;
                    Arrays.equals(new int[] {7, 12}, result.get(2)) &amp;&amp;
                    Arrays.equals(new int[] {9, 12}, result.get(3)) &amp;&amp;
                    Arrays.equals(new int[] {12, 0}, result.get(4)) &amp;&amp;
                    Arrays.equals(new int[] {15, 10}, result.get(5)) &amp;&amp;
                    Arrays.equals(new int[] {20, 8}, result.get(6)) &amp;&amp;
                    Arrays.equals(new int[] {24, 0}, result.get(7));
    if(!check)
    {
        return false;
    }
    return true;
}</pre>
</div></div><p><br/></p></td></tr></tbody></table></div><h2 id="HeapProblems-KthElement">KthElement</h2><h3 id="HeapProblems-kthLargest"><br/><code>kthLargest</code></h3><h3 id="HeapProblems-kthSmallest"><code>kthSmallest</code></h3><div class="table-wrap"><table data-layout="full-width" class="confluenceTable"><colgroup><col style="width: 886.0px;"/><col style="width: 651.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>KthElement</p></th><th class="confluenceTh"><p>Tests</p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static int kthLargest(int[] a, int k)
{
    PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;();
    pq.addAll(Arrays.stream(a).boxed().collect(Collectors.toList()));
    while(pq.size() &gt; k)
    {
        pq.poll();
    }
    return pq.peek();
}</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static int kthSmallest(int[] a, int k)
{
    PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;(Comparator.reverseOrder());
    pq.addAll(Arrays.stream(a).boxed().collect(Collectors.toList()));
    while (pq.size() &gt; k)
    {
        pq.poll();
    }
    return pq.peek();
}</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static boolean testsPass()
{
    int[] a1 = {1, 2, 3, 4, 5, 6, 7, 8, 9};
    boolean check = kthLargest(a1, 3) == 7;
    if(!check)
    {
        return false;
    }
    check = kthSmallest(a1, 3) == 3;
    if(!check)
    {
        return false;
    }
    return true;
}</pre>
</div></div><p><br/></p></td></tr></tbody></table></div><h2 id="HeapProblems-LongestConsecutiveSequence">LongestConsecutiveSequence<br/></h2><div class="table-wrap"><table data-layout="full-width" class="confluenceTable"><colgroup><col style="width: 771.0px;"/><col style="width: 766.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>LongestConsecutiveSequence</p></th><th class="confluenceTh"><p>Tests</p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static int longestConsecutiveSequence(int [] a)
{
    // {100, 5, 20, 2, 1, 4, 21, 6, 7} -&gt; {4, 5, 6, 7}
    PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;();
    pq.addAll(Arrays.stream(a).boxed().collect(Collectors.toList()));
    int maxCount = 1, count = 1;
    int min = pq.poll();
    while(!pq.isEmpty())
    {
        int nextVal = pq.poll();
        {
            if(nextVal - 1 == min)
            {
                count++;
                maxCount = Math.max(maxCount, count);
            }
            else
            {
                count = 1;
            }
            min = nextVal;
        }
    }
    return maxCount;
}</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static boolean testsPass()
{
    boolean check = longestConsecutiveSequence(new int[] {100, 5, 20, 2, 1, 4, 21, 6, 7}) == 4;
    if(!check)
    {
        return false;
    }
    return true;
}</pre>
</div></div><p><br/></p></td></tr></tbody></table></div><h2 id="HeapProblems-Median">Median<br/></h2><div class="table-wrap"><table data-layout="full-width" class="confluenceTable"><colgroup><col style="width: 771.0px;"/><col style="width: 766.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Median</p></th><th class="confluenceTh"><p>Tests</p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">Consider numbers: 1 5 0 4 9 3 8 2 7 6
MIN     MAX
----------
5       4    &lt;--- TOP
6       3
7       2
8       1
9       0
</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static double median(int[] a)
{
    if(a == null &amp;&amp; a.length == 0)
    {
        return Double.MIN_VALUE;
    }
    if(a.length == 1)
    {
        return a[0];
    }
    if(a.length == 2)
    {
        return (a[0] + a[1]) / 2.0;
    }
    PriorityQueue&lt;Integer&gt; minHeap = new PriorityQueue&lt;&gt;();
    PriorityQueue&lt;Integer&gt; maxHeap = new PriorityQueue&lt;&gt;(Comparator.reverseOrder());
    for(int v : a)
    {
        if(minHeap.size() == maxHeap.size())
        {
            if(!minHeap.isEmpty() &amp;&amp; v &gt; minHeap.peek())
            {
                maxHeap.offer(minHeap.poll());
                minHeap.offer(v);
            }
            else
            {
                maxHeap.offer(v);
            }
        }
        else
        {
            if(maxHeap.peek() &gt; v)
            {
                minHeap.offer(maxHeap.poll());
                maxHeap.offer(v);
            }
            else
            {
                minHeap.offer(v);
            }
        }
    }
    if(minHeap.size() == maxHeap.size())
    {
        return (minHeap.peek() + maxHeap.peek()) / 2.0;
    }
    else if(minHeap.size() &gt; maxHeap.size())
    {
        return minHeap.peek();
    }
    else
    {
        return maxHeap.peek();
    }
}</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static boolean testsPass()
{
    boolean check = median(new int[] {3, 9, 5, 0, 1, 8, 2, 7, 4, 6}) == 4.5;
    if(!check)
    {
        return false;
    }
    return true;
}</pre>
</div></div><p><br/></p></td></tr></tbody></table></div><h2 id="HeapProblems-MeetingRooms">MeetingRooms<br/></h2><div class="table-wrap"><table data-layout="full-width" class="confluenceTable"><colgroup><col style="width: 957.0px;"/><col style="width: 580.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>MeetingRooms</p></th><th class="confluenceTh"><p>Tests</p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">Consider inputs
[30, 45], [2, 15], 16, 23], [4, 9], [9, 29], [3, 5]
Sorted by start time
[2, 15], [3, 5], [4, 9], [9, 29], [16, 23], [30, 45]
Based on this input, we will need 3 rooms:
Room 1: [4, 9], [9, 29], [30, 45]
Room 2: [2, 15], [16, 23]
Room 3: [3, 5]</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static int minimumRoomsRequired(int[][] intervals)
{
    Arrays.sort(intervals, Comparator.comparingInt( (int[] a) -&gt; a[0]));
    int roomCount = 1;
    PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;();
    pq.offer(intervals[0][1]);
    for(int i = 1; i &lt; intervals.length; ++i)
    {
        int[] interval = intervals[i];
        if(interval[0] &lt; pq.peek())
        {
            roomCount++;
        }
        pq.offer(interval[1]);
    }
    return roomCount;
}</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static boolean testsPass()
{
    int[][] data = {
            {30, 45},
            {2, 15},
            {16, 23},
            {4, 9},
            {9, 29},
            {3, 5}
    };
    boolean check = minimumRoomsRequired(data) == 3;
    if(!check)
    {
        return false;
    }
    return true;
}</pre>
</div></div><p><br/></p></td></tr></tbody></table></div><h2 id="HeapProblems-SetPartition">SetPartition<br/></h2><div class="table-wrap"><table data-layout="full-width" class="confluenceTable"><colgroup><col style="width: 885.0px;"/><col style="width: 652.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>SetPartition</p></th><th class="confluenceTh"><p>Tests</p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">Partition a set into two subsets such that the difference of subset sums is minimum
Input:  {1, 6, 11, 5}, sum of this array is 23
Subset1 = {1, 5, 6}, sum of Subset1 = 12
Subset2 = {11}, sum of Subset2 = 11
Return minimum difference
Approach shown here uses Karmarkar–Karp heuristic</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static int minDifference(int [] a)
{
    PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;(Collections.reverseOrder());
    pq.addAll(Arrays.stream(a).boxed().collect(Collectors.toList()));
    while(pq.size() &gt; 1)
    {
        int v1 = pq.poll();
        int v2 = pq.poll();
        pq.offer(v1 - v2);
    }
    return pq.poll();
}</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">static boolean testsPass()
{
    boolean check = minDifference(new int[] {1, 6, 11, 5}) == 1;
    if(!check)
    {
        return false;
    }
    return true;
}</pre>
</div></div><p><br/></p></td></tr></tbody></table></div><p><br/></p>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Feb 12, 2021 23:36</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
