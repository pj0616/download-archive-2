<!DOCTYPE html>
<html>
    <head>
        <title>DevOps : release 1.1.13.1</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DevOps</a></span>
                            </li>
                                                    <li>
                                <span><a href="DevOps-Home_603226548.html">DevOps Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Tutorials_278921431.html">Tutorials</a></span>
                            </li>
                                                    <li>
                                <span><a href="Spring-Boot_278888737.html">Spring Boot</a></span>
                            </li>
                                                    <li>
                                <span><a href="Overrides_290029797.html">Overrides</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DevOps : release 1.1.13.1
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Nicholas Guner</span> on Apr 19, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="release1.1.13.1-Controllers">Controllers</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@RestController
@RepositoryRestController
public class ClearanceController
{
    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private AssignableController assignableController;
    @Autowired
    private DutyAssignableMapRepository dutyAssignableMapRepository;
    @Autowired
    private RuleDutyMapRepository ruleDutyMapRepository;
    @Autowired
    private AssignableRepository assignableRepository;
    @Autowired
    private RuleRepository ruleRepository;
    @Autowired
    private CampController campController;
    @Autowired
    private ComController comController;
    @Autowired
    private AuditTrailRepository auditTrailRepository;
    @Autowired
    private PeopleSearchController peopleSearchController;

    @Value(&quot;${overridesUIPrefix.url}&quot;)
    private String overridesURLPrefix;



    private static String OVERRIDE = &quot;override&quot;;
    private static String CONTROL_ID = &quot;control id&quot;;
    private static String PRIVILEGE_OVERRIDE = &quot;PRIVILEGE_OVERRIDE&quot;;
    private static String RULE_OVERRIDE = &quot;RULE_OVERRIDE&quot;;
    private static String STATE = &quot;state&quot;;
    private static String EXPIRY_DATE = &quot;expiryDate&quot;;

    @GetMapping(&quot;/assignables/kerberos/{kerberos}&quot;)
    public ResponseEntity&lt;Resources&lt;AssignableDTO&gt;&gt; getAssignables(@PathVariable(&quot;kerberos&quot;) String kerberos) throws JSONException
    {
        List&lt;AssignableDTO&gt; assignableDTOS = new ArrayList&lt;&gt;();

        List&lt;Assignable&gt; assignables = getAssignablesForKerberos(kerberos, false);
        for(Assignable assignable : assignables)
        {
            AssignableDTO assignableDTO = assignableController.getAssignableDTO(assignable.getID());
            assignableDTOS.add(assignableDTO);
        }

        Resources&lt;AssignableDTO&gt; resources = new Resources&lt;&gt;(assignableDTOS);
        resources.add(linkTo(ControllerLinkBuilder.methodOn(getClass()).getAssignables(kerberos)).withSelfRel());
        return ResponseEntity.ok(resources);
    }

    @GetMapping(&quot;/duties/kerberos/{kerberos}&quot;)
    public ResponseEntity&lt;Resource&lt;DutiesDTO&gt;&gt; getDuties(@PathVariable(&quot;kerberos&quot;) String kerberos) throws JSONException
    {
        List&lt;Assignable&gt; assignables = getAssignablesForKerberos(kerberos, false);
        Set&lt;Duty&gt; duties = getDutiesForAssignables(assignables);

        DutiesDTO dutiesDTO = new DutiesDTO(duties);
        Resource&lt;DutiesDTO&gt; resource = new Resource&lt;&gt;(dutiesDTO);

        for(Duty duty : duties)
        {
            resource.add(createDutyLink(duty));
        }
        return ResponseEntity.ok(resource);
    }

    //  TODO: include submitter of the request
    @GetMapping(&quot;/guid/{guid}/system/{system}/privilege/{privilegeId}&quot;)
    public ResponseEntity&lt;Resource&lt;?&gt;&gt; checkPrivilegeAssignmentToGuidAndSystem(@PathVariable(&quot;guid&quot;) String guid,
                                                                               @PathVariable(&quot;privilegeId&quot;) String privilegeId,
                                                                               @PathVariable(&quot;system&quot;) String system)  throws Exception
    {
        AuditTrail auditTrail = new AuditTrail();
        auditTrail.setPrivilegeId(privilegeId);
        auditTrail.setSourceSystem(system);

        String kerberos = getKerberosFromGuid(guid, auditTrail);

        SimpleFilterProvider filterProvider = new SimpleFilterProvider();
        filterProvider.addFilter(&quot;clearanceResponse&quot;, SimpleBeanPropertyFilter.filterOutAllExcept(&quot;tmdResponse&quot;));

        ResponseEntity&lt;Resource&lt;?&gt;&gt; response;
        try
        {
            response = checkPrivilegeAssignmentToKerberos(kerberos, privilegeId, auditTrail, false, filterProvider, Arrays.asList(&quot;tmdResponse&quot;), false);
        }
        finally
        {
            auditTrailRepository.save(auditTrail);
        }
        return response;
    }

    @GetMapping(&quot;/privilege/{privilegeId}/kerberos/{kerberos}&quot;)
    public ResponseEntity&lt;Resource&lt;?&gt;&gt; checkPrivilegeAssignmentToKerberos(@PathVariable(&quot;kerberos&quot;) String kerberos,
                                                                          @PathVariable(&quot;privilegeId&quot;) String privilegeId,
                                                                          @RequestParam(defaultValue = &quot;false&quot;) boolean skipOverrideCheck) throws Exception
    {
        AuditTrail auditTrail = new AuditTrail();
        peopleSearchController.findByKerberos(kerberos);

        SimpleFilterProvider filterProvider = new SimpleFilterProvider();
        filterProvider.addFilter(&quot;clearanceResponse&quot;, SimpleBeanPropertyFilter.filterOutAllExcept(&quot;violation&quot;, &quot;overrides&quot;));

        return checkPrivilegeAssignmentToKerberos(kerberos, privilegeId, auditTrail, skipOverrideCheck, filterProvider, Arrays.asList(&quot;violation&quot;, &quot;overrides&quot;), true);
    }

    @GetMapping(&quot;/privilege/{privilegeId}/guid/{guid}&quot;)
    public ResponseEntity&lt;Resource&lt;?&gt;&gt; checkPrivilegeAssignmentToGuid(@PathVariable(&quot;guid&quot;) String guid,
                                                                      @PathVariable(&quot;privilegeId&quot;) String privilegeId,
                                                                      @RequestParam(defaultValue = &quot;false&quot;) boolean skipOverrideCheck) throws Exception
    {
        AuditTrail auditTrail = new AuditTrail();

        String kerberos = getKerberosFromGuid(guid, auditTrail);

        SimpleFilterProvider filterProvider = new SimpleFilterProvider();
        filterProvider.addFilter(&quot;clearanceResponse&quot;, SimpleBeanPropertyFilter.filterOutAllExcept(&quot;violation&quot;, &quot;overrides&quot;));

        return checkPrivilegeAssignmentToKerberos(kerberos, privilegeId, auditTrail, skipOverrideCheck, filterProvider, Arrays.asList(&quot;violation&quot;, &quot;overrides&quot;), true);
    }

    private ResponseEntity&lt;Resource&lt;?&gt;&gt; checkPrivilegeAssignmentToKerberos(String kerberos,
                                                                           String privilegeId,
                                                                           AuditTrail auditTrail,
                                                                           boolean skipOverrideCheck,
                                                                           SimpleFilterProvider filterProvider,
                                                                           List&lt;String&gt; filterNames,
                                                                           boolean includeLinks) throws JSONException, JsonProcessingException
    {
        auditTrail.setRequestedUser(kerberos);
        auditTrail.setExplanation(&quot;NO-ASSIGNABLE-CONFLICT&quot;);
        Map&lt;String,String&gt; response = new HashMap&lt;&gt;();
        response.put(&quot;Response&quot;, &quot;pass&quot;);

        try
        {
            //  Clearance API for kerberos
            //  If the privilege is not found in SoD database, it can&#39;t be part of any Duty and therefore can be assigned to user
            Optional&lt;Assignable&gt; assignableOptional = assignableRepository.findByPrivilegeIdAndSystem(privilegeId, &quot;AMP&quot;);
            if (assignableOptional.isPresent()) //    Privilege found in SoD database
            {
                Assignable requestedAssignable = assignableOptional.get();
                auditTrail.setAssignableId(requestedAssignable.getID());
                auditTrail.setAssignableName(requestedAssignable.getName());
                //  check if kerberos already owns requested privilege
                List&lt;Assignable&gt; kerberosAssignables = getAssignablesForKerberos(kerberos, false);
                if (kerberosAssignables.stream().noneMatch(p -&gt; p.getID() == requestedAssignable.getID()))  // kerberos does NOT own requested privilege
                {
                    //  This privilege may NOT be associated with any Duty, if that is the case, we can assign privilege to user
                    List&lt;DutyAssignablePair&gt; dutyAssignablePairs = dutyAssignableMapRepository.findByPrivilegeId(requestedAssignable.getID());
                    if (!dutyAssignablePairs.isEmpty())   // requested privilege IS associated with some duty
                    {
                        if(!kerberosAssignables.isEmpty())  //  kerberos has at least one assignable
                        {
                            //  Get all Duties for privileges owned by Kerberos
                            List&lt;Long&gt; kerberosAssignableIDs = kerberosAssignables.stream().map(Assignable::getID).collect(Collectors.toList());
                            List&lt;DutyAssignablePair&gt; kerberosDutyAssignablePairs = dutyAssignableMapRepository.findByPrivilegeIdList(kerberosAssignableIDs);
                            //  If kerberos privileges are not associated with any Duties, we can assign this privilege
                            if (!kerberosDutyAssignablePairs.isEmpty())   // kerberos privileges are associated with some Duties
                            {
                                List&lt;Duty&gt; dutiesForKerberos = kerberosDutyAssignablePairs.stream().map(DutyAssignablePair::getDuty).distinct().collect(Collectors.toList());
                                List&lt;Duty&gt; dutiesForRequestedAssignable = dutyAssignablePairs.stream().map(DutyAssignablePair::getDuty).distinct().collect(Collectors.toList());

                                //  If a requested privilege belongs to conflicting duties, reject it
                                if (dutiesForRequestedAssignable.size() &gt; 1)
                                {
                                    List&lt;Rule&gt; rulesForRequestedAssignable = getRulesForAssignable(requestedAssignable);
                                    if (!rulesForRequestedAssignable.isEmpty())
                                    {
                                        for(Rule rule : rulesForRequestedAssignable)
                                        {
                                            List&lt;RuleDutyPair&gt; ruleDutyPairs = ruleDutyMapRepository.findByRuleId(rule.getID());
                                            List&lt;Duty&gt; dutiesForRule = ruleDutyPairs.stream().map(RuleDutyPair::getDuty).collect(Collectors.toList());
                                            if(dutiesForRule.containsAll(dutiesForRequestedAssignable))
                                            {
                                                String rejectReason = &quot;Assignment of Privilege &#39;&quot; + requestedAssignable.getName() + &quot;&#39; violates rule(s) &quot; + rulesForRequestedAssignable;
                                                auditTrail.setRejectReason(rejectReason);
                                                auditTrail.setExplanation(&quot;TOXIC-ASSIGNABLE&quot;);
                                                throw new RuleViolationException(rejectReason);
                                            }
                                        }
                                    }
                                }

                                //  Find conflicting Rules
                                Set&lt;Rule&gt; conflictingRules = new HashSet&lt;&gt;();
                                Map&lt;Duty, List&lt;Assignable&gt;&gt; dutyAssignableMap = new HashMap&lt;&gt;();

                                for (Duty requestedPrivilegeDuty : dutiesForRequestedAssignable)
                                {
                                    for (Duty kerberosDuty : dutiesForKerberos)
                                    {
                                        if (!requestedPrivilegeDuty.equals(kerberosDuty))
                                        {
                                            //  One privilege may be associated with multiple Duties
                                            List&lt;RuleDutyPair&gt; requestedAssignableDutyRulePairs = ruleDutyMapRepository.findByDutyId(requestedPrivilegeDuty.getID());
                                            List&lt;RuleDutyPair&gt; kerberosRuleDutyPairs = ruleDutyMapRepository.findByDutyId(kerberosDuty.getID());

                                            List&lt;Rule&gt; requestedAssignableRules = requestedAssignableDutyRulePairs.stream()
                                                    .map(RuleDutyPair::getRule)
                                                    .filter(r -&gt; r.getState().equals(RuleState.PREVENT.name()))
                                                    .filter(r -&gt; r.getRuleType().equals(RuleType.SEGREGATION.name()))
                                                    .collect(Collectors.toList());
                                            List&lt;Rule&gt; kerberosRules = kerberosRuleDutyPairs.stream()
                                                    .map(RuleDutyPair::getRule)
                                                    .filter(r -&gt; r.getState().equals(RuleState.PREVENT.name()))
                                                    .filter(r -&gt; r.getRuleType().equals(RuleType.SEGREGATION.name()))
                                                    .collect(Collectors.toList());

                                            if(!(requestedAssignableRules.isEmpty() || kerberosRules.isEmpty()))
                                            {
                                                List&lt;Rule&gt; intersection = new ArrayList&lt;&gt;(kerberosRules);
                                                intersection.retainAll(requestedAssignableRules);
                                                if (!intersection.isEmpty())
                                                {
                                                    for (Rule rule : intersection)
                                                    {
                                                        List&lt;Duty&gt; duties = rule.getRuleDutyMappings().stream().map(RuleDutyPair::getDuty).collect(Collectors.toList());
                                                        //  Find all privileges for this Duty belonging to kerberos
                                                        for (Duty duty : duties)
                                                        {
                                                            List&lt;Assignable&gt; assignablesForKerberosDuty = dutyAssignableMapRepository.findByDutyId(duty.getID())
                                                                    .stream()
                                                                    .map(DutyAssignablePair::getAssignable)
                                                                    .collect(Collectors.toList());
                                                            assignablesForKerberosDuty.retainAll(kerberosAssignables);
                                                            dutyAssignableMap.put(duty, assignablesForKerberosDuty);
                                                        }
                                                    }

                                                    conflictingRules.addAll(intersection);
                                                }
                                            }
                                        }
                                    }
                                }

                                //  If no conflicting Rules were found, privilege may be assigned
                                if (!conflictingRules.isEmpty()) // conflicting Rules were found
                                {
                                    auditTrail.setRules(conflictingRules.stream().map(Rule::getName).collect(Collectors.joining(&quot;;&quot;)));
                                    auditTrail.setExplanation(&quot;CONFLICT-FOUND&quot;);

                                    if (skipOverrideCheck || !kerberosHasOverride(kerberos, privilegeId, conflictingRules, dutyAssignableMap))
                                    {
                                        String guid = peopleSearchController.guidFromKerberos(kerberos);

                                        String overridesUIURLWithParams = String.format(this.overridesURLPrefix, requestedAssignable.getPrivilegeId(), guid);
                                        logger.info(&quot;Overrides URL: {}&quot;, overridesUIURLWithParams);
                                        String overrideUIUrl = String.format(&quot;&lt;a href= \&quot;%s\&quot; &gt;Click here &lt;/a&gt; for Overrides URL.&quot;, overridesUIURLWithParams);

                                        ClearanceViolationDTO clearanceViolationDTO = new ClearanceViolationDTO(kerberos, overrideUIUrl,
                                                requestedAssignable,
                                                dutiesForRequestedAssignable,
                                                conflictingRules,
                                                dutyAssignableMap);


                                        ObjectMapper om = new ObjectMapper();
                                        om.setFilterProvider(filterProvider);

                                        String jsonString = om.writeValueAsString(clearanceViolationDTO);
                                        JSONObject jsonObject = new JSONObject(jsonString);

                                        Map&lt;String, Object&gt; clearanceResponse = new LinkedHashMap&lt;&gt;();
                                        clearanceResponse.put(&quot;Response&quot;, &quot;fail&quot;);

                                        for (String filterValue : filterNames)
                                        {
                                            JSONArray jsonArray = (JSONArray) jsonObject.get(filterValue);

                                            List&lt;String&gt; filterList = new ArrayList&lt;&gt;();
                                            for (int i = 0; i &lt; jsonArray.length(); ++i)
                                            {
                                                filterList.add((String) jsonArray.get(i));
                                            }
                                            clearanceResponse.put(filterValue, filterList);
                                        }

                                        auditTrail.setRejectReason(clearanceViolationDTO.getRejectReason());
                                        auditTrail.setReason(clearanceViolationDTO.getTmdResponse().stream().collect(Collectors.joining(&quot; &quot;)));
                                        auditTrail.setClear(&quot;false&quot;);

                                        Resource&lt;Map&lt;String, Object&gt;&gt; resource = new Resource&lt;&gt;(clearanceResponse);
                                        if (includeLinks)
                                        {
                                            resource.add(clearanceViolationDTO.getLinks());
                                        }

                                        return new ResponseEntity&lt;&gt;(resource, HttpStatus.OK);
                                    }
                                    else
                                    {
                                        auditTrail.setExplanation(&quot;OVERRIDE-FOUND-FOR-CONFLICT&quot;);
                                    }
                                }   //  found conflicting rules
                            }   // privileges owned by kerberos are associated with some Duties
                        }   //  kerberos has at least one assignable
                    }   //  requested privileges is associated with some Duty
                } //  Kerberos does not own requested privilege
                else
                {
                    auditTrail.setExplanation(&quot;OWNS-REQUESTED-PRIVILEGE&quot;);
                }
            }   //  requested privilege exists in SoD database
            else
            {
                auditTrail.setExplanation(&quot;ASSIGNABLE-NOT-DUTY-CLASSIFIED&quot;);
            }

            auditTrail.setClear(&quot;true&quot;);
        }
        catch(Exception e)
        {
            auditTrail.setException(e.getMessage());
            throw e;
        }

        Resource&lt;Map&lt;String, String&gt;&gt; resource = new Resource&lt;&gt;(response);

        return new ResponseEntity&lt;&gt;(resource, HttpStatus.OK);
    }

    private String getKerberosFromGuid(String guid, AuditTrail auditTrail) throws Exception
    {
        String kerberos;
        try
        {
            kerberos = peopleSearchController.kerberosFromGuid(guid);
        }
        catch(ResourceNotFoundException e)
        {
            auditTrail.setRequestedUser(guid);
            auditTrail.setExplanation(&quot;INVALID-GUID&quot;);
            auditTrail.setException(e.getMessage());
            auditTrailRepository.save(auditTrail);
            throw e;
        }
        return kerberos;
    }



    @GetMapping(&quot;/validate/kerberos/{kerberos}&quot;)
    public ResponseEntity&lt;?&gt; validateKerberosAssignables(@PathVariable(&quot;kerberos&quot;) String kerberos,
                                                         @RequestParam(defaultValue = &quot;false&quot;) boolean skipOverrideCheck,
                                                         @RequestParam(defaultValue = &quot;true&quot;) boolean skipTestData) throws JSONException
    {
        List&lt;Assignable&gt; assignablesForkerberos = getAssignablesForKerberos(kerberos, skipTestData);

        if(!assignablesForkerberos.isEmpty())
        {
            List&lt;Long&gt; assignableIDsForKerberos = assignablesForkerberos.stream().map(Assignable::getID).collect(Collectors.toList());
            List&lt;DutyAssignablePair&gt; dutyAssignablePairsForKerberos = dutyAssignableMapRepository.findByPrivilegeIdList(assignableIDsForKerberos);
            if(!dutyAssignablePairsForKerberos.isEmpty())
            {
                Set&lt;Rule&gt; conflictingRules = new HashSet&lt;&gt;();
                Map&lt;Duty, List&lt;Assignable&gt;&gt; dutyAssigablesMap = new HashMap&lt;&gt;();

                List&lt;Duty&gt; allDuties = dutyAssignablePairsForKerberos.stream().map(DutyAssignablePair::getDuty).distinct().collect(Collectors.toList());
                for(int i = 0; i &lt; allDuties.size() - 1; ++i)
                {
                    Duty duty1 = allDuties.get(i);

                    for(int j = i + 1; j &lt; allDuties.size(); ++j)
                    {
                        Duty duty2 = allDuties.get(j);

                        List&lt;RuleDutyPair&gt; dutyRulePairList1 = ruleDutyMapRepository.findByDutyId(duty1.getID());
                        if(!dutyRulePairList1.isEmpty())
                        {
                            List&lt;RuleDutyPair&gt; dutyRulePairList2 = ruleDutyMapRepository.findByDutyId(duty2.getID());
                            if(!dutyRulePairList2.isEmpty())
                            {
                                List&lt;Rule&gt; ruleList1 = dutyRulePairList1.stream()
                                        .map(RuleDutyPair::getRule)
                                        .filter(r -&gt; (r.getState().equals(RuleState.PREVENT.name())))
                                        .filter(r -&gt; r.getRuleType().equals(RuleType.SEGREGATION.name()))
                                        .collect(Collectors.toList());
                                List&lt;Rule&gt; ruleList2 = dutyRulePairList2.stream()
                                        .map(RuleDutyPair::getRule)
                                        .filter(r -&gt; (r.getState().equals(RuleState.PREVENT.name())))
                                        .filter(r -&gt; r.getRuleType().equals(RuleType.SEGREGATION.name()))
                                        .collect(Collectors.toList());

                                if(!(ruleList1.isEmpty() || ruleList2.isEmpty()))
                                {
                                    List&lt;Rule&gt; intersection = new ArrayList&lt;&gt;(ruleList1);
                                    intersection.retainAll(ruleList2);
                                    if(!intersection.isEmpty())
                                    {
                                        List&lt;Assignable&gt; assignablesForDuty1 = dutyAssignableMapRepository.findByDutyId(duty1.getID())
                                                .stream()
                                                .map(DutyAssignablePair::getAssignable)
                                                .collect(Collectors.toList());
                                        assignablesForDuty1.retainAll(assignablesForkerberos);
                                        dutyAssigablesMap.put(duty1, assignablesForDuty1);

                                        List&lt;Assignable&gt; assignablesForDuty2 = dutyAssignableMapRepository.findByDutyId(duty2.getID())
                                                .stream()
                                                .map(DutyAssignablePair::getAssignable)
                                                .collect(Collectors.toList());
                                        assignablesForDuty2.retainAll(assignablesForkerberos);
                                        dutyAssigablesMap.put(duty2, assignablesForDuty2);

                                        conflictingRules.addAll(intersection);
                                    }
                                }
                            }
                        }
                    }
                }

                if(!conflictingRules.isEmpty()) // conflicting Rules were found
                {
                    //  For each conflicting Rule, find privileges owned by Kerberos
                    if(skipOverrideCheck || !kerberosHasOverride(kerberos, dutyAssigablesMap, conflictingRules))
                    {
                        List&lt;ClearanceRuleViolationDTO&gt; ruleViolationDTOs = conflictingRules.stream()
                                .map(r -&gt; new ClearanceRuleViolationDTO(kerberos, r, dutyAssigablesMap))
                                .map(r -&gt; {r.add(linkTo(methodOn(RuleController.class).getRule(r.getRule().getID())).withRel(&quot;rule&quot;)); return r;})
                                .collect(Collectors.toList());
                        Resources&lt;ClearanceRuleViolationDTO&gt; resources = new Resources&lt;&gt;(ruleViolationDTOs);

                        return new ResponseEntity&lt;&gt;(resources, HttpStatus.FAILED_DEPENDENCY);
                    }
                }
            }
        }

        Map&lt;String,String&gt; okResponse = new HashMap&lt;String,String&gt;() {{put(&quot;status&quot;, &quot;Pass&quot;);}};
        return ResponseEntity.ok(okResponse);
    }

    private List&lt;Rule&gt; getRulesForAssignable(Assignable assignable)
    {
        List&lt;Rule&gt; result = new ArrayList&lt;&gt;();

        List&lt;Duty&gt; duties = getDutiesForAssignable(assignable);
        if(!duties.isEmpty())
        {
            if(duties.size() == 1)
            {
                return ruleDutyMapRepository.findByDutyId(duties.get(0).getID()).stream().map(RuleDutyPair::getRule).collect(Collectors.toList());
            }

            //  Create all combinations of duties
            List&lt;Pair&gt; dutyPairs = new ArrayList&lt;&gt;();
            for(int i = 0; i &lt; duties.size() - 1; ++i)
            {
                for(int j = i + 1; j &lt; duties.size(); ++j)
                {
                    dutyPairs.add(Pair.of(duties.get(i), duties.get(j)));
                }
            }

            for(Pair&lt;Duty,Duty&gt; pair : dutyPairs)
            {
                List&lt;Rule&gt; rules1 = ruleDutyMapRepository.findByDutyId(pair.getFirst().getID()).stream().map(RuleDutyPair::getRule).collect(Collectors.toList());
                List&lt;Rule&gt; rules2 = ruleDutyMapRepository.findByDutyId(pair.getSecond().getID()).stream().map(RuleDutyPair::getRule).collect(Collectors.toList());
                List&lt;Rule&gt; intersection = new ArrayList&lt;&gt;(rules1);
                intersection.retainAll(rules2);
                result.addAll(intersection);
            }
        }
        return result;
    }

    private List&lt;Assignable&gt; getAssignablesForKerberos(String kerberos, boolean excludeTestData) throws JSONException
    {
        ResponseEntity&lt;List&lt;String&gt;&gt; response = campController.getCampPrivilegesByKerberos(kerberos);
        if(response.getStatusCode() != HttpStatus.OK)
        {
            throw new ResourceNotFoundException(&quot;kerberos-&quot; + kerberos);
        }

        List&lt;String&gt; privilegeIDs = response.getBody();
        if(privilegeIDs.isEmpty())
        {
            throw new ResourceNotFoundException(&quot;No CAMP privileges for user: &quot; + kerberos);
        }

        List&lt;Assignable&gt; assignables = assignableRepository.findByPrivilegeIdList(privilegeIDs);

        if(!assignables.isEmpty() &amp;&amp; excludeTestData)
        {
            assignables = assignables.stream().filter(a -&gt; a.getID() &gt; 1000).collect(Collectors.toList());
        }

        return assignables;
    }

    private List&lt;Duty&gt; getDutiesForAssignable(Assignable assignable)
    {
        List&lt;Duty&gt; result = new ArrayList&lt;&gt;();

        List&lt;DutyAssignablePair&gt; dutyAssignablePairs = dutyAssignableMapRepository.findByPrivilegeId(assignable.getID());
        if(!dutyAssignablePairs.isEmpty())
        {
            result = dutyAssignablePairs.stream().map(DutyAssignablePair::getDuty).collect(Collectors.toList());
        }
        return result;
    }

    private Set&lt;Duty&gt; getDutiesForAssignables(List&lt;Assignable&gt; assignables)
    {
        Set&lt;Duty&gt; allDuties = new HashSet&lt;&gt;();
        for(Assignable assignable : assignables)
        {
            List&lt;DutyAssignablePair&gt; dutyPrivilegePairs = dutyAssignableMapRepository.findByPrivilegeId(assignable.getID());
            Set&lt;Duty&gt; dutiesSet = dutyPrivilegePairs.stream().map(DutyAssignablePair::getDuty).collect(Collectors.toSet());
            allDuties.addAll(dutiesSet);
        }
        return allDuties;
    }

    private List&lt;Duty&gt; getDutiesForAssignableIDs(List&lt;Long&gt; assignableIdList)
    {
        List&lt;DutyAssignablePair&gt; dutyAssignablePairList = dutyAssignableMapRepository.findByPrivilegeIdList(assignableIdList);
        if (!dutyAssignablePairList.isEmpty())
        {
            return dutyAssignablePairList.stream().map(DutyAssignablePair::getDuty).distinct().collect(Collectors.toList());
        }
        return Collections.emptyList();
    }

    private List&lt;Rule&gt; getRulesForAssignableIDs(List&lt;Long&gt; assignableIdList)
    {
        List&lt;Rule&gt; result = new ArrayList&lt;&gt;();

        List&lt;Duty&gt; dutyList = getDutiesForAssignableIDs(assignableIdList);
        if(!dutyList.isEmpty())
        {
            List&lt;Long&gt; hasDutyIdList = dutyList.stream().map(Duty::getID).collect(Collectors.toList());
            List&lt;RuleDutyPair&gt; ruleDutyPairList = ruleDutyMapRepository.findByDutyIdList(hasDutyIdList);
            if (!ruleDutyPairList.isEmpty())
            {
                result.addAll(ruleDutyPairList.stream().map(RuleDutyPair::getRule).collect(Collectors.toList()));
            }
        }

        return result;
    }


    private boolean kerberosHasOverride(String kerberos,
                                        String privilegeId,
                                        Set&lt;Rule&gt; conflictRules,
                                        Map&lt;Duty, List&lt;Assignable&gt;&gt; kerberosDutyAssignableMap)
            throws JSONException
    {
        Set&lt;Rule&gt; remainingConflictRules = new HashSet&lt;&gt;(conflictRules);

        List&lt;Map&lt;String, String&gt;&gt; overridesList = getComOverridesForKerberos(kerberos);

        if(!overridesList.isEmpty())
        {
            for(Map&lt;String,String&gt; overrideMap : overridesList)
            {
                if(isOverrideApprovedAndActive(overrideMap))
                {
                    String override = overrideMap.get(OVERRIDE);
                    String[] overrideParts = override.split(&quot;@&quot;);
                    if (overrideParts[0].equals(PRIVILEGE_OVERRIDE))
                    {
                        int controlId = Integer.parseInt(overrideMap.get(CONTROL_ID));

                        Assignable assignableForRequestedPrivilegeId = assignableRepository
                                .findByPrivilegeIdAndSystem(privilegeId, &quot;AMP&quot;).get();

                        String[] privilegeOverrideParts = overrideParts[1].split(&quot;:&quot;);
                        if (privilegeOverrideParts.length == 2)
                        {
                            String privilegesLeftPart = privilegeOverrideParts[0];
                            List&lt;Long&gt; leftAssignablesIDList = Arrays.stream(privilegesLeftPart.split(&quot;~&quot;))
                                    .skip(1L)
                                    .map(Long::valueOf)
                                    .collect(Collectors.toList());
                            List&lt;Assignable&gt; leftAssignablesList = assignableRepository.findByIdList(leftAssignablesIDList);

                            String rightPrivilegesPart = privilegeOverrideParts[1];
                            List&lt;Long&gt; rightAssignablesIDList = Arrays.stream(rightPrivilegesPart.split(&quot;~&quot;))
                                    .skip(1L)
                                    .map(Long::valueOf)
                                    .collect(Collectors.toList());
                            List&lt;Assignable&gt; rightAssignablesList = assignableRepository.findByIdList(rightAssignablesIDList);


                            if(leftAssignablesList.contains(assignableForRequestedPrivilegeId)
                                    || rightAssignablesList.contains(assignableForRequestedPrivilegeId))
                            {
                                List&lt;Rule&gt; rulesForRightSide = getRulesForAssignableIDs(rightAssignablesIDList);
                                List&lt;Rule&gt; rulesForLeftSide = getRulesForAssignableIDs(leftAssignablesIDList);

                                List&lt;Rule&gt; commonRules = new ArrayList&lt;&gt;(rulesForRightSide);
                                commonRules.retainAll(rulesForLeftSide);

                                List&lt;Rule&gt; matchingRules = remainingConflictRules.stream()
                                        .filter(r -&gt; r.getControlId() == controlId)
                                        .filter(r -&gt; commonRules.contains(r))
                                        .collect(Collectors.toList());
                                if(!matchingRules.isEmpty())
                                {
                                    List&lt;Assignable&gt; assignableListToCheck =
                                            leftAssignablesList.contains(assignableForRequestedPrivilegeId)
                                                    ? rightAssignablesList
                                                    : leftAssignablesList;

                                    Set&lt;Duty&gt; dutiesForAssignablesToCheck = getDutiesForAssignables(assignableListToCheck);
                                    for(Duty duty : dutiesForAssignablesToCheck)
                                    {
                                        List&lt;Assignable&gt; assignablesForKerberosDuty = kerberosDutyAssignableMap.get(duty);
                                        if(!CollectionUtils.isEmpty(assignablesForKerberosDuty))
                                        {
                                            if(assignableListToCheck.containsAll(assignablesForKerberosDuty))
                                            {
                                                remainingConflictRules.removeAll(matchingRules);
                                            }
                                        }
                                        if(remainingConflictRules.isEmpty())
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (overrideParts[0].equals(&quot;RULE_OVERRIDE&quot;))
                    {
                        long ruleId = Long.valueOf(overrideParts[1]);
                        Optional&lt;Rule&gt; ruleOptional = ruleRepository.findById(ruleId);
                        if (ruleOptional.isPresent())
                        {
                            Rule rule = ruleOptional.get();
                            if (conflictRules.contains(rule))
                            {
                                remainingConflictRules.remove(rule);
                            }
                        }
                    }
                }
                if(remainingConflictRules.isEmpty())
                {
                    break;
                }
            }
        }

        return remainingConflictRules.isEmpty();
    }

    private boolean kerberosHasOverride(String kerberos,
                                        Map&lt;Duty, List&lt;Assignable&gt;&gt; kerberosDutyAssignableMap,
                                        Set&lt;Rule&gt; conflictRules) throws JSONException
    {
        //  This function used to validate user
        List&lt;Map&lt;String, String&gt;&gt; overridesList = getComOverridesForKerberos(kerberos);

        if(!overridesList.isEmpty())
        {
            Map&lt;List&lt;Long&gt;, List&lt;Long&gt;&gt; assignableOverridesMap = new HashMap&lt;&gt;();
            for(Map&lt;String,String&gt; overrideMap : overridesList)
            {
                if(isOverrideApprovedAndActive(overrideMap))
                {
                    String override = overrideMap.get(OVERRIDE);
                    String[] overrideParts = override.split(&quot;@&quot;);
                    if (overrideParts[0].equals(PRIVILEGE_OVERRIDE))
                    {
                        String[] assignableOverrideParts = overrideParts[1].split(&quot;:&quot;);
                        if (assignableOverrideParts.length == 2)
                        {
                            String leftAssignables = assignableOverrideParts[0];
                            String rightAssignables = assignableOverrideParts[1];
                            if(StringUtils.hasText(leftAssignables) &amp;&amp; StringUtils.hasText(rightAssignables))
                            {
                                List&lt;Long&gt; leftAssignableList = Arrays.stream(leftAssignables.split(&quot;~&quot;)).skip(1L).map(Long::valueOf).collect(Collectors.toList());
                                List&lt;Long&gt; rightAssignableList = Arrays.stream(rightAssignables.split(&quot;~&quot;)).skip(1L).map(Long::valueOf).collect(Collectors.toList());

                                assignableOverridesMap.computeIfAbsent(leftAssignableList, e -&gt; new ArrayList&lt;&gt;()).addAll(rightAssignableList);
                            }
                        }
                    }
                    else if (overrideParts[0].equals(RULE_OVERRIDE))
                    {
                        int ruleId = Integer.valueOf(overrideParts[1]);
                        Optional&lt;Rule&gt; ruleOptional = ruleRepository.findById(ruleId);
                        if (ruleOptional.isPresent())
                        {
                            Rule rule = ruleOptional.get();
                            if (conflictRules.contains(rule))
                            {
                                conflictRules.remove(rule);
                            }
                        }
                    }
                }
            }

            if(!conflictRules.isEmpty() &amp;&amp; !assignableOverridesMap.isEmpty())
            {
                Set&lt;Rule&gt; matchedRules = new HashSet&lt;&gt;();
                for(Rule rule : conflictRules)
                {
                    List&lt;Duty&gt; duties = rule.getRuleDutyMappings().stream().map(RuleDutyPair::getDuty).collect(Collectors.toList());
                    if (duties.size() == 2)
                    {
                        Duty duty1 = duties.get(0);
                        Duty duty2 = duties.get(1);
                        List&lt;Assignable&gt; assignables1 = kerberosDutyAssignableMap.get(duty1);
                        List&lt;Assignable&gt; assignables2 = kerberosDutyAssignableMap.get(duty2);
                        if (!(assignables1 == null || assignables2 == null || assignables1.isEmpty() || assignables2.isEmpty()))
                        {
                            List&lt;Long&gt; assignables1IDs = assignables1.stream().map(Assignable::getID).collect(Collectors.toList());
                            List&lt;Long&gt; assignables2IDs = assignables2.stream().map(Assignable::getID).collect(Collectors.toList());
                            for (Map.Entry&lt;List&lt;Long&gt;, List&lt;Long&gt;&gt; e : assignableOverridesMap.entrySet())
                            {
                                List&lt;Long&gt; leftIDs = e.getKey();
                                List&lt;Long&gt; rightIDs = e.getValue();

                                if ((leftIDs.containsAll(assignables1IDs) &amp;&amp; rightIDs.containsAll(assignables2IDs)) ||
                                        (leftIDs.containsAll(assignables2IDs) &amp;&amp; rightIDs.containsAll(assignables1IDs)))
                                {
                                    matchedRules.add(rule);
                                    break;
                                }
                            }
                        }
                    }
                }

                conflictRules.removeAll(matchedRules);
            }
        }
        return conflictRules.isEmpty();
    }

    private boolean isOverrideApprovedAndActive(Map&lt;String,String&gt; overrideMap)
    {
        String state = overrideMap.get(STATE);
        String expiryDateStr = overrideMap.get(EXPIRY_DATE);
        if(StringUtils.hasText(state) &amp;&amp; StringUtils.hasText(expiryDateStr))
        {
            if(!state.equals(&quot;APPROVED&quot;))
            {
                return false;
            }
            Instant expiryInstant = Instant.parse(expiryDateStr);
            if(Instant.now().compareTo(expiryInstant) &gt; 0)
            {
                return false;
            }
            return true;
        }
        return false;
    }

    private List&lt;Map&lt;String, String&gt;&gt; getComOverridesForKerberos(String kerberos) throws JSONException
    {
        ResponseEntity&lt;Map&lt;String,List&lt;Map&lt;String, String&gt;&gt;&gt;&gt; response = comController.getComOverrides(kerberos);
        if(response != null &amp;&amp; response.getStatusCode() == HttpStatus.OK)
        {
            Map&lt;String,List&lt;Map&lt;String, String&gt;&gt;&gt; overridesMap = response.getBody();
            return overridesMap.values().stream().flatMap(List::stream).collect(Collectors.toList());
        }

        return Collections.emptyList();
    }


    private Link createDutyLink(Duty duty)
    {
        return linkTo(methodOn(DutyController.class).getDuty(duty.getID())).withRel(&quot;duty&quot;).withTitle(duty.getName());
    }
}



</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@RestController
@RepositoryRestController
public class RmsController
{
    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private RestTemplate restTemplate;

    @Autowired
    private CredrefAuthentication credrefAuthentication;

    @Value(&quot;${rmsOrgMemberships.url}&quot;)
    private String rmsOrgMembershipsUrl;

    @Value(&quot;${rmsTeamMembers.url}&quot;)
    private String rmsTeamMembersUrl;

    @Value(&quot;${rmsHierarchy.url}&quot;)
    private String rmsHierarchyUrl;

    @Autowired
    private PeopleSearchController peopleSearchController;

    private HttpHeaders headers;


    @GetMapping(&quot;/rms/hierarchy/guid/{guid}&quot;)
    public ResponseEntity&lt;LinkedHashMap&lt;String, Map&lt;String,String&gt;&gt;&gt; getRmsHierarchyByGuid(@PathVariable(&quot;guid&quot;) String guid)
    {
        ResponseEntity&lt;?&gt; responseEntity;

        String url = String.format(rmsOrgMembershipsUrl, guid);
        try
        {
            responseEntity = restTemplate.getForEntity(url, Map.class);
        }
        catch(Exception e)
        {
            throw new ResourceNotFoundException(&quot;Guid: &quot; + guid);
        }
        finally
        {
            logger.info(&quot;External RMS GET Request: {}&quot;, url);
        }

        LinkedHashMap&lt;String, Map&lt;String,String&gt;&gt; result = new LinkedHashMap&lt;&gt;();
        if(responseEntity != null &amp;&amp; responseEntity.getStatusCode() == HttpStatus.OK)
        {
            ResponseEntity&lt;Map&lt;String,Object&gt;&gt; rmsResponse = (ResponseEntity&lt;Map&lt;String,Object&gt;&gt;)responseEntity;
            Map&lt;String,Object&gt; valueMap = rmsResponse.getBody();
            List&lt;LinkedHashMap&lt;String,Object&gt;&gt; dataMapList = (ArrayList&lt;LinkedHashMap&lt;String, Object&gt;&gt;) valueMap.get(&quot;data&quot;);
            Map&lt;String,Object&gt; dataMap = dataMapList.get(0);
            Map&lt;String,Map&lt;String,String&gt;&gt; linksMap = (Map&lt;String,Map&lt;String,String&gt;&gt;)dataMap.get(&quot;links&quot;);
            Map&lt;String,String&gt; parentNodeLinkMap = linksMap.get(&quot;parent-node&quot;);
            String parentLink = parentNodeLinkMap.get(&quot;href&quot;);

            while(true)
            {
                responseEntity = restTemplate.getForEntity(parentLink, Map.class);
                rmsResponse = (ResponseEntity&lt;Map&lt;String,Object&gt;&gt;)responseEntity;
                valueMap = rmsResponse.getBody();
                dataMap = (LinkedHashMap&lt;String, Object&gt;) valueMap.get(&quot;data&quot;);
                linksMap = (Map&lt;String,Map&lt;String,String&gt;&gt;)dataMap.get(&quot;links&quot;);
                parentNodeLinkMap = linksMap.get(&quot;parent-node&quot;);
                parentLink = parentNodeLinkMap.get(&quot;href&quot;);

                Object parentNodeCode = dataMap.get(&quot;parentNodeCode&quot;);

                if(parentNodeCode == null)
                {
                    break;
                }

                String code = (String)dataMap.get(&quot;code&quot;);
                String nodeType = (String)dataMap.get(&quot;nodeType&quot;);
                String name = (String)dataMap.get(&quot;name&quot;);

                result.put(code, new HashMap&lt;String,String&gt;() {{
                    put(&quot;nodeType&quot;, nodeType);
                    put(&quot;name&quot;, name);
                }});
            }
            return ResponseEntity.ok(result);
        }
        return ResponseEntity.noContent().build();
    }

    @GetMapping(&quot;/rms/hierarchy/kerberos/{kerberos}&quot;)
    public ResponseEntity&lt;LinkedHashMap&lt;String, Map&lt;String,String&gt;&gt;&gt; getRmsHierarchyByKerberos(@PathVariable(&quot;kerberos&quot;) String kerberos) throws JSONException
    {
        ResponseEntity&lt;Map&lt;String,String&gt;&gt; peopleResponse = peopleSearchController.findByKerberos(kerberos);
        Map&lt;String,String&gt; peopleMap = peopleResponse.getBody();
        String guid = peopleMap.get(&quot;gsguid&quot;);
        return getRmsHierarchyByGuid(guid);
    }

    @GetMapping(&quot;/rms/{code}/team-members&quot;)
    public ResponseEntity&lt;List&lt;LinkedHashMap&lt;String,String&gt;&gt;&gt; getRmsTeamMembers(@PathVariable(&quot;code&quot;) String code,
                                                                                @RequestParam(defaultValue = &quot;true&quot;) boolean usePeopleSearch)
            throws UnsupportedEncodingException
    {
        code = URLDecoder.decode(code, StandardCharsets.UTF_8.name());

        ResponseEntity&lt;?&gt; responseEntity = null;

        try
        {
            responseEntity = restTemplate.getForEntity(String.format(rmsTeamMembersUrl, code), Map.class);
        }
        catch (Exception e)
        {
            if(e instanceof HttpClientErrorException)
            {
                HttpClientErrorException httpClientErrorException = (HttpClientErrorException)e;
                if(httpClientErrorException.getStatusCode() == HttpStatus.FORBIDDEN)
                {
                    throw new InternalServerErrorException(&quot;RMS code must correspond to Team node type. Code: &quot; + code);
                }
            }
            throw new ResourceNotFoundException(&quot;Code: &quot; + code);
        }


        List&lt;LinkedHashMap&lt;String,String&gt;&gt; result = new ArrayList&lt;&gt;();
        if(responseEntity != null &amp;&amp; responseEntity.getStatusCode() == HttpStatus.OK)
        {
            ResponseEntity&lt;Map&lt;String,Object&gt;&gt; rmsResponse = (ResponseEntity&lt;Map&lt;String,Object&gt;&gt;)responseEntity;
            Map&lt;String,Object&gt; valueMap = rmsResponse.getBody();
            List&lt;LinkedHashMap&lt;String,String&gt;&gt; dataMapList = (ArrayList&lt;LinkedHashMap&lt;String, String&gt;&gt;) valueMap.get(&quot;data&quot;);

            for(LinkedHashMap&lt;String,String&gt; entry : dataMapList)
            {
                LinkedHashMap&lt;String,String&gt; memberMap = new LinkedHashMap&lt;&gt;();

                String kerberos = entry.get(&quot;kerberos&quot;);

                memberMap.put(&quot;name&quot;, entry.get(&quot;name&quot;));
                memberMap.put(&quot;guid&quot;, entry.get(&quot;guid&quot;));
                memberMap.put(&quot;kerberos&quot;, kerberos);
                memberMap.put(&quot;employeeNumber&quot;, entry.get(&quot;employeeNumber&quot;));
                memberMap.put(&quot;title&quot;, entry.get(&quot;title&quot;));

                if(usePeopleSearch)
                {
                    ResponseEntity&lt;Map&lt;String, String&gt;&gt; peopleResponse = null;
                    try
                    {
                        peopleResponse = peopleSearchController.findByKerberos(kerberos);
                        if (peopleResponse != null &amp;&amp; peopleResponse.getStatusCode() == HttpStatus.OK)
                        {
                            Map&lt;String, String&gt; peopleSearchMap = peopleResponse.getBody();

                            memberMap.put(&quot;phone&quot;, peopleSearchMap.get(&quot;telephonenumber&quot;));
                            memberMap.put(&quot;location&quot;, peopleSearchMap.get(&quot;l&quot;));
                            memberMap.put(&quot;department&quot;, peopleSearchMap.get(&quot;gsdeptcode&quot;));
                        }
                    }
                    catch (Exception e)
                    {
                        logger.error(&quot;PeopleSearch request failed for kerberos: {}&quot;, kerberos);
                    }
                }

                result.add(memberMap);
            }
            return ResponseEntity.ok(result);
        }
        return ResponseEntity.noContent().build();
    }


    protected ResponseEntity&lt;?&gt; getCustomOrg(String code)
    {
        ResponseEntity&lt;?&gt; responseEntity = null;

         try
         {
             responseEntity = restTemplate.getForEntity(String.format(rmsHierarchyUrl, code), Map.class);
         }
         catch(Exception e)
         {
             if(responseEntity == null || responseEntity.getStatusCode() != HttpStatus.OK)
             {
                 logger.error(&quot;Code: {}&quot;, code);
                 throw new InternalServerErrorException(&quot;RMS request failed for code: &quot; + code);
             }
         }
         return responseEntity;
    }

    @GetMapping(&quot;/rms/{code}/hierarchy-links&quot;)
    public ResponseEntity&lt;List&lt;List&lt;String&gt;&gt;&gt; getRmsHierarchyLinks(@PathVariable(&quot;code&quot;) String code) throws UnsupportedEncodingException
    {
        ResponseEntity&lt;?&gt; responseEntity = getCustomOrg(code);

        ResponseEntity&lt;Map&lt;String,Object&gt;&gt; rmsResponse = (ResponseEntity&lt;Map&lt;String,Object&gt;&gt;)responseEntity;
        Map&lt;String,Object&gt; valueMap = rmsResponse.getBody();
        LinkedHashMap&lt;String,Object&gt; dataMap = (LinkedHashMap&lt;String, Object&gt;) valueMap.get(&quot;data&quot;);


        Map&lt;String,Map&lt;String,String&gt;&gt; linksMap = (Map&lt;String,Map&lt;String,String&gt;&gt;)dataMap.get(&quot;links&quot;);
        Map&lt;String,String&gt; selfLinkMap = linksMap.get(&quot;self&quot;);
        String selfLink = selfLinkMap.get(&quot;href&quot;);

        List&lt;List&lt;String&gt;&gt; result = new ArrayList&lt;&gt;();
        result.add(Arrays.asList(selfLink));


        List&lt;String&gt; currentChildLinks = new ArrayList&lt;&gt;();

        Map&lt;String,String&gt; childLinkMap = linksMap.get(&quot;child-nodes&quot;);
        String childLink = childLinkMap.get(&quot;href&quot;);

        currentChildLinks.add(childLink);

        while(!currentChildLinks.isEmpty())
        {
            List&lt;String&gt; currentSelfLinks = new ArrayList&lt;&gt;();

            List&lt;String&gt; parentChildLinks = currentChildLinks;
            currentChildLinks = new ArrayList&lt;&gt;();

            for (String parent : parentChildLinks)
            {
                logger.info(&quot;Before encode = {}&quot;, parent);
                parent = URLEncoder.encode(parent, StandardCharsets.UTF_8.name());
                logger.info(&quot;After encode = {}&quot;, parent);
                parent = URLDecoder.decode(parent, StandardCharsets.UTF_8.name());
                logger.info(&quot;After decode 1 = {}&quot;, parent);
                parent = URLDecoder.decode(parent, StandardCharsets.UTF_8.name());
                logger.info(&quot;After decode 2 = {}&quot;, parent);

                try
                {
                    responseEntity = restTemplate.getForEntity(parent, Map.class);
                }
                catch(Exception e)
                {
                    logger.error(&quot;Error: &quot;, e);
                    continue;
                }

                if(responseEntity.getStatusCode() == HttpStatus.OK)
                {
                    rmsResponse = (ResponseEntity&lt;Map&lt;String, Object&gt;&gt;) responseEntity;
                    valueMap = rmsResponse.getBody();
                    List&lt;LinkedHashMap&lt;String, Object&gt;&gt; dataMapList = (ArrayList&lt;LinkedHashMap&lt;String, Object&gt;&gt;) valueMap.get(&quot;data&quot;);


                    for (LinkedHashMap&lt;String, Object&gt; map : dataMapList)
                    {
                        linksMap = (Map&lt;String, Map&lt;String, String&gt;&gt;) map.get(&quot;links&quot;);
                        if (linksMap != null)
                        {
                            Map&lt;String, String&gt; selfNodesMap = linksMap.get(&quot;self&quot;);
                            if(selfNodesMap != null)
                            {
                                currentSelfLinks.add(selfNodesMap.get(&quot;href&quot;));
                            }

                            String nodeType = (String)map.get(&quot;nodeType&quot;);
                            if(!nodeType.equals(&quot;Team&quot;))
                            {
                                Map&lt;String, String&gt; childNodesMap = linksMap.get(&quot;child-nodes&quot;);
                                if (childNodesMap != null)
                                {
                                    currentChildLinks.add(childNodesMap.get(&quot;href&quot;));
                                }
                            }
                        }
                    }
                }
            }
            result.add(currentSelfLinks);
        }

        return ResponseEntity.ok(result);
    }

    @GetMapping(&quot;/rms/{code}/hierarchy&quot;)
    public ResponseEntity&lt;Map&lt;String,Object&gt;&gt; getRmsHierarchy(@PathVariable(&quot;code&quot;) String code,
                                                              @RequestParam(defaultValue = &quot;true&quot;) boolean includePeople)
            throws UnsupportedEncodingException, JSONException
    {
        ResponseEntity&lt;?&gt; responseEntity;

        try
        {
            responseEntity = restTemplate.getForEntity(String.format(rmsHierarchyUrl, code), Map.class);
        }
        catch(Exception e)
        {
            if(e instanceof HttpClientErrorException)
            {
                HttpClientErrorException httpClientErrorException = (HttpClientErrorException)e;
                if(httpClientErrorException.getStatusCode() == HttpStatus.FORBIDDEN)
                {
                    throw new InternalServerErrorException(&quot;RMS forbid this operation. Code: &quot; + code);
                }
            }
            throw new ResourceNotFoundException(&quot;Code: &quot; + code);
        }

        Map&lt;String,Object&gt; result = new LinkedHashMap&lt;&gt;();
        if(responseEntity != null &amp;&amp; responseEntity.getStatusCode() == HttpStatus.OK)
        {
            ResponseEntity&lt;Map&lt;String,Object&gt;&gt; rmsResponse = (ResponseEntity&lt;Map&lt;String,Object&gt;&gt;)responseEntity;
            Map&lt;String,Object&gt; valueMap = rmsResponse.getBody();
            LinkedHashMap&lt;String,Object&gt; dataMap = (LinkedHashMap&lt;String, Object&gt;) valueMap.get(&quot;data&quot;);

            GraphNode parentNode = new GraphNode(dataMap);
            addChildren(parentNode, includePeople);

            //  handle case when the supplied code corresponds to a Team, i.e. no children
            if(includePeople &amp;&amp; parentNode.getChildren().isEmpty())
            {
                addTeamMembers(parentNode);
            }

            GraphNode.toMap(parentNode, result);

            return ResponseEntity.ok(result);
        }

        return ResponseEntity.noContent().build();
    }

    private void addChildren(GraphNode parent, boolean includePeople) throws UnsupportedEncodingException, JSONException
    {
        String link = parent.getChildLink();
        logger.info(&quot;Before encode = {}&quot;, link);
        link = URLEncoder.encode(link, StandardCharsets.UTF_8.name());
        logger.info(&quot;After encode = {}&quot;, link);
        link = URLDecoder.decode(link, StandardCharsets.UTF_8.name());
        logger.info(&quot;After decode 1 = {}&quot;, link);
        link = URLDecoder.decode(link, StandardCharsets.UTF_8.name());
        logger.info(&quot;After decode 2 = {}&quot;, link);

        ResponseEntity&lt;?&gt; responseEntity = null;
        try
        {
            responseEntity = restTemplate.getForEntity(link, Map.class);
        }
        catch(Exception e)
        {
            logger.error(&quot;Link: {}&quot;, link);
        }

        if(responseEntity != null &amp;&amp; responseEntity.getStatusCode() == HttpStatus.OK)
        {
            ResponseEntity&lt;Map&lt;String,Object&gt;&gt; rmsResponse = (ResponseEntity&lt;Map&lt;String, Object&gt;&gt;) responseEntity;
            Map&lt;String,Object&gt; valueMap = rmsResponse.getBody();
            List&lt;LinkedHashMap&lt;String, Object&gt;&gt; dataMapList = (ArrayList&lt;LinkedHashMap&lt;String, Object&gt;&gt;) valueMap.get(&quot;data&quot;);


            List&lt;GraphNode&gt; childNodes = new ArrayList&lt;&gt;();
            for (LinkedHashMap&lt;String, Object&gt; map : dataMapList)
            {
                GraphNode childNode = new GraphNode(map);
                childNodes.add(childNode);
                if(!childNode.getNodeType().equals(&quot;Team&quot;))
                {
                    addChildren(childNode, includePeople);
                }
                else
                {
                    if(includePeople)
                    {
                        addTeamMembers(childNode);
                    }
                }
            }

            parent.addChildren(childNodes);
        }
    }

    private void addTeamMembers(GraphNode node) throws UnsupportedEncodingException
    {
        String code = node.getCode();
        if (code.indexOf(&#39;/&#39;) == -1 &amp;&amp; code.indexOf(&#39;#&#39;) == -1)
        {
            code = URLEncoder.encode(code, StandardCharsets.UTF_8.name());
            ResponseEntity&lt;List&lt;LinkedHashMap&lt;String, String&gt;&gt;&gt; teamMembersResponse = getRmsTeamMembers(code, true);

            if (teamMembersResponse.getStatusCode() == HttpStatus.OK)
            {
                List&lt;LinkedHashMap&lt;String, String&gt;&gt; teamMembers = teamMembersResponse.getBody();
                if (!teamMembers.isEmpty())
                {
                    node.addTeamMembers(teamMembers);
                }
            }
        }
    }

    private static class GraphNode
    {
        String name;
        String nodeType;
        String code;
        String childLink;
        List&lt;GraphNode&gt; children = new ArrayList&lt;&gt;();
        List&lt;LinkedHashMap&lt;String,String&gt;&gt; teamMembers;

        GraphNode(LinkedHashMap&lt;String,Object&gt; map)
        {
            name = (String)map.get(&quot;name&quot;);
            nodeType = (String)map.get(&quot;nodeType&quot;);
            code = (String)map.get(&quot;code&quot;);

            Map&lt;String,Map&lt;String,String&gt;&gt; linksMap = (Map&lt;String,Map&lt;String,String&gt;&gt;)map.get(&quot;links&quot;);
            Map&lt;String,String&gt; childLinkMap = linksMap.get(&quot;child-nodes&quot;);
            childLink = childLinkMap.get(&quot;href&quot;);
        }

        String getChildLink()
        {
            return childLink;
        }

        String getNodeType()
        {
            return nodeType;
        }

        String getCode()
        {
            return code;
        }

        void addChildren(List&lt;GraphNode&gt; children)
        {
            this.children.addAll(children);
        }

        List&lt;GraphNode&gt; getChildren()
        {
            return this.children;
        }

        void addTeamMembers(List&lt;LinkedHashMap&lt;String,String&gt;&gt; teamMembers)
        {
            this.teamMembers = teamMembers;
        }

        List&lt;LinkedHashMap&lt;String,String&gt;&gt; getTeamMembers()
        {
            return teamMembers;
        }

        static void toMap(GraphNode node, Map&lt;String,Object&gt; result)
        {
            result.put(&quot;name&quot;, node.name);
            result.put(&quot;nodeType&quot;, node.nodeType);
            result.put(&quot;code&quot;, node.code);

            List&lt;LinkedHashMap&lt;String,String&gt;&gt; team = node.getTeamMembers();
            if(team != null)
            {
                result.put(&quot;team&quot;, team);
            }

            List&lt;Map&lt;String,Object&gt;&gt; childList = new ArrayList&lt;&gt;();
            for(GraphNode childNode : node.children)
            {
                Map&lt;String,Object&gt; map = new LinkedHashMap&lt;&gt;();
                toMap(childNode, map);
                childList.add(map);
            }

            if(!childList.isEmpty())
            {
                result.put(&quot;children&quot;, childList);
            }
        }
    }
}


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Transactional
@RestController
@RepositoryRestController
public class ComController
{
    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private PeopleSearchController peopleSearchController;

    @Autowired
    private RmsController rmsController;

    @Value(&quot;${kerberos.asset.type.id}&quot;)
    private String kerberosAssetTypeId;
    @Value(&quot;${rmsnode.asset.type.id}&quot;)
    private String rmsNodeAssetTypeId;

    @Autowired
    private RuleRepository ruleRepository;
    @Autowired
    private DutyAssignableMapRepository dutyAssignableMapRepository;
    @Autowired
    private RuleDutyMapRepository ruleDutyMapRepository;

    @Autowired
    private RestTemplate restTemplate;

    @Value(&quot;${comSetBulkOverride.url}&quot;)
    private String comSetBulkOverrideUrl;
    @Value(&quot;${comGetRmsNodeOverride.url}&quot;)
    private String comGetRmsNodeOverrideUrl;
    @Value(&quot;${comGetKerberosOverride.url}&quot;)
    private String comGetKerberosOverrideUrl;
    @Value(&quot;${comDeleteOverride.url}&quot;)
    private String comDeleteOverrideUrl;
    @Value(&quot;${control.url}&quot;)
    private String controlUrl;
    @Value(&quot;${comGetControlIdUrl}&quot;)
    private String comGetControlUrl;

    @PostMapping(&quot;/com/rmsnode/{approverKerberos}/{value}&quot;)
    public ResponseEntity&lt;?&gt; setComRmsNodeBulkOverride(@RequestBody ComOverrideRmsNodeInput comOverrideRmsNodeInput,
                                                       @PathVariable(&quot;approverKerberos&quot;) String approverKerberos,
                                                       @PathVariable(&quot;value&quot;) String value) throws JSONException
    {
        List&lt;String&gt; rmsNodes = comOverrideRmsNodeInput.getRmsNodes();
        for(String rmsNode : rmsNodes)
        {
            rmsController.getCustomOrg(rmsNode);
        }
        return createComBulkOverride(rmsNodes, rmsNodeAssetTypeId, &quot;RmsNode&quot;, approverKerberos, value);
    }

    @PostMapping(&quot;/com/kerberos/{approverKerberos}/{value}&quot;)
    public ResponseEntity&lt;?&gt; setComKerberosBulkOverride(@RequestBody ComOverrideKerberosInput comOverrideKerberosInput,
                                                        @PathVariable(&quot;approverKerberos&quot;) String approverKerberos,
                                                        @PathVariable(&quot;value&quot;) String value) throws JSONException
    {
        List&lt;String&gt; users = comOverrideKerberosInput.getUsers();
        return createComBulkOverride(users, kerberosAssetTypeId, &quot;Kerberos&quot;, approverKerberos, value);
    }

    @PostMapping(&quot;/com/exemption-owners&quot;)
    public ResponseEntity&lt;?&gt; getControlExemptionOwners(@RequestBody RuleControlIDsInput ruleControlIDsInput)
    {
        Map&lt;Integer,List&lt;String&gt;&gt; response = new HashMap&lt;&gt;();
        List&lt;Integer&gt; ruleControlIDs = ruleControlIDsInput.getRuleControlIDs();
        for(int ruleControlId : ruleControlIDs)
        {
            List&lt;String&gt; exemptionOwners = null;
            try
            {
                exemptionOwners = getExemptionOwners(ruleControlId);
            }
            catch (ResourceNotFoundException e)
            {
                logger.info(&quot;No info for control ID: {}&quot;, ruleControlId);
            }
            if(exemptionOwners != null)
            {
                response.put(ruleControlId, exemptionOwners);
            }
        }
        if(response.isEmpty())
        {
            throw new ResourceNotFoundException(&quot;None of specified control IDs were found&quot;);
        }
        return ResponseEntity.ok(response);
    }


    @GetMapping(&quot;/com/{kerberos}&quot;)
    public ResponseEntity&lt;Map&lt;String,List&lt;Map&lt;String,String&gt;&gt;&gt;&gt; getComOverrides(@PathVariable(&quot;kerberos&quot;) String kerberos)
            throws JSONException
    {
        List&lt;String&gt; input = new ArrayList&lt;&gt;();
        input.add(kerberos);

        ResponseEntity&lt;String&gt; comResponse = null;
        try
        {
            comResponse = restTemplate.postForEntity(comGetKerberosOverrideUrl, input, String.class);
        }
        catch(Exception e)
        {
            logger.info(&quot;No overrides for Kerberos &#39;{}&#39;&quot;, kerberos);
        }

        Map&lt;String,List&lt;Map&lt;String,String&gt;&gt;&gt; response = new HashMap&lt;&gt;();
        if(comResponse != null &amp;&amp; comResponse.getStatusCode() == HttpStatus.OK)
        {
            List&lt;Map&lt;String, String&gt;&gt; data = new ArrayList&lt;&gt;();

            JSONArray jsonArray = new JSONArray(comResponse.getBody());
            for (int i = 0; i &lt; jsonArray.length(); ++i)
            {
                JSONObject jsonObject = (JSONObject) jsonArray.get(i);

                Map&lt;String, String&gt; map = new HashMap&lt;&gt;();
                map.put(&quot;override&quot;, (String) jsonObject.get(&quot;patchScope&quot;));
                map.put(&quot;expiryDate&quot;, (String) jsonObject.get(&quot;expiryDate&quot;));
                map.put(&quot;state&quot;, (String) jsonObject.get(&quot;state&quot;));
                map.put(&quot;id&quot;, String.valueOf(jsonObject.get(&quot;id&quot;)));
                map.put(&quot;control id&quot;, String.valueOf(jsonObject.get(&quot;control&quot;)));

                data.add(map);
            }


            if (!data.isEmpty())
            {
                response.put(&quot;kerberos overrides&quot;, data);
            }
        }

        ResponseEntity&lt;LinkedHashMap&lt;String, Map&lt;String,String&gt;&gt;&gt; rmsHierarchyResponse = rmsController.getRmsHierarchyByKerberos(kerberos);
        LinkedHashMap&lt;String, Map&lt;String,String&gt;&gt; rmsHierarchyMap = rmsHierarchyResponse.getBody();

        for(Map.Entry&lt;String, Map&lt;String,String&gt;&gt; e : rmsHierarchyMap.entrySet())
        {
            String code = e.getKey();
            List&lt;Map&lt;String,String&gt;&gt; rmsNodeOverrides = getComRmsNodeOverridesForRmsNodeCode(code);
            if(!rmsNodeOverrides.isEmpty())
            {
                Map&lt;String,String&gt; value = e.getValue();
                String name = value.get(&quot;name&quot;);
                String type = value.get(&quot;nodeType&quot;);

                response.put(String.format(&quot;%s (%s-%s) override&quot;, type, name, code), rmsNodeOverrides);
            }
        }

        return response.isEmpty() ? ResponseEntity.noContent().build() : ResponseEntity.ok(response);
    }

    @DeleteMapping(&quot;/com/{id}&quot;)
    public ResponseEntity&lt;?&gt; deleteComOverride(@PathVariable(&quot;id&quot;) int id) throws JSONException
    {
        ResponseEntity&lt;String&gt; comResponse;
        try
        {
            comResponse = restTemplate.exchange(String.format(comDeleteOverrideUrl, id), HttpMethod.DELETE, null, String.class);
        }
        catch(Exception e)
        {
            throw new ResourceNotFoundException(&quot;No overrides for id: &quot; + id);
        }

        return ResponseEntity.ok(comResponse);
    }

    @GetMapping(&quot;/com&quot;)
    public ResponseEntity&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt; getComAllOverrides() throws JSONException
    {
        List&lt;Integer&gt; controlIDs = ruleRepository.findAllControlIDs();

        List&lt;Map&lt;String, Object&gt;&gt; response = new ArrayList&lt;&gt;();

        for(int controlId : controlIDs)
        {
            String url = String.format(comGetControlUrl, controlId);

            ResponseEntity&lt;String&gt; comResponse = null;

            try
            {
                comResponse = restTemplate.getForEntity(url, String.class);

            }
            catch (Exception e)
            {
                logger.info(&quot;No overrides for controlId &#39;{}&#39;&quot;, controlId);
            }
            finally
            {
                logger.info(&quot;External COM GET Request: {}&quot;, url);
            }

            if (comResponse != null &amp;&amp; comResponse.getStatusCode() == HttpStatus.OK)
            {
                JSONArray jsonArray = new JSONArray(comResponse.getBody());
                for (int i = 0; i &lt; jsonArray.length(); ++i)
                {
                    JSONObject jsonObject = (JSONObject) jsonArray.get(i);

                    Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();

                    map.put(&quot;override&quot;, jsonObject.get(&quot;patchScope&quot;));
                    map.put(&quot;expiryDate&quot;, jsonObject.get(&quot;expiryDate&quot;));
                    map.put(&quot;state&quot;, jsonObject.get(&quot;state&quot;));
                    map.put(&quot;id&quot;, String.valueOf(jsonObject.get(&quot;id&quot;)));
                    map.put(&quot;controlId&quot;, String.valueOf(jsonObject.get(&quot;control&quot;)));
                    map.put(&quot;requestDate&quot;, jsonObject.get(&quot;requestDate&quot;));
                    map.put(&quot;expiryDate&quot;, jsonObject.get(&quot;expiryDate&quot;));
                    map.put(&quot;assetTypeName&quot;, jsonObject.get(&quot;assetTypeName&quot;));

                    JSONArray assetScopesJsonArray = (JSONArray)jsonObject.get(&quot;assetScopes&quot;);
                    List&lt;String&gt; assetIds = new ArrayList&lt;&gt;();
                    for(int j = 0; j &lt; assetScopesJsonArray.length(); ++j)
                    {
                        JSONObject jsonSubObject = (JSONObject) assetScopesJsonArray.get(j);
                        assetIds.add((String)jsonSubObject.get(&quot;assetId&quot;));
                    }

                    map.put(&quot;assetScopes&quot;, assetIds);

                    response.add(map);
                }
            }
        }

        return ResponseEntity.ok(response);
    }

    List&lt;Map&lt;String,String&gt;&gt; getComRmsNodeOverridesForRmsNodeCode(String code) throws JSONException
    {
        List&lt;String&gt; input = new ArrayList&lt;&gt;();
        input.add(code);

        ResponseEntity&lt;String&gt; comResponse = null;
        try
        {
            comResponse = restTemplate.postForEntity(comGetRmsNodeOverrideUrl, input, String.class);
        }
        catch(Exception e)
        {
            // COM throws exception when value is not found
            logger.info(&quot;Code &#39;{}&#39; not found in COM&quot;, code);
        }
        finally
        {
            logger.info(&quot;External COM POST Request: {}, body: [\&quot;{}\&quot;]&quot;, comGetRmsNodeOverrideUrl, code);
        }

        List&lt;Map&lt;String,String&gt;&gt; result = new ArrayList&lt;&gt;();
        if(comResponse != null &amp;&amp; comResponse.getStatusCode() == HttpStatus.OK)
        {
            JSONArray jsonArray = new JSONArray(comResponse.getBody());
            for(int i = 0; i &lt; jsonArray.length(); ++i)
            {
                JSONObject jsonObject = (JSONObject)jsonArray.get(i);

                Map&lt;String,String&gt; map = new HashMap&lt;&gt;();
                map.put(&quot;override&quot;, (String)jsonObject.get(&quot;patchScope&quot;));
                map.put(&quot;expiryDate&quot;, (String)jsonObject.get(&quot;expiryDate&quot;));
                map.put(&quot;state&quot;, (String)jsonObject.get(&quot;state&quot;));
                map.put(&quot;id&quot;, String.valueOf(jsonObject.get(&quot;id&quot;)));

                result.add(map);
            }
        }

        return result;
    }

    private ResponseEntity&lt;?&gt; createComBulkOverride(List&lt;String&gt; users, String assetTypeId, String assetTypeName, String approverKerberos, String override) throws JSONException
    {
        List&lt;Integer&gt; controlIds = getControlIdFromOverrideValue(override);

        String approverFullName = getFullNameForKerberos(approverKerberos);

        List&lt;Map&lt;String,Object&gt;&gt; assetScopes = new ArrayList&lt;&gt;();
        for(String user : users)
        {
            final String fullName;
            if(assetTypeId.equals(kerberosAssetTypeId))
            {
                fullName = getFullNameForKerberos(user);
            }
            else
            {
                fullName = &quot;Tech Risk Engineering&quot;;
            }

            Map&lt;String,Object&gt; assetScopeMap = new HashMap&lt;&gt;() {{
                put(&quot;assetId&quot;, user);
                put(&quot;assetName&quot;, fullName);
                put(&quot;assetTypeName&quot;, assetTypeId);
                put(&quot;divisionName&quot;, &quot;&quot;);
                put(&quot;businessUnitName&quot;, &quot;&quot;);
            }};
            assetScopes.add(assetScopeMap);
        }

        URI location = null;
        for(int controlId : controlIds)
        {
            List&lt;Map&lt;String,Object&gt;&gt; exemptionOwners = new ArrayList&lt;&gt;();

            List&lt;String&gt; controlOwners = getExemptionOwners(controlId);
            for(String controlOwner : controlOwners)
            {
                Map&lt;String,Object&gt; exemptionOwnersMap = new HashMap&lt;&gt;() {{
                    put(&quot;kerberos&quot;, controlOwner);
                    put(&quot;reason&quot;, &quot;Added by Requestor&quot;);
                    put(&quot;lastUpdatedBy&quot;, controlOwner);
                    put(&quot;lastModifiedBy&quot;, controlOwner);
                }};
                exemptionOwners.add(exemptionOwnersMap);
            }

            Map&lt;String, Object&gt; bodyMap = new HashMap&lt;&gt;();

            bodyMap.put(&quot;parentExemptionId&quot;, 0);
            bodyMap.put(&quot;control&quot;, controlId);
            bodyMap.put(&quot;controlName&quot;, &quot;SoD &quot; + assetTypeName + &quot; Override&quot;);
            bodyMap.put(&quot;assetTypeId&quot;, assetTypeId);
            bodyMap.put(&quot;assetTypeName&quot;, assetTypeName);
            bodyMap.put(&quot;metricName&quot;, &quot;&quot;);
            bodyMap.put(&quot;assetScopes&quot;, assetScopes);
            bodyMap.put(&quot;approvalMD&quot;, approverKerberos);
            bodyMap.put(&quot;approvalMDName&quot;, approverFullName);
            bodyMap.put(&quot;compensatingControls&quot;, new ArrayList&lt;&gt;());
            bodyMap.put(&quot;risks&quot;, new ArrayList&lt;&gt;());
            bodyMap.put(&quot;autoCloseStatus&quot;, &quot;&quot;);
            bodyMap.put(&quot;requestor&quot;, &quot;&quot;);
            bodyMap.put(&quot;requestorName&quot;, &quot;&quot;);
            bodyMap.put(&quot;requestSource&quot;, &quot;&quot;);
            bodyMap.put(&quot;requestDate&quot;, Instant.now().toString());
            bodyMap.put(&quot;expiryDate&quot;, Instant.now().plus(365, ChronoUnit.DAYS).toString());
            bodyMap.put(&quot;treatment&quot;, &quot;UNABLE_TO_ADOPT_CONTROL&quot;);
            bodyMap.put(&quot;patchScope&quot;, override);
            bodyMap.put(&quot;exemptionDescription&quot;, &quot;SoD &quot; + assetTypeName + &quot; Override&quot;);
            bodyMap.put(&quot;state&quot;, &quot;APPROVED&quot;);
            bodyMap.put(&quot;exemptionProcessState&quot;, &quot;ACTIVE&quot;);
            bodyMap.put(&quot;exemptionOwners&quot;, exemptionOwners);
            bodyMap.put(&quot;exemptionComments&quot;, new ArrayList&lt;&gt;());
            bodyMap.put(&quot;exemptionClosure&quot;, new ArrayList&lt;&gt;());


            //  Uncomment below for logging purposes
//            ObjectMapper objectMapper = new ObjectMapper();
//            String json;
//            try
//            {
//                json = objectMapper.writeValueAsString(bodyMap);
//                logger.info(&quot;json = {}&quot; + json);
//            }
//            catch (JsonProcessingException e)
//            {
//                e.printStackTrace();
//            }

            List&lt;Map&lt;String, Object&gt;&gt; requestBody = new ArrayList&lt;&gt;();
            requestBody.add(bodyMap);

            ResponseEntity&lt;String&gt; comResponse;

            try
            {
                comResponse = restTemplate.postForEntity(comSetBulkOverrideUrl, requestBody, String.class);
            }
            catch(Exception e)
            {
                throw new InternalServerErrorException(&quot;COM Bulk POST request failed&quot;);
            }

            if(comResponse != null &amp;&amp; comResponse.getStatusCode() == HttpStatus.OK)
            {
                //  Uncomment to see response
                //JSONObject jsonObject = new JSONObject(comResponse.getBody());
                location = ServletUriComponentsBuilder
                        .fromCurrentRequest()
                        .buildAndExpand().toUri();
            }

        }

        return ResponseEntity.created(location).build();
    }

    private String getFullNameForKerberos(String kerberos) throws JSONException
    {
        ResponseEntity&lt;Map&lt;String,String&gt;&gt; userMapResponse = peopleSearchController.findByKerberos(kerberos);
        if(userMapResponse.getStatusCode() != HttpStatus.OK)
        {
            throw new ResourceNotFoundException(&quot;user-&quot; + kerberos);
        }

        return userMapResponse.getBody().get(&quot;cn&quot;);
    }



    public List&lt;String&gt; getExemptionOwners(int controlId)
    {
        String url = String.format(controlUrl, controlId);
        ResponseEntity&lt;?&gt; responseEntity;

        try
        {
            responseEntity = restTemplate.getForEntity(url, Map.class);
        }
        catch(Exception e)
        {
            throw new ResourceNotFoundException(&quot;ControlId: &quot; + controlId);
        }
        finally
        {
            logger.info(&quot;External Control360 GET request: {}&quot;, url);
        }

        List&lt;String&gt; response = new ArrayList&lt;&gt;();
        if(responseEntity != null &amp;&amp; responseEntity.getStatusCode() == HttpStatus.OK)
        {
            ResponseEntity&lt;Map&lt;String,Object&gt;&gt; rmsResponse = (ResponseEntity&lt;Map&lt;String,Object&gt;&gt;)responseEntity;
            Map&lt;String,Object&gt; valueMap = rmsResponse.getBody();
            List&lt;LinkedHashMap&lt;String,Object&gt;&gt; dataMapList = (ArrayList&lt;LinkedHashMap&lt;String, Object&gt;&gt;) valueMap.get(&quot;data&quot;);
            LinkedHashMap&lt;String,Object&gt; dataMap = dataMapList.get(0);
            List&lt;LinkedHashMap&lt;String,Object&gt;&gt; tagsList = (List&lt;LinkedHashMap&lt;String,Object&gt;&gt;)dataMap.get(&quot;tags&quot;);

            for(LinkedHashMap&lt;String,Object&gt; entry : tagsList)
            {
                if(entry.get(&quot;tagType&quot;).equals(&quot;ControlAssessorIndividual&quot;))
                {
                    String tag = (String)entry.get(&quot;tag&quot;);
                    if(StringUtils.hasText(tag))
                    {
                        response.add(tag);
                    }
                }
            }
        }

        return response;
    }

    private List&lt;Integer&gt; getControlIdFromOverrideValue(String overrideSpec)
    {
        String errorMessage = null;

        String[] overrideParts = overrideSpec.split(&quot;@&quot;);
        if(overrideParts.length == 2)
        {
            if(overrideParts[0].equals(&quot;RULE_OVERRIDE&quot;))
            {
                String ruleID = overrideParts[1];
                Optional&lt;Rule&gt; ruleOptional = ruleRepository.findById(Integer.valueOf(ruleID));
                if(ruleOptional.isPresent())
                {
                    return Arrays.asList(ruleOptional.get().getControlId());
                }
                else
                {
                    errorMessage = String.format(&quot;Rule ID=%s does not exist&quot;, ruleID);
                }
            }
            else if(overrideParts[0].equals(&quot;PRIVILEGE_OVERRIDE&quot;))
            {
                String[] privilegeOverrideParts = overrideParts[1].split(&quot;:&quot;);
                if (privilegeOverrideParts.length == 2)
                {
                    String leftAssignables = privilegeOverrideParts[0];
                    String rightAssignables = privilegeOverrideParts[1];
                    if (StringUtils.hasText(leftAssignables) &amp;&amp; StringUtils.hasText(rightAssignables))
                    {
                        List&lt;Long&gt; leftAssignablesIdList = Arrays.stream(leftAssignables.split(&quot;~&quot;)).skip(1L).map(Long::valueOf).collect(Collectors.toList());
                        List&lt;DutyAssignablePair&gt; leftDutyAssignablePairs = dutyAssignableMapRepository.findByPrivilegeIdList(leftAssignablesIdList);
                        if(leftAssignablesIdList.size() &gt; leftDutyAssignablePairs.size())
                        {
                            throw new OverrideSpecificationException(&quot;At least one of specified assignable IDs is invalid.&quot;);
                        }

                        List&lt;Long&gt; rightAssignablesIdList = Arrays.stream(rightAssignables.split(&quot;~&quot;)).skip(1L).map(Long::valueOf).collect(Collectors.toList());
                        List&lt;DutyAssignablePair&gt; rightDutyAssignablePairs = dutyAssignableMapRepository.findByPrivilegeIdList(rightAssignablesIdList);
                        if(rightAssignablesIdList.size() &gt; rightDutyAssignablePairs.size())
                        {
                            throw new OverrideSpecificationException(&quot;At least one of requested assignable IDs is invalid.&quot;);
                        }

                        if(!(leftDutyAssignablePairs.isEmpty() || rightDutyAssignablePairs.isEmpty()))
                        {
                            List&lt;Long&gt; leftDutyIDs = leftDutyAssignablePairs.stream().map(DutyAssignablePair::getDuty).map(Duty::getID).distinct().collect(Collectors.toList());
                            List&lt;Long&gt; rightDutyIDs = rightDutyAssignablePairs.stream().map(DutyAssignablePair::getDuty).map(Duty::getID).distinct().collect(Collectors.toList());

                            if(!leftDutyIDs.isEmpty() &amp;&amp; !rightDutyIDs.isEmpty())
                            {
                                List&lt;RuleDutyPair&gt; leftDutyRulePairs = ruleDutyMapRepository.findByDutyIdList(leftDutyIDs);
                                List&lt;RuleDutyPair&gt; rightDutyRulePairs = ruleDutyMapRepository.findByDutyIdList(rightDutyIDs);

                                if(!leftDutyRulePairs.isEmpty() &amp;&amp; !rightDutyRulePairs.isEmpty())
                                {
                                    List&lt;Rule&gt; leftRules = leftDutyRulePairs.stream().map(RuleDutyPair::getRule).collect(Collectors.toList());
                                    List&lt;Rule&gt; rightRules = rightDutyRulePairs.stream().map(RuleDutyPair::getRule).collect(Collectors.toList());

                                    if(!leftRules.isEmpty() &amp;&amp; !rightRules.isEmpty())
                                    {
                                        List&lt;Rule&gt; intersectionRule = new ArrayList&lt;&gt;(leftRules);
                                        intersectionRule.retainAll(rightRules);

                                        if(!intersectionRule.isEmpty())
                                        {
                                            return intersectionRule.stream().map(Rule::getControlId).distinct().collect(Collectors.toList());
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        throw new OverrideSpecificationException(errorMessage);
    }
}


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Transactional
@RestController
@RepositoryRestController
public class CampController
{
    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private PeopleSearchController peopleSearchController;

    @Value(&quot;${camp-entitlements.url}&quot;)
    private String campEntitlementsUrl;

    @Autowired
    private RestTemplate restTemplate;

    @Autowired
    private CampService campService;

    @GetMapping(&quot;/camp/guid/{guid}/privileges&quot;)
    public ResponseEntity&lt;List&lt;String&gt;&gt; getCampPrivilegesByGuid(@PathVariable(&quot;guid&quot;) String guid) throws JSONException
    {
        List&lt;String&gt; response = getCampPrivileges(guid);
        return ResponseEntity.ok(response);
    }


    @GetMapping(&quot;/camp/kerberos/{kerberos}/privileges&quot;)
    public ResponseEntity&lt;List&lt;String&gt;&gt; getCampPrivilegesByKerberos(@PathVariable(&quot;kerberos&quot;) String kerberos) throws JSONException
    {
        ResponseEntity&lt;Map&lt;String,String&gt;&gt; peopleControllerResponse = peopleSearchController.findByKerberos(kerberos);

        String guid = peopleControllerResponse.getBody().get(&quot;gsguid&quot;);

        List&lt;String&gt; response = getCampPrivileges(guid);

        return response.isEmpty() ? ResponseEntity.noContent().build() : ResponseEntity.ok(response);
    }

    private List&lt;String&gt; getCampPrivileges(String guid) throws JSONException
    {
        ResponseEntity&lt;String&gt; campResponse;
        String url = String.format(campEntitlementsUrl, guid);
        try
        {
            campResponse = restTemplate.getForEntity(url, String.class);
        }
        catch(Exception e)
        {
            throw new InternalServerErrorException(&quot;CAMP service internal error&quot;);
        }
        finally
        {
            logger.info(&quot;External CAMP GET request: {}&quot;, url);
        }

        List&lt;String&gt; response = new ArrayList&lt;&gt;();
        if(campResponse != null &amp;&amp; campResponse.getStatusCode() == HttpStatus.OK)
        {
            JSONArray content = new JSONArray(campResponse.getBody());
            if(content.length() == 0)
            {
                throw new ResourceNotFoundException(&quot;Guid: &quot; + guid);
            }

            for(int i = 0; i &lt; content.length(); ++i)
            {
                JSONObject jsonItem = (JSONObject)content.get(i);
                Object privilegeId = jsonItem.get(&quot;privilegeId&quot;);
                if(privilegeId != null &amp;&amp; privilegeId instanceof String)
                {
                    response.add((String) privilegeId);
                }
            }
        }

        return response;
    }

    @PostMapping(&quot;/camp/privilege/managers&quot;)
    public ResponseEntity getPrivilegeManagersforGuids(@RequestBody List&lt;String&gt; guidList) {
        Map managerInfo = new HashMap&lt;&gt;();
        if (null != guidList &amp;&amp; !guidList.isEmpty()) {
            managerInfo = campService.getManagerInformation(guidList);
        }
        return ResponseEntity.ok(managerInfo);
    }
}


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@RestController
@RepositoryRestController
public class PeopleSearchController
{
    private Logger logger = LoggerFactory.getLogger(getClass());

    @Value(&quot;${peoplesearchByKerberos.url}&quot;)
    private String peopleSearchByKerberosUrl;

    @Value(&quot;${peoplesearchByGuid.url}&quot;)
    private String peopleSearchByGuidUrl;

    @Autowired
    private RestTemplate restTemplate;

    @GetMapping(&quot;/peoplesearch/kerberos/{kerberos}&quot;)
    public ResponseEntity&lt;Map&lt;String,String&gt;&gt; findByKerberos(@PathVariable(&quot;kerberos&quot;) String kerberos) throws JSONException
    {
        String url = String.format(peopleSearchByKerberosUrl, kerberos);
        ResponseEntity&lt;String&gt; response;

        try
        {
            response = restTemplate.getForEntity(url, String.class);
        }
        finally
        {
            logger.info(&quot;External PeopleSearch GET Request: {}&quot;, url);
        }

        Map&lt;String,String&gt; resultMap = getResultMap(response, kerberos);

        return ResponseEntity.ok(resultMap);
    }

    @GetMapping(&quot;/peoplesearch/guid/{guid}&quot;)
    public ResponseEntity&lt;Map&lt;String,String&gt;&gt; findByGuid(@PathVariable(&quot;guid&quot;) String guid) throws JSONException
    {
        String url = String.format(peopleSearchByKerberosUrl, guid);

        ResponseEntity&lt;String&gt; response;

        try
        {
            response = restTemplate.getForEntity(url, String.class);
        }
        finally
        {
            logger.info(&quot;External PeopleSearch GET Request: {}&quot;, url);
        }

        Map&lt;String,String&gt; resultMap = getResultMap(response, guid);

        return ResponseEntity.ok(resultMap);
    }

    public String kerberosFromGuid(String guid) throws JSONException
    {
        Map&lt;String,String&gt; result = getResultMapForGuid(guid);
        return result.get(&quot;gskerberosid&quot;);
    }

    public String guidFromKerberos(String kerberos) throws JSONException
    {
        Map&lt;String,String&gt; result = getResultMapForKerberos(kerberos);
        return result.get(&quot;gsguid&quot;);
    }

    private Map&lt;String,String&gt; getResultMapForGuid(String guid) throws JSONException
    {
        ResponseEntity&lt;String&gt; response = restTemplate.getForEntity(String.format(peopleSearchByGuidUrl, guid), String.class);
        return getResultMap(response, guid);
    }

    private Map&lt;String,String&gt; getResultMapForKerberos(String kerberos) throws JSONException
    {
        ResponseEntity&lt;String&gt; response = restTemplate.getForEntity(String.format(peopleSearchByKerberosUrl, kerberos), String.class);
        return getResultMap(response, kerberos);
    }

    private Map&lt;String,String&gt; getResultMap(ResponseEntity&lt;String&gt; response, String searchByValue) throws JSONException
    {
        Map&lt;String,String&gt; resultMap = new HashMap&lt;&gt;();

        JSONObject jsonObject = new JSONObject(response.getBody());
        JSONArray content = (JSONArray) jsonObject.get(&quot;people&quot;);

        if(content.length() == 0)
        {
            throw new ResourceNotFoundException(&quot;PeopleSearch Not Found, Search by: &quot; + searchByValue);
        }

        JSONArray names = ((JSONObject) content.get(0)).names();
        for(int i = 0; i &lt; names.length(); ++i)
        {
            String name = (String)names.get(i);
            String value = ((JSONObject)content.get(0)).getString(name);
            if(StringUtils.isNotBlank(value))
            {
                resultMap.put(name, value);
            }
        }

        return resultMap;
    }

}


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-ApplicationProperties">Application Properties</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">#AUTHENTICATOR
gs.authenticator.enabled=true
gs.authenticator.type=current-user
gs.authenticator.app-name=EntitlementCatalog
gs.authenticator.client.enabled=true
gs.security.sso.enabled=true 

spring.jpa.show-sql=true
spring.h2.console.enabled=true
spring.datasource.url=jdbc:h2:mem:db;DB_CLOSE_ON_EXIT=FALSE

spring.profiles.include=external
server.servlet.context-path=/sod
server.port=8443

spring.jpa.properties.hibernate.jdbc.time_zone=UTC

sod.clearance.return-clear=false

# Overrides URL
overridesUIPrefix.url=http://dev.ovui.techrisk.sod.site.gs.com/#/sod/override/%s/%s


# Enable following 4 lines to generate DDL statements (dialect may not be required)
#spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.DB2Dialect
#spring.jpa.properties.javax.persistence.schema-generation.create-source=metadata
#spring.jpa.properties.javax.persistence.schema-generation.scripts.action=create
#spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target=create.sql</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-external.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">peoplesearch.url=http://peoplesearch.web.gs.com:6119/GSPeopleSearch/GSPeopleSearch?gsguid=%s&amp;StrictSearch=true&amp;lang=json
camp.url=https://dev.services.camp.site.gs.com:8086
rms.url=http://rmsdev.web.gs.com/services/rest/api/v1


peoplesearchByGuid.url=http://peoplesearch.web.gs.com:6119/GSPeopleSearch/GSPeopleSearch?gsguid=%s&amp;StrictSearch=true&amp;lang=json
peoplesearchByKerberos.url=http://peoplesearch.web.gs.com:6119/GSPeopleSearch/GSPeopleSearch?kerberos=%s&amp;StrictSearch=true&amp;lang=json

camp-entitlements.url=https://prod.services.camp.site.gs.com:8086/api/people/entitlements/%s

rmsOrgMemberships.url=http://rms.web.gs.com:80/services/rest/api/v1/members/%s/orgmemberships
rmsHierarchy.url=http://rms.web.gs.com/services/rest/api/v1/nodes/CUSTOM_ORG/%s
rmsTeamMembers.url=http://rms.web.gs.com/services/rest/api/v1/nodes/CUSTOM_ORG/%s/orgmembers

comSetBulkOverride.url=https://autint0.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceuat-v1/exemption/exemptionbulkupload?isAutomaticExemption=false
comGetKerberosOverride.url=https://autint0.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceuat-v1/exemption/finder/exemptionsFromAssetIds/${kerberos.asset.type.id}?activeOnly=false
comGetRmsNodeOverride.url=https://autint0.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceuat-v1/exemption/finder/exemptionsFromAssetIds/${rmsnode.asset.type.id}?activeOnly=false
comDeleteOverride.url=https://autint0.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceuat-v1/api/controlExemption/%d
comGetControlIdUrl=https://autint0.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceuat-v1/exemption/finder/exemptionsFromControlId/%d?activeOnly=false

control.url=https://prod.ext.rccatalog.site.gs.com:7443/rcc/api/ext/controlNode?id=%d

kerberos.asset.type.id=233
rmsnode.asset.type.id=431</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-db2.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.DB2Dialect
sod.datasource.driver-class-name=com.ibm.db2.jcc.DB2Driver</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-local.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.hbm2ddl.import_files=data-original.sql</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-localdev.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.profiles.include=db2

spring.jpa.properties.hibernate.default_schema=SOD
sod.datasource.url=jdbc:db2://nyg13qi8-vip.ny.fw.gs.com:56834/ntrkdi02
sod.datasource.systemaccount.name=dutysepdbdev
sod.datasource.systemaccount.credref=a1c1bb4924d84c319a0142085fbbf840</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-gunern.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.hbm2ddl.import_files=data-gunern.sql</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-katzj.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.hbm2ddl.import_files=data-katzj.sql</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-oroginal.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.hbm2ddl.import_files=data-original.sql</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-multiduty.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.hbm2ddl.import_files=data-multiduty.sql</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-ssl.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">sod.server.ssl.key-store-provider=SUN
sod.server.ssl.key-store-type=JKS
sod.server.ssl.systemaccount.name=dutysepcert
sod.server.ssl.systemaccount.credref=061515302a864010aa15dd06dca04a02</pre>
</div></div></td></tr></tbody></table></div><p><br/>applcation-db2.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.DB2Dialect
sod.datasource.driver-class-name=com.ibm.db2.jcc.DB2Driver</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-dev.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">#Include
spring.profiles.include=db2,ssl

#DataSource
spring.jpa.properties.hibernate.default_schema=SOD
sod.datasource.url=jdbc:db2://nyg13qi8-vip.ny.fw.gs.com:56834/ntrkdi02
sod.datasource.systemaccount.name=dutysepdbdev
sod.datasource.systemaccount.credref=a1c1bb4924d84c319a0142085fbbf840


#Sytem Accounts
gs.authenticator.type=key-tab
gs.authenticator.key-tab.path=file:///var/cv/dutysepdev/creds/dutysepdev.kt
gs.authenticator.key-tab.principal=dutysepdev@GS.COM
#SSL
sod.server.ssl.key-store=/var/cv/dutysepcert/ssl/sod-dev-keystore.jks

</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-uat.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">#Include
spring.profiles.include=db2,ssl

#DataSource
spring.jpa.properties.hibernate.default_schema=SOD_UAT2
sod.datasource.url=jdbc:db2://nyg13qi8-vip.ny.fw.gs.com:56834/ntrkdi02
sod.datasource.systemaccount.name=dutysepdbuat
sod.datasource.systemaccount.credref=d0276c30462d4e3c99d7fc2be92a8c69

# Overrides URL
overridesUIPrefix.url=http://uat.ovui.techrisk.sod.site.gs.com/#/sod/override/%s/%s 

#System Accounts
gs.authenticator.type=key-tab
gs.authenticator.key-tab.path=file:///var/cv/dutysepuat/creds/dutysepuat.kt
gs.authenticator.key-tab.principal=dutysepuat@GS.COM
#SSL
sod.server.ssl.key-store=/var/cv/dutysepcert/ssl/sod-uat.jks


</pre>
</div></div></td></tr></tbody></table></div><p><br/>application-prod.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">#Include
spring.profiles.include=db2

#DataSource
spring.jpa.properties.hibernate.default_schema=SOD
sod.datasource.url=jdbc:db2://nyg23pi2-vip.ny.fw.gs.com:53910/nyiapi85
sod.datasource.systemaccount.name=dutysepdbprod
sod.datasource.systemaccount.credref=015a4ca27d1c4abeb9e9da6c849fd500
#Url&#39;s
camp.url=https://prod.services.camp.site.gs.com:8086
rms.url=http://rms.web.gs.com/services/rest/api/v1
#SystemAccounts
gs.authenticator.type=key-tab
gs.authenticator.key-tab.path=file:///var/cv/dutysepprod/creds/dutysepprod.kt
gs.authenticator.key-tab.principal=dutysepprod@GS.COM

# Overrides URL
overridesUIPrefix.url=http://prod.ovui.techrisk.sod.site.gs.com/#/sod/override/%s/%s


#SSL
sod.server.ssl.systemaccount.name=dutysepcertprod
sod.server.ssl.systemaccount.credref=2c46791da572411098ef480b639367e6
sod.server.ssl.key-store=/var/cv/dutysepcertprod/ssl/sod-prod-keystore.jks
sod.server.ssl.key-store-provider=SUN
sod.server.ssl.key-store-type=JKS

#COM
comGetKerberosOverride.url=https://prod.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceprod-v1/exemption/finder/exemptionsFromAssetIds/${kerberos.asset.type.id}?activeOnly=false
comGetDepartmentOverride.url=https://prod.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceprod-v1/exemption/finder/exemptionsFromAssetIds/${department.asset.type.id}?activeOnly=false
comGetRmsNodeOverride.url=https://prod.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceprod-v1/exemption/finder/exemptionsFromAssetIds/${rmsnode.asset.type.id}?activeOnly=false
comGetControlIdUrl=https://prod.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceprod-v1/exemption/finder/exemptionsFromControlId/%d?activeOnly=false

comSetOverride.url=https://prod.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceprod-v1/exemption/save?isAutomaticExemption=false
comSetBulkOverride.url=https://prod.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceprod-v1/exemption/exemptionbulkupload?isAutomaticExemption=false
comDeleteOverride.url=https://prod.servicecloud.url.gs.com:9301/services/Risk-Measurement-Analytics/ControlExemptionManagerService/cemserviceprod-v1/api/controlExemption/%d


kerberos.asset.type.id=135
rmsnode.asset.type.id=331


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-PresentationObjects">Presentation Objects</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@JsonFilter(&quot;clearanceResponse&quot;)
public class ClearanceViolationDTO extends ResourceSupport
{
    private List&lt;String&gt; violation = new ArrayList&lt;&gt;();
    private List&lt;String&gt; overrides = new ArrayList&lt;&gt;();
    private String userName;
    private String overridesURL;
    private Assignable requestedAssignable;
    private List&lt;Duty&gt; dutiesForRequestedAssignable;
    private Set&lt;Rule&gt; rules;
    private Map&lt;Duty, List&lt;Assignable&gt;&gt; dutyAssignableMap;
    private List&lt;Link&gt; links = new ArrayList&lt;&gt;();;
    private List&lt;String&gt; tmdResponse = new ArrayList&lt;&gt;();


    public ClearanceViolationDTO(String userName, String overridesURL,
                                 Assignable requestedAssignable,
                                 List&lt;Duty&gt; dutiesForRequestedAssignable,
                                 Set&lt;Rule&gt; rules,
                                 Map&lt;Duty, List&lt;Assignable&gt;&gt; dutyAssignableMap) throws JSONException
    {
        this.userName = userName;
        this.overridesURL = overridesURL;
        this.requestedAssignable = requestedAssignable;
        this.dutiesForRequestedAssignable = dutiesForRequestedAssignable;
        this.rules = rules;
        this.dutyAssignableMap = dutyAssignableMap;

        formatViolation();
    }

    protected ClearanceViolationDTO()
    {}

    private void formatViolation() throws JSONException
    {
        String requestedPrivilegeDuties = dutiesForRequestedAssignable.stream().map(Duty::getName).collect(Collectors.joining(&quot;, &quot;));

        violation.add(String.format(&quot;Assignment of privilege &#39;%s&#39; [ID=%d, privilegeId=&#39;%s&#39;, Duties: &#39;%s&#39;] to user &#39;%s&#39; constitutes violation of rule(s) &#39;%s&#39;.&quot;,
                requestedAssignable.getName(), requestedAssignable.getID(), requestedAssignable.getPrivilegeId(), requestedPrivilegeDuties,
                userName, rules.stream().map(Rule::getName).collect(Collectors.joining(&quot;, &quot;))));


        for(Map.Entry&lt;Duty, List&lt;Assignable&gt;&gt; entry : dutyAssignableMap.entrySet())
        {
            if(entry.getValue().size() &gt; 0)
            {
                String privileges = entry.getValue().stream().map(Assignable::getName).collect(Collectors.joining(&quot;,&quot;));
                violation.add(String.format(&quot;User &#39;%s&#39; has following privileges that belong to Duty &#39;%s&#39;: %s&quot;,
                        userName, entry.getKey().getName(), privileges));
            }
        }

        Set&lt;String&gt; privilegeOverrides = new HashSet&lt;&gt;();
        for(Rule rule : rules)
        {
            List&lt;Duty&gt; duties = rule.getRuleDutyMappings().stream().map(RuleDutyPair::getDuty).collect(Collectors.toList());
            for(Duty duty : duties)
            {
                if(!dutiesForRequestedAssignable.contains(duty))
                {
                    List&lt;Assignable&gt; assignables = dutyAssignableMap.get(duty);
                    if(assignables != null)
                    {
                        String privilegeString = &quot;~&quot; + assignables.stream().map(Assignable::getID).map(String::valueOf).collect(Collectors.joining(&quot;~&quot;)) + &quot;~&quot;;
                        privilegeOverrides.add(privilegeString);
                    }
                }
            }
        }

        overrides.add(&quot;Request following SoD Privilege overrides:&quot;);
        for(String privilegeIds : privilegeOverrides)
        {
            overrides.add(String.format(&quot;PRIVILEGE_OVERRIDE@%s:~%d~&quot;, privilegeIds, requestedAssignable.getID()));
        }
        overrides.add(&quot;Or following SoD Rule overrides:&quot;);
        for(Rule rule : rules)
        {
            overrides.add(String.format(&quot;RULE_OVERRIDE@%d&quot;, rule.getID()));
        }

        addLinks();

        tmdResponse.add(&quot;&lt;em&gt;Segregation Of Duties Violation&lt;/em&gt; :: User already has privileges covered by SOD rules that prevent this order from being submitted.&quot;);
        String allDutiesForRequestedPrivilege = dutiesForRequestedAssignable.stream().map(Duty::getName).collect(Collectors.joining(&quot;,&quot;));


        for(Rule rule : rules)
        {
            Set&lt;RuleDutyPair&gt; dutyRulePairList = rule.getRuleDutyMappings();
            List&lt;Duty&gt; opposingDuties = dutyRulePairList.stream().map(RuleDutyPair::getDuty).filter(d -&gt; !dutiesForRequestedAssignable.contains(d)).collect(Collectors.toList());
            String allOpposingDuties = opposingDuties.stream().map(Duty::getName).collect(Collectors.joining(&quot;,&quot;));

            tmdResponse.add(String.format(&quot;Rule in violation: %s.&quot;, rule.getName()));
            tmdResponse.add(String.format(&quot;The requested privilege is duty classified as %s but &lt;b&gt;%s&lt;/b&gt; already has at least one privilege in conflict duty %s.&quot;,
                    allDutiesForRequestedPrivilege, userName, allOpposingDuties));
            tmdResponse.add(&quot;&lt;a href=\&quot;https://confluence.apg.services.gs.com/display/TECHRISK/SoD+TMD+Integration\&quot; &gt; Click here &lt;/a&gt; for more details. &quot; +
                    overridesURL);
        }
    }

    private void addLinks() throws JSONException
    {
        for(Rule rule : rules)
        {
            links.add(linkTo(methodOn(RuleController.class).getRule(rule.getID())).withRel(&quot;rule&quot;).withTitle(rule.getName()));
        }
        for(Duty duty : dutyAssignableMap.keySet())
        {
            links.add(linkTo(methodOn(DutyController.class).getDuty(duty.getID())).withRel(&quot;duty&quot;).withTitle(duty.getName()));
        }

        links.add(linkTo(methodOn(AssignableController.class).getAssignable(requestedAssignable.getID())).withRel(&quot;requested-privilege&quot;).withTitle(requestedAssignable.getName()));
        links.add(linkTo(methodOn(ComController.class).getComOverrides(userName)).withRel(&quot;kerberos-hierarchy&quot;));
    }

    public List&lt;String&gt; getViolation()
    {
        return violation;
    }

    public void setViolation(List&lt;String&gt; violation)
    {
        this.violation = violation;
    }

    public List&lt;String&gt; getOverrides()
    {
        return overrides;
    }

    public void setOverrides(List&lt;String&gt; overrides)
    {
        this.overrides = overrides;
    }

    @JsonIgnore
    public String getUserName()
    {
        return userName;
    }

    @JsonIgnore
    public Assignable getRequestedAssignable()
    {
        return requestedAssignable;
    }

    @JsonIgnore
    public Set&lt;Rule&gt; getRules()
    {
        return rules;
    }

    @JsonIgnore
    public List&lt;Duty&gt; getDutiesForRequestedAssignable()
    {
        return dutiesForRequestedAssignable;
    }

    @JsonIgnore
    public List&lt;Link&gt; getLinks()
    {
        return links;
    }

    public List&lt;String&gt; getTmdResponse()
    {
        return tmdResponse;
    }

    public void setTmdResponse(List&lt;String&gt; tmdResponse)
    {
        this.tmdResponse = tmdResponse;
    }

    @JsonIgnore
    public String getRejectReason()
    {
        String violationsString = violation.stream().collect(Collectors.joining(&quot;\n&quot;));
        String overridesString = overrides.stream().collect(Collectors.joining(&quot;\n&quot;));
        return violationsString + &quot;\n&quot; + overridesString;
    }

}


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">public class ClearanceRuleViolationDTO extends ResourceSupport
{
    private String status = &quot;Fail&quot;;
    private List&lt;String&gt; violation = new ArrayList&lt;&gt;();
    private String userName;
    private Rule rule;
    private Map&lt;Duty, List&lt;Assignable&gt;&gt; dutyAssignableMap;

    public ClearanceRuleViolationDTO(String userName, Rule rule, Map&lt;Duty, List&lt;Assignable&gt;&gt; dutyAssignableMap)
    {
        this.userName = userName;
        this.rule = rule;
        this.dutyAssignableMap = dutyAssignableMap;

        formatViolation();
    }

    protected ClearanceRuleViolationDTO()
    {}

    private void formatViolation()
    {
        violation.add(String.format(&quot;Assignables assigned to user &#39;%s&#39; violates segregation rule &#39;%s&#39;.&quot;, userName, rule.getName()));

        for(Map.Entry&lt;Duty, List&lt;Assignable&gt;&gt; e : dutyAssignableMap.entrySet())
        {
            Duty duty = e.getKey();

            List&lt;Rule&gt; rulesForDuty = duty.getRuleDutyMappings().stream().map(RuleDutyPair::getRule).collect(Collectors.toList());
            if(rulesForDuty.contains(rule))
            {
                List&lt;Assignable&gt; privileges = e.getValue();
                violation.add(String.format(&quot;User &#39;%s&#39; has following assignables that belong to Duty &#39;%s&#39;: %s&quot;,
                        userName, duty.getName(), privileges.stream().map(Assignable::getName).map(String::valueOf).collect(Collectors.joining(&quot;,&quot;))));
            }
        }
    }



    public List&lt;String&gt; getViolation()
    {
        return violation;
    }

    public void setViolation(List&lt;String&gt; violation)
    {
        this.violation = violation;
    }

    public String getStatus()
    {
        return status;
    }

    public void setStatus(String status)
    {
        this.status = status;
    }

    @JsonIgnore
    public String getUserName()
    {
        return userName;
    }

    @JsonIgnore
    public Rule getRule()
    {
        return rule;
    }
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><p><br/></p><h1 id="release1.1.13.1-EntityObjects">Entity Objects</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
public class BaseEntity extends ResourceSupport {

    @Column(name = &quot;out_utc&quot;)
    private ZonedDateTime outUtc = Constants.INFINITY_TIMESTAMP;

    @Column(name = &quot;in_utc&quot;)
    private ZonedDateTime inUtc;

    @Column(name = &quot;created_by&quot;)
    @JsonIgnore
    private String createdBy;

    @Column(name = &quot;created_on&quot;)
    private ZonedDateTime createdOn;

    @Column(name = &quot;last_modified_by&quot;)
    private String lastModifiedBy;

    public BaseEntity(){
    }

    public BaseEntity(BaseEntity other){
        this.setOutUtc(other.getOutUtc());
        this.setCreatedBy(other.getCreatedBy());
        this.setLastModifiedBy(other.getLastModifiedBy());
        this.setInUtc(other.getInUtc());
        this.setCreatedOn(other.getCreatedOn());
    }

    public ZonedDateTime getOutUtc() {
        return outUtc;
    }

    public void setOutUtc(ZonedDateTime outUtc) {
        this.outUtc = outUtc;
    }

    public ZonedDateTime getInUtc() {
        return inUtc;
    }

    public ZonedDateTime getCreatedOn() {
        return createdOn;
    }

    public void setCreatedOn(ZonedDateTime createdOn) {
        this.createdOn = createdOn;
    }

    public void setInUtc(ZonedDateTime inUtc) {
        this.inUtc = inUtc;
    }

    public void setCreatedBy(String createdBy) {
        this.createdBy = createdBy;
    }

    public void setLastModifiedBy(String lastModifiedBy) {
        this.lastModifiedBy = lastModifiedBy;
    }

    public String getLastModifiedBy() {
        return lastModifiedBy;
    }

    public String getCreatedBy() {
        return createdBy;
    }

    @PrePersist
    public void addControlFields(){
        if(this.createdBy == null) {
            String user = SecurityContextHolder.getContext().getAuthentication().getName();
            this.setCreatedBy(user);
            this.setCreatedOn(ZonedDateTime.now());
            this.setLastModifiedBy(user);
            this.setInUtc(ZonedDateTime.now());
        }
        else{
            this.setOutUtc(ZonedDateTime.now());
        }
    }

    public void updateControlFields(){
        this.setInUtc(ZonedDateTime.now());
        this.setLastModifiedBy(SecurityContextHolder.getContext().getAuthentication().getName());
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        if (!super.equals(o)) return false;
        BaseEntity that = (BaseEntity) o;
        return outUtc.equals(that.outUtc);
    }

    @Override
    public int hashCode() {
        return Objects.hash(super.hashCode(), outUtc);
    }

    @Override
    public String toString() {
        return &quot;BaseEntity{&quot; +
                &quot;outUtc=&quot; + outUtc +
                &quot;, inUtc=&quot; + inUtc +
                &quot;, createdBy=&#39;&quot; + createdBy + &#39;\&#39;&#39; +
                &quot;, createdOn=&quot; + createdOn +
                &quot;, lastModifiedBy=&#39;&quot; + lastModifiedBy + &#39;\&#39;&#39; +
                &#39;}&#39;;
    }
}


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@EntityListeners(AuditingEntityListener.class)
@Entity
@Table(name = &quot;AUDIT_TRAIL&quot;)
public class AuditTrail extends BaseEntity
{
    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE)
    @Column(name=&quot;ID&quot;, updatable = false, nullable = false)
    private long ID;
    private long assignableId;
    private String privilegeId;
    private String requestedUser;
    private String assignableName;
    @Column(length=5000)
    private String rejectReason;
    @Column(length=5000)
    private String reason;
    private String rules;
    @Column(length=5000)
    private String exception;
    private String sourceSystem;
    private String clear;
    private String explanation;

    public AuditTrail()
    {
    }

    public long getID()
    {
        return ID;
    }

    public void setID(long ID)
    {
        this.ID = ID;
    }

    public long getAssignableId()
    {
        return assignableId;
    }

    public void setAssignableId(long assignableId)
    {
        this.assignableId = assignableId;
    }

    public String getPrivilegeId()
    {
        return privilegeId;
    }

    public void setPrivilegeId(String privilegeId)
    {
        this.privilegeId = privilegeId;
    }

    public String getRequestedUser()
    {
        return requestedUser;
    }

    public void setRequestedUser(String kerberos)
    {
        this.requestedUser = kerberos;
    }

    public String getAssignableName()
    {
        return assignableName;
    }

    public void setAssignableName(String assignableName)
    {
        this.assignableName = assignableName;
    }

    public String getRejectReason()
    {
        return rejectReason;
    }

    public void setRejectReason(String rejectReason)
    {
        this.rejectReason = rejectReason;
    }

    public String getRules()
    {
        return rules;
    }

    public void setRules(String rules)
    {
        this.rules = rules;
    }

    public String getException()
    {
        return exception;
    }

    public void setException(String exception)
    {
        this.exception = exception;
    }

    public String getSourceSystem()
    {
        return sourceSystem;
    }

    public void setSourceSystem(String sourceSystem)
    {
        this.sourceSystem = sourceSystem;
    }

    public String getClear()
    {
        return clear;
    }

    public void setClear(String clear)
    {
        this.clear = clear;
    }

    public String getExplanation()
    {
        return explanation;
    }

    public void setExplanation(String explanation)
    {
        this.explanation = explanation;
    }

    public String getReason()
    {
        return reason;
    }

    public void setReason(String reason)
    {
        this.reason = reason;
    }

    @Override
    public String toString() {
        return &quot;AuditTrail{&quot; +
                &quot;ID=&quot; + ID +
                &quot;, assignableId=&quot; + assignableId +
                &quot;, privilegeId=&#39;&quot; + privilegeId + &#39;\&#39;&#39; +
                &quot;, requestedUser=&#39;&quot; + requestedUser + &#39;\&#39;&#39; +
                &quot;, assignableName=&#39;&quot; + assignableName + &#39;\&#39;&#39; +
                &quot;, rejectReason=&#39;&quot; + rejectReason + &#39;\&#39;&#39; +
                &quot;, reason=&#39;&quot; + reason + &#39;\&#39;&#39; +
                &quot;, rules=&#39;&quot; + rules + &#39;\&#39;&#39; +
                &quot;, exception=&#39;&quot; + exception + &#39;\&#39;&#39; +
                &quot;, sourceSystem=&#39;&quot; + sourceSystem + &#39;\&#39;&#39; +
                &quot;, clear=&quot; + clear +
                &quot;, explanation=&#39;&quot; + explanation + &#39;\&#39;&#39; +
                &#39;}&#39;;
    }
}


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-RepositoryObjects">Repository Objects</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">public interface AmpPrivilegeRepository extends JpaRepository&lt;AmpPrivilege, Long&gt; {

    @Query(&quot;from AmpPrivilege where sourceSystemPrivilegeId=:sourceSystemPrivilegeId and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    AmpPrivilege getAmpPrivilegeBySourceSystemPrivilegeId(@Param(&quot;sourceSystemPrivilegeId&quot;) String sourceSystemPrivilegeId);

    @Query(&quot;from AmpPrivilege where  outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;AmpPrivilege&gt; findAll();


    @Query(&quot;from AmpPrivilege where id =:id and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;AmpPrivilege&gt; findById(@Param(&quot;id&quot;) long id);
}


public interface AssignableRepository extends JpaRepository&lt;Assignable, Long&gt; {

    @Query(&quot;from Assignable where id =:id and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;Assignable&gt; findById(@Param(&quot;id&quot;) long id);

    @Query(&quot;from Assignable where entitlementSystem=:entitlementSystem and privilegeId=:privlegeId and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;Assignable&gt; getAssignableByPrivilegeIdAndEntitlementSystem(@Param(&quot;privlegeId&quot;) String privilegeId, @Param(&quot;entitlementSystem&quot;) String entitlementSystem);

    @Query(&quot;from Assignable where entitlementSystem=:entitlementSystem and privilegeId=:privlegeId and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;Assignable&gt; findByPrivilegeIdAndSystem(@Param(&quot;privlegeId&quot;) String privilegeId, @Param(&quot;entitlementSystem&quot;) String entitlementSystem);

    @Query(&quot;from Assignable assignable where outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Assignable&gt; findAll();

    @Query(&quot;from Assignable assignable where assignable.auditId =:assignableId&quot;)
    List&lt;Assignable&gt; findByIdWithAuditHistory(@Param(&quot;assignableId&quot;) String assignableId);

    @Query(&quot;from Assignable assignable&quot;)
    List&lt;Assignable&gt; findAllWithAuditHistory();

    @Query(&quot;select a from Assignable a where ID IN :idList and a.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Assignable&gt; findByIdList(@Param(&quot;idList&quot;) List&lt;Long&gt; idList);

    @Query(&quot;select a from Assignable a where PRIVILEGE_ID IN :privilegeIdList and a.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Assignable&gt; findByPrivilegeIdList(@Param(&quot;privilegeIdList&quot;) List&lt;String&gt; privilegeIdList);
}


public interface AuditTrailRepository extends JpaRepository&lt;AuditTrail, Integer&gt;
{
}


public interface ClearanceCallAuditRepository extends JpaRepository&lt;ClearanceCallAudit, Long&gt; {

    @Query(&quot;from ClearanceCallAudit where id =:clearanceCallAuditId&quot;)
    Optional&lt;ClearanceCallAudit&gt; findById(@Param(&quot;clearanceCallAuditId&quot;) long clearanceCallAuditId);
}


public interface DutyAssignableMapRepository extends JpaRepository&lt;DutyAssignablePair, Long&gt; {

    @Query(&quot;select dam from DutyAssignablePair dam where dam.duty = :duty and dam.assignable= :assignable and  outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;DutyAssignablePair&gt; findByDutyAndAssignable(@Param(&quot;duty&quot;) Duty duty, @Param(&quot;assignable&quot;) Assignable assignable);

    @Query(&quot;select dap from DutyAssignablePair dap where DUTY_ID = :id and dap.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;DutyAssignablePair&gt; findByDutyId(@Param(&quot;id&quot;) long id);

    @Query(&quot;select dap from DutyAssignablePair dap where ASSIGNABLE_ID = :id and dap.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;DutyAssignablePair&gt; findByPrivilegeId(@Param(&quot;id&quot;) long id);

    @Query(&quot;select dap from DutyAssignablePair dap where ASSIGNABLE_ID IN :privilegeIdList and dap.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;DutyAssignablePair&gt; findByPrivilegeIdList(@Param(&quot;privilegeIdList&quot;) List&lt;Long&gt; privilegeIdList);

    @Query(&quot;select dap from DutyAssignablePair dap where dap.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;DutyAssignablePair&gt; findAll();
}
public interface DutyRepository extends JpaRepository&lt;Duty, Long&gt; {

    @Query(&quot;from Duty where id =:id and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;Duty&gt; findById(@Param(&quot;id&quot;) long id);

    @Query(&quot;from Duty where  outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Duty&gt; findAll();

    @Query(&quot;from Duty d where d.auditId =:dutyId &quot;)
    List&lt;Duty&gt; findByIdWithAuditHistory(@Param(&quot;dutyId&quot;) String dutyId);

    @Query(&quot;from Duty&quot;)
    List&lt;Duty&gt; findAllWithAuditHistory();

}


public interface RuleDutyMapRepository extends JpaRepository&lt;RuleDutyPair, Long&gt; {

    @Query(&quot;select rdp from RuleDutyPair rdp where rdp.duty = :duty and rdp.rule= :rule and  rdp.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;RuleDutyPair&gt; findByRuleAndDuty(@Param(&quot;rule&quot;) Rule rule, @Param(&quot;duty&quot;) Duty duty);

    @Query(&quot;select rdp from RuleDutyPair rdp where DUTY_ID = :id and rdp.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;RuleDutyPair&gt; findByDutyId(@Param(&quot;id&quot;) long id);

    @Query(&quot;select rdp from RuleDutyPair rdp where RULE_ID = :id and rdp.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;RuleDutyPair&gt; findByRuleId(@Param(&quot;id&quot;) long id);

    @Query(&quot;select rdp from RuleDutyPair rdp where DUTY_ID IN :dutyIdList and rdp.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;RuleDutyPair&gt; findByDutyIdList(@Param(&quot;dutyIdList&quot;) List&lt;Long&gt; dutyIdList);

    @Query(&quot;select rdp from RuleDutyPair rdp where RULE_ID = :ruleId and DUTY_ID = :dutyId and rdp.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;RuleDutyPair&gt; findByRuleDutyId(@Param(&quot;ruleId&quot;) int ruleId, @Param(&quot;dutyId&quot;) int dutyId);

    @Query(&quot;select rdp from RuleDutyPair rdp where rdp.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;RuleDutyPair&gt; findAll();

}


@RepositoryRestResource
public interface RuleRepository extends JpaRepository&lt;Rule, Long&gt; {

    @Query(&quot;from Rule r where r.ID =:id and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    Optional&lt;Rule&gt; findById(@Param(&quot;id&quot;) long id);

    @Query(&quot;select r from Rule r where r.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Rule&gt; findAll();

    @Query(&quot;select r from Rule r where r.state=:state and r.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Rule&gt; findAllByState(@Param(&quot;state&quot;) String state);

    @Query(&quot;from Rule r where r.auditId =:ruleId&quot;)
    List&lt;Rule&gt; findByIdWithAuditHistory(@Param(&quot;ruleId&quot;) String ruleId);

    @Query(&quot;select r from Rule r&quot;)
    List&lt;Rule&gt; findAllWithAuditHistory();

    @Query(&quot;select r from Rule r where r.state=:state&quot;)
    List&lt;Rule&gt; findAllByStateWithAuditHistory(@Param(&quot;state&quot;) String state);

    @Query(&quot;select r from Rule r where r.ID in :id and outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Rule&gt; findAllByID(@Param(&quot;id&quot;) List&lt;Long&gt; id);

    @Query(&quot;select DISTINCT (r.controlId) from Rule r where r.outUtc = &quot; + Constants.INFINITY_TIMESTAMP_STRING)
    List&lt;Integer&gt; findAllControlIDs();

}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-Aspects">Aspects</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface LogExceptionHandler {
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface LogInputOutput {
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface TrackTime {
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Aspect
@Configuration
public class SodAspectLogger {

    private final Logger logger = LoggerFactory.getLogger(this.getClass());

    @Around(&quot;@annotation(com.gs.ep.aspect.annotation.TrackTime)&quot;)
    public Object trackTime(ProceedingJoinPoint joinPoint) throws Throwable {
        long startTime = System.currentTimeMillis();
        Object returnValue = joinPoint.proceed();
        long endTime = System.currentTimeMillis();
        logger.info(&quot;Time Taken By {} is {} ms . Value Returned = {} &quot;, joinPoint, endTime - startTime, returnValue);
        return returnValue;
    }

    @Around(&quot;@annotation(com.gs.ep.aspect.annotation.LogInputOutput)&quot;)
    public Object logInputOutput(ProceedingJoinPoint joinPoint) throws Throwable {
        Signature signature = joinPoint.getSignature();
        logger.info(signature.getName() + &quot; Arguments: &quot; + Arrays.toString(joinPoint.getArgs()));
        Object returnValue = joinPoint.proceed();
        logger.info(signature.getName() + &quot; Return value: &quot; + returnValue);
        return returnValue;
    }

    @Around(&quot;@annotation(com.gs.ep.aspect.annotation.LogExceptionHandler)&quot;)
    public Object logExcpetionHandler(ProceedingJoinPoint joinPoint) throws Throwable {
        Object returnValue = joinPoint.proceed();
        logger.error(&quot; Return value: &quot; + returnValue);
        return returnValue;
    }
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-ConfigurationObjects">Configuration Objects</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">public class AuditorAwareImpl implements AuditorAware&lt;String&gt; {


    public Optional&lt;String&gt; getCurrentAuditor() {
        return Optional.of(SecurityContextHolder.getContext().getAuthentication().getName());
    }
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Component
@Order(Ordered.HIGHEST_PRECEDENCE)
public class CORSFilter implements Filter {

    @Override
    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {

        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) res;
        String origin = request.getHeader(&quot;Origin&quot;) == null ? &quot;*&quot; : request.getHeader(&quot;Origin&quot;);
        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, origin);
        response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);
        response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, GET, OPTIONS, DELETE, PUT&quot;);
        response.setHeader(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type, Accept, X-Requested-With, remember-me, X-Codingpedia&quot;);
        chain.doFilter(req, res);
    }

    @Override
    public void init(FilterConfig filterConfig) {
    }

    @Override
    public void destroy() {
    }

}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Configuration
@Profile({&quot;dev&quot;, &quot;uat&quot;, &quot;prod&quot;, &quot;localdevdb&quot;, &quot;localuatdb&quot;})
public class DataSourceConfig {

    @Value(&quot;${sod.datasource.systemaccount.name}&quot;)
    String systemAccountName;

    @Value(&quot;${sod.datasource.systemaccount.credref}&quot;)
    String credRef;

    @Value(&quot;${sod.datasource.url}&quot;)
    String datasourceUrl;

    @Value(&quot;${sod.datasource.driver-class-name}&quot;)
    String datasourceDriverclass;

    @Bean
    public DataSource dataSource(CredrefAuthentication credrefAuthentication) {
        SystemAccount systemAccount = credrefAuthentication.getSystemAccount(credRef, systemAccountName);
        return  DataSourceBuilder
                .create()
                .username(systemAccountName)
                .password(systemAccount.getPassword())
                .url(datasourceUrl)
                .driverClassName(datasourceDriverclass)
                .build();
    }
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Configuration
@EnableJpaAuditing(auditorAwareRef = &quot;auditorAware&quot;)
public class JpaConfig {

    @Bean
    public AuditorAware&lt;String&gt; auditorAware() {
        return new AuditorAwareImpl();
    }
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Configuration
@Profile({&quot;dev&quot;, &quot;uat&quot;, &quot;prod&quot;})
@EnableGlobalMethodSecurity(prePostEnabled = true)
public class PermitSecurityConfig {
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Component
@Profile({&quot;dev&quot;, &quot;uat&quot;, &quot;prod&quot;})
public class SSLConfig implements WebServerFactoryCustomizer&lt;ConfigurableServletWebServerFactory&gt; {

    @Value(&quot;${sod.server.ssl.key-store}&quot;)
    private  String keyStore;

    @Value(&quot;${sod.server.ssl.key-store-provider}&quot;)
    private  String keyStoreProvider;

    @Value(&quot;${sod.server.ssl.key-store-type}&quot;)
    private  String keyStoreType;

    @Value(&quot;${sod.server.ssl.systemaccount.credref}&quot;)
    String credRef;

    @Value(&quot;${sod.server.ssl.systemaccount.name}&quot;)
    String systemAccountName;

    private CredrefAuthentication credrefAuthentication;

    public SSLConfig(CredrefAuthentication credrefAuthentication) {
        this.credrefAuthentication = credrefAuthentication;
    }

    @Override
    public void customize(ConfigurableServletWebServerFactory server) {
        SystemAccount systemAccount = credrefAuthentication.getSystemAccount(credRef, systemAccountName);
        String password = systemAccount.getPassword();

        Ssl ssl = new Ssl();
        ssl.setKeyStore(keyStore);
        ssl.setKeyStoreProvider(keyStoreProvider);
        ssl.setKeyStoreType(keyStoreType);
        ssl.setKeyPassword(password);
        ssl.setKeyStorePassword(password);
        server.setSsl(ssl);
    }
}</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-in-memorydatabases">in-memory databases</h1><p>data-gunern.sql</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">-- DUTIES
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;Duty-A&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;Duty-B&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, &#39;Duty-C&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, &#39;Duty-X&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, &#39;Duty-Y&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(6, &#39;0006&#39;, &#39;Duty-Z&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

-- RULES
INSERT INTO RULE(ID, AUDIT_ID, NAME, RULE_TYPE, STATE, CONTROL_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;Rule-AB&#39;, &#39;SEGREGATION&#39;, &#39;PREVENT&#39;, 2097, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE(ID, AUDIT_ID, NAME, RULE_TYPE, STATE, CONTROL_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;Rule-XY&#39;, &#39;SEGREGATION&#39;, &#39;PREVENT&#39;, 2097, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE(ID, AUDIT_ID, NAME, RULE_TYPE, STATE, CONTROL_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, &#39;Rule-Test&#39;, &#39;SEGREGATION&#39;, &#39;PREVENT&#39;, 2097, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

-- DUTY_RULE_MAP
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, 1, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, 2, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, 4, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, 5, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

-- ASSIGNABLES
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;99999999-0000-9999-0000-000000000001&#39;, &#39;AMP&#39;, &#39;PA-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;99999999-0000-9999-0000-000000000002&#39;, &#39;AMP&#39;, &#39;PA-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, &#39;99999999-0000-9999-0000-000000000003&#39;, &#39;AMP&#39;, &#39;PA-3&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, &#39;99999999-0000-9999-0000-000000000004&#39;, &#39;AMP&#39;, &#39;PB-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, &#39;99999999-0000-9999-0000-000000000005&#39;, &#39;AMP&#39;, &#39;PB-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
-- Following privilegeID was created for testing with TMD UAT. gunern does not have this privilege in PROD CAMP
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modifie(d_by, created_on) VALUES(6, &#39;0006&#39;, &#39;f6db9b97-5021-3e20-a2cf-d5b6ef6d48d4&#39;, &#39;AMP&#39;, &#39;PB-3&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(7, &#39;0007&#39;, &#39;99999999-0000-9999-0000-000000000007&#39;, &#39;AMP&#39;, &#39;PC-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(8, &#39;0008&#39;, &#39;99999999-0000-9999-0000-000000000008&#39;, &#39;AMP&#39;, &#39;PC-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(9, &#39;0009&#39;, &#39;99999999-0000-9999-0000-000000000009&#39;, &#39;AMP&#39;, &#39;PX-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(10, &#39;0010&#39;, &#39;99999999-0000-9999-0000-000000000010&#39;, &#39;AMP&#39;, &#39;PX-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(11, &#39;0011&#39;, &#39;99999999-0000-9999-0000-000000000011&#39;, &#39;AMP&#39;, &#39;PX-3&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(12, &#39;0012&#39;, &#39;99999999-0000-9999-0000-000000000012&#39;, &#39;AMP&#39;, &#39;PX-4&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(13, &#39;0013&#39;, &#39;99999999-0000-9999-0000-000000000013&#39;, &#39;AMP&#39;, &#39;PY-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(14, &#39;0014&#39;, &#39;99999999-0000-9999-0000-000000000014&#39;, &#39;AMP&#39;, &#39;PY-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(15, &#39;0015&#39;, &#39;99999999-0000-9999-0000-000000000015&#39;, &#39;AMP&#39;, &#39;PY-3&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
-- ASSIGNABLES - with some privilegeIDs for gunern
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(16, &#39;0016&#39;, &#39;0ae42c11-422d-3715-bc94-c9f78997593d&#39;, &#39;AMP&#39;, &#39;PA-4&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(17, &#39;0017&#39;, &#39;6a4905df-96bd-3af8-80e1-d055148f30cc&#39;, &#39;AMP&#39;, &#39;PA-5&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(18, &#39;0018&#39;, &#39;99999999-0000-9999-0000-000000000018&#39;, &#39;AMP&#39;, &#39;PA-6&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(19, &#39;0019&#39;, &#39;99999999-0000-9999-0000-000000000019&#39;, &#39;AMP&#39;, &#39;PB-4&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(20, &#39;0020&#39;, &#39;99999999-0000-9999-0000-000000000020&#39;, &#39;AMP&#39;, &#39;PB-5&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(21, &#39;0021&#39;, &#39;99999999-0000-9999-0000-000000000021&#39;, &#39;AMP&#39;, &#39;PB-6&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(22, &#39;0022&#39;, &#39;79b5dd4a-34e4-3fc2-a615-7205a22015d1&#39;, &#39;AMP&#39;, &#39;PC-3&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(23, &#39;0023&#39;, &#39;b2614499-16b2-366b-a173-b8b28a9970fe&#39;, &#39;AMP&#39;, &#39;PC-4&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(24, &#39;0024&#39;, &#39;9bb85160-f4ba-384e-9c97-740b25bc7067&#39;, &#39;AMP&#39;, &#39;PC-5&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(25, &#39;0025&#39;, &#39;99999999-0000-9999-0000-000000000025&#39;, &#39;AMP&#39;, &#39;PC-6&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(26, &#39;0026&#39;, &#39;4ce2f981-7788-3df3-9671-6e541cc4d553&#39;, &#39;AMP&#39;, &#39;PX-5&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(27, &#39;0027&#39;, &#39;d4cf7c87-cb1d-36ea-94ad-67eeb3e6ad6d&#39;, &#39;AMP&#39;, &#39;PX-6&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(28, &#39;0028&#39;, &#39;99999999-0000-9999-0000-000000000028&#39;, &#39;AMP&#39;, &#39;PY-4&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(29, &#39;0029&#39;, &#39;99999999-0000-9999-0000-000000000029&#39;, &#39;AMP&#39;, &#39;PY-5&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(30, &#39;0030&#39;, &#39;99999999-0000-9999-0000-000000000030&#39;, &#39;AMP&#39;, &#39;PY-6&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
-- ASSIGNABLES - Multi-Duty
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(31, &#39;0031&#39;, &#39;99999999-0000-9999-0000-000000000031&#39;, &#39;AMP&#39;, &#39;PAX-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(32, &#39;0032&#39;, &#39;99999999-0000-9999-0000-000000000032&#39;, &#39;AMP&#39;, &#39;PBY-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(33, &#39;0033&#39;, &#39;99999999-0000-9999-0000-000000000033&#39;, &#39;AMP&#39;, &#39;PAB-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

--  DUTY_ASSIGNABLE_MAP
--  Duty-A
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, 1, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, 1, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, 1, 3, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, 1, 31, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, 1, 16, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(6, &#39;0006&#39;, 1, 17, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(7, &#39;0007&#39;, 1, 18, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
--  Duty-B
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(8, &#39;0008&#39;, 2, 4, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(9, &#39;0009&#39;, 2, 5, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(10, &#39;0010&#39;, 2, 6, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(11, &#39;0011&#39;, 2, 19, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(12, &#39;0012&#39;, 2, 20, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(13, &#39;0013&#39;, 2, 21, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(14, &#39;0014&#39;, 2, 32, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
--  Duty-C
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(15, &#39;0015&#39;, 3, 7, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(16, &#39;0016&#39;, 3, 8, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(17, &#39;0017&#39;, 3, 22, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(18, &#39;0018&#39;, 3, 23, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(19, &#39;0019&#39;, 3, 24, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(20, &#39;0020&#39;, 3, 25, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
--  Duty-X
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(21, &#39;0021&#39;, 4, 9, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(22, &#39;0022&#39;, 4, 10, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(23, &#39;0023&#39;, 4, 11, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(24, &#39;0024&#39;, 4, 12, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(25, &#39;0025&#39;, 4, 31, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(26, &#39;0026&#39;, 4, 26, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(27, &#39;0027&#39;, 4, 27, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
--  Duty-Y
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(28, &#39;0028&#39;, 5, 13, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(29, &#39;0029&#39;, 5, 14, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(30, &#39;0030&#39;, 5, 15, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(31, &#39;0031&#39;, 5, 28, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(32, &#39;0032&#39;, 5, 29, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(33, &#39;0033&#39;, 5, 30, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
--  MultiDuty Assignable
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(34, &#39;0034&#39;, 1, 33, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(35, &#39;0035&#39;, 2, 33, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(36, &#39;0036&#39;, 2, 32, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(37, &#39;0037&#39;, 5, 32, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

--SEQUENCE
alter sequence HIBERNATE_SEQUENCE restart with 1000001</pre>
</div></div></td></tr></tbody></table></div><p><br/>data-katzj.sql</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">-- DUTIES
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;Duty-A&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;Duty-B&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, &#39;Duty-C&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)


-- RULES
INSERT INTO RULE(ID, AUDIT_ID, NAME, RULE_TYPE, STATE, CONTROL_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;Rule-AB&#39;, &#39;SEGREGATION&#39;, &#39;PREVENT&#39;, 2097, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE(ID, AUDIT_ID, NAME, RULE_TYPE, STATE, CONTROL_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;Rule-AC&#39;, &#39;SEGREGATION&#39;, &#39;PREVENT&#39;, 2097, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

-- RULE_DUTY_MAP
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, 1, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, 2, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, 1, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(6, &#39;0006&#39;, 3, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)


-- PRIVILEGES - 
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;f2ffc622-7b68-3263-953a-049acfb3a629&#39;, &#39;AMP&#39;, &#39;PA-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;69e16b4b-fbe1-3ebc-b441-4f17b2d3e198&#39;, &#39;AMP&#39;, &#39;PA-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, &#39;99999999-0000-9999-0000-000000000003&#39;, &#39;AMP&#39;, &#39;PA-3&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, &#39;b9e13e68-96e9-3a44-84b4-c7ec6d3b9596&#39;, &#39;AMP&#39;, &#39;PB-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, &#39;a859fffb-4cbb-3c31-ae1d-1542b7023037&#39;, &#39;AMP&#39;, &#39;PB-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(6, &#39;0006&#39;, &#39;99999999-0000-9999-0000-000000000006&#39;, &#39;AMP&#39;, &#39;PB-3&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(7, &#39;0007&#39;, &#39;f59a7f34-254a-3498-ad91-ba93b90e2023&#39;, &#39;AMP&#39;, &#39;PC-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(8, &#39;0008&#39;, &#39;99999999-0000-9999-0000-000000000008&#39;, &#39;AMP&#39;, &#39;PC-2&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(9, &#39;0009&#39;, &#39;99999999-0000-9999-0000-000000000009&#39;, &#39;AMP&#39;, &#39;PBC-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(10, &#39;0010&#39;, &#39;99999999-0000-9999-0000-000000000010&#39;, &#39;AMP&#39;, &#39;PAB-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

--  DUTY_PRIVILEGE_MAP
--  Duty-A
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, 1, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, 1, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, 1, 3, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, 1, 10, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
--  Duty-B
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, 2, 4, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(6, &#39;0006&#39;, 2, 5, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(7, &#39;0007&#39;, 2, 6, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(8, &#39;0008&#39;, 2, 9, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(9, &#39;0009&#39;, 2, 10, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
--  Duty-C
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(10, &#39;0010&#39;, 3, 7, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(11, &#39;0011&#39;, 3, 8, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(12, &#39;0012&#39;, 3, 9, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)



--SEQUENCE
alter sequence HIBERNATE_SEQUENCE restart with 1000001</pre>
</div></div></td></tr></tbody></table></div><p><br/>data-multiduty.sql</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;0ae42c11-422d-3715-bc94-c9f78997593d&#39;, &#39;AMP&#39;, &#39;PA-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;99999999-0000-9999-0000-000000000002&#39;, &#39;AMP&#39;, &#39;PA-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, &#39;6a4905df-96bd-3af8-80e1-d055148f30cc&#39;, &#39;AMP&#39;, &#39;PA-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, &#39;99999999-0000-9999-0000-000000000004&#39;, &#39;AMP&#39;, &#39;PA-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO ASSIGNABLE(ID, AUDIT_ID, PRIVILEGE_ID, ENTITLEMENT_SYSTEM, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, &#39;99999999-0000-9999-0000-000000000005&#39;, &#39;AMP&#39;, &#39;PA-1&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;Duty-A&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;Duty-B&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, &#39;Duty-X&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY(ID, AUDIT_ID, NAME, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, &#39;Duty-Y&#39;, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

INSERT INTO RULE(ID, AUDIT_ID, NAME, RULE_TYPE, STATE, CONTROL_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, &#39;Rule-AB&#39;, &#39;SEGREGATION&#39;, &#39;PREVENT&#39;, 2097, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE(ID, AUDIT_ID, NAME, RULE_TYPE, STATE, CONTROL_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, &#39;Rule-XY&#39;, &#39;SEGREGATION&#39;, &#39;PREVENT&#39;, 2097, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, 1, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, 2, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, 3, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO RULE_DUTY_MAP(ID, AUDIT_ID, DUTY_ID, RULE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, 4, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)

INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(1, &#39;0001&#39;, 1, 1, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(2, &#39;0002&#39;, 2, 2, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(3, &#39;0003&#39;, 3, 3, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(4, &#39;0004&#39;, 4, 4, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(5, &#39;0005&#39;, 2, 5, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)
INSERT INTO DUTY_ASSIGNABLE_MAP(ID, AUDIT_ID, DUTY_ID, ASSIGNABLE_ID, IN_UTC, OUT_UTC, created_by, last_modified_by, created_on) VALUES(6, &#39;0006&#39;, 4, 5, CURRENT_TIMESTAMP, &#39;9999-12-01&#39;, &#39;unknown&#39;, &#39;unknown&#39;, CURRENT_TIMESTAMP)


--SEQUENCE
alter sequence HIBERNATE_SEQUENCE restart with 1000001</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-pom.xml">pom.xml</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
   xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
   &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

   &lt;groupId&gt;com.gs.ep&lt;/groupId&gt;
   &lt;artifactId&gt;sod-microservice&lt;/artifactId&gt;
   &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;


   &lt;name&gt;sod-microservice&lt;/name&gt;
   &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;

   &lt;parent&gt;
      &lt;groupId&gt;com.gs.entitlements&lt;/groupId&gt;
      &lt;artifactId&gt;entitlement-catalog&lt;/artifactId&gt;
      &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
   &lt;/parent&gt;
   &lt;dependencies&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.modelmapper&lt;/groupId&gt;
         &lt;artifactId&gt;modelmapper&lt;/artifactId&gt;
         &lt;version&gt;2.3.0&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;com.gs.spring&lt;/groupId&gt;
         &lt;artifactId&gt;gs-spring-boot-credential-vault&lt;/artifactId&gt;
         &lt;version&gt;${spring.boot.library.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
         &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;com.gs.spring&lt;/groupId&gt;
         &lt;artifactId&gt;gs-spring-boot-authenticator&lt;/artifactId&gt;
         &lt;version&gt;${spring.boot.library.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;!--&lt;dependency&gt;--&gt;
         &lt;!--&lt;groupId&gt;com.gs.res.spring.boot&lt;/groupId&gt;--&gt;
         &lt;!--&lt;artifactId&gt;gs-spring-cloud-starter-zookeeper-discovery&lt;/artifactId&gt;--&gt;
         &lt;!--&lt;version&gt;1.0.2&lt;/version&gt;--&gt;
      &lt;!--&lt;/dependency&gt;--&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;com.gs.spring&lt;/groupId&gt;
         &lt;artifactId&gt;gs-spring-boot-security&lt;/artifactId&gt;
         &lt;version&gt;${spring.boot.library.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;!--&lt;dependency&gt;--&gt;
         &lt;!--&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;
         &lt;!--&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;--&gt;
      &lt;!--&lt;/dependency&gt;--&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;com.gs.spring&lt;/groupId&gt;
         &lt;artifactId&gt;gs-spring-boot-swagger&lt;/artifactId&gt;
         &lt;version&gt;${spring.boot.library.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
         &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
      &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
            &lt;scope&gt;compile&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
            &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
         &lt;version&gt;1.9.4&lt;/version&gt;
            &lt;scope&gt;compile&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.gs.spring&lt;/groupId&gt;
            &lt;artifactId&gt;gs-spring-boot-autoconfigure&lt;/artifactId&gt;
         &lt;version&gt;${spring.boot.library.version}&lt;/version&gt;
            &lt;classifier&gt;sources&lt;/classifier&gt;
        &lt;/dependency&gt;

      &lt;dependency&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
         &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
         &lt;scope&gt;runtime&lt;/scope&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
         &lt;artifactId&gt;spring-boot-starter-data-rest&lt;/artifactId&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;com.h2database&lt;/groupId&gt;
         &lt;artifactId&gt;h2&lt;/artifactId&gt;
         &lt;scope&gt;compile&lt;/scope&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
         &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
         &lt;scope&gt;test&lt;/scope&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.springdoc&lt;/groupId&gt;
         &lt;artifactId&gt;springdoc-openapi-ui&lt;/artifactId&gt;
            &lt;version&gt;1.1.49&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;com.ibm.db2&lt;/groupId&gt;
         &lt;artifactId&gt;db2jcc4&lt;/artifactId&gt;
         &lt;version&gt;10.5.7.3.69.49&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;com.gs.opstech.common&lt;/groupId&gt;
         &lt;artifactId&gt;gsknex-security&lt;/artifactId&gt;
         &lt;version&gt;3.8.1&lt;/version&gt;
      &lt;/dependency&gt;

   &lt;/dependencies&gt;

   &lt;dependencyManagement&gt;
      &lt;dependencies&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
            &lt;version&gt;${spring.boot.version}&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
         &lt;/dependency&gt;
      &lt;/dependencies&gt;
   &lt;/dependencyManagement&gt;

   &lt;build&gt;
      &lt;plugins&gt;
         &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;mainClass&gt;com.gs.ep.SodMicroService&lt;/mainClass&gt;
                &lt;/configuration&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;repackage&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
         &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.22.0&lt;/version&gt;
&lt;!--                &lt;configuration&gt;--&gt;
&lt;!--                    &lt;includes&gt;--&gt;
&lt;!--                        &lt;include&gt;SodMicroServiceTests.java&lt;/include&gt;--&gt;
&lt;!--                        &lt;include&gt;RuleControllerTest.java&lt;/include&gt;--&gt;
&lt;!--                        &lt;include&gt;RuleDutyMappingControllerTest.java&lt;/include&gt;--&gt;
&lt;!--                    &lt;/includes&gt;--&gt;
&lt;!--                &lt;/configuration&gt;--&gt;
            &lt;/plugin&gt;
      &lt;/plugins&gt;
   &lt;/build&gt;

&lt;/project&gt;


</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="release1.1.13.1-otherresources">other resources</h1><p>gsauthn.properties</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"># Sample Properties file for GSAuthN-J configuration
# $Revision: 1.8 $
# $Name:  $ $State: Exp $ $Date: 2010/04/26 21:11:51 $

# Permissible authentication types, concatenated anyhow, in any
# order.
authTypes=kerberos.securid

# The location of the RSA public key file
# publicKeyFile=/app/public.key

# The maximum lifetime that an ID token is considered valid (in
#  seconds). Required (no default). [604800 == 7 days]
maxIdTokenLife=604800

# Set useSessionTokens=false if you are not issuing session tokens.
#  Session tokens are faster to de-crypt and verify than ID tokens,
#  which can result in performance benefits to applications where
#  clients will make frequent repeated requests to the application.
#  If true, either set auto generation on, or define session key file
#  location - see below.
#  (Default true)
useSessionTokens=true

# The maximum lifetime that a Session token is considered valid
#  (in seconds). maxSessionTokenLife is bounded above by
#  maxIdTokenLife - it is not possible to extend a session beyond
#  the original authentication time. Mandatory if
#    useSessionTokens=true (no default)
maxSessionTokenLife=7200
# The algorithm used to determine whether or not to re-issue a
#  session token. One of [everyhit|halflife].  Defaults to halflife.
#  - everyhit            generates a new Session token on every hit
#  - halflife (default)  generates a new Session token when more
#                         than half maxSessionTokenLife has passed
#                         since the Session token was generated, and
#                         the session hasn&#39;t expired completely.
sessionRefreshFrequency=halflife

# The package can be set to autogenerate session keys if using a standalone server;
# if using load-balanced authenticating servers, a shared session key file is required.
autoGenerateSessionKey=true
# If autogenerating session keys, how many? Default is 26
#numGeneratedSessionKeys=
# If autogenerating session keys, how long (days) between keys? Default is 7
#sessionKeyRefreshPeriod=

# Location of (private) keys for session token encryption. Required
# if useSessionTokens=true
# (no default)
#sessionKeyFile=/app/tomcat/conf/keys/HMACKeys.txt
# Three factors build a session token&#39;s identifying name (cookie
#  name for web servers):
#     NAME = sessionTokenBaseName_sessionServer_sessionPort
# The following properties define the three parts
# The base name of a session token identifier (Default GSSession)
#sessionBaseName=GSSession
# An identifier for session tokens, unique to the service using
#  any given set of private encryption keys
#  (Default InetAddress.getLocalHost().getHostName(); )
#sessionServer=
# An identifying port number for session tokens (Default: 8080)
#sessionPort=8080

# The ID Token, on the other hand, has only one part.
# For V3 Backwards compatibility:
#idTokenName=GSId       
# For V3 backwards compatibiliby with the Portal:
#idTokenName=GSIdGUID 
# For V4:
idTokenName=GSSSO

# Optional token name overrides
#V3TokenName=GSId
#V4TokenName=GSSSO

# In some contexts, GSAuthN can use the IP Address of the client
#  (for example in a servlet). However, circumstances can make that
#  an unreliable indicator of authenticity (for example, when a
#  servlet is receiving requests from a set of proxies rather than
#  a web browser). (Default false) N.B. This should always be
#  &#39;false&#39; when using the WebLogic 5.1 Custom Realm, and inheriting
#  from GSAuthNSerlvet.  It is not possible to perform this check
#  correctly in WebLogic Server 5.1 at the time of writing
checkClientIp=false

# If you are issuing ID tokens and signing them, you must provide
#  a private key file location: (default config/private.key)
#privateKeyFile=../conf/private.key
#
# Currently no need to set these two properties - you have no choice
# about this algorithm.
#
# The algorithm with which to sign the data in an ID token
#signingAlgorithm=SHA1withRSA
# The format of the keys for the ID signing algorithm
#signingKeyType=RSA

####################################################################
#           GSAuthNRealm and GSAuthenticator Properties            #
####################################################################

# Set this property to enable (true) or disable (false) direct
#  authenticated connections to a WebLogic server from a browser.
#  Note, however, that this will add approximately 80ms to every
#  request, and is not recommended outside development environments.
#  (WebLogic only)
allowDirectConnections=true

# If not defined, this defaults to true. It should be overridden to false
# for sites using ICORN V4 that DON&#39;T support GUIDs, and require usernames
# instead.
# If set to true, ensure that the WebID server beign used provides GUIDs
# in the GSSSO token.
usingGUID=false

# If not defined, this defaults to false. It can be overridden to true
# for sites that wish to accept using ICORN V4 test tokens.
# Note that this requires careful consideration; a robust authorization
# mechanism is required in order to ensure that IDs asserted by test tokens
# are not allowed to access restricted functionality.
allowTestID=false

# This is used exclusively by the TrustingAuthenticator for Tomcat, and
# allows it to accept any asserted REMOTE_USER, for use with non-standard
# authentication.
allowRemoteUser=false

# There is GEL V1 functionality in the GSAuthN Custom Realm, that is
#  only used when EJB authentication is enabled.  For the majority
#  of applications, you should not need to enable GEL, but if you
#  do, you must supply a servername, and login credentials here
#  (WebLogic only - Tomcat GEL configuration is determined by
#   web.xml properties).
gelEnabled=false
# gelServer=
# gelUsername=
# gelPassword=

# These properties override the defaults for redirecting to the
#  Firm&#39;s WebID service.  They result in a URI for authentication
#  of the form:
#   https://&lt;webidServer&gt;[:&lt;webidPort&gt;]/&lt;webidCgiPath/&lt;webidCgiName&gt;
# By default this redirects for authentication to:
#   https://webid.is.gs.com/cgi-bin/login.cgi
# WebID server - default webid.is.gs.com
#webidServer=authn.web.gs.com
# WebID server port - defaults to 443
#webidPort=443
# URI path to the login CGI - defaults to cgi-bin
#webidCgiPath=desktopsso
# Name of the login CGI - defaults to login.cgi
#webidCgiName=Login
# Domain for which the WebID should issue cookies
tokenDomain=.gs.com
# Set http only on the session cookie (tomcat 7+ only)
#httpOnly=false
# Pull public keys from URL
publicKeysFromURL=true
# URL to retrieve public key from
publicKeyFileURL=https://webid.is.gs.com/public-keys/public.key
# disables redirect and returns HTTP 403 FORBIDDEN
#disableRedirect=false

</pre>
</div></div></td></tr></tbody></table></div><p><br/></p>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Feb 12, 2021 23:35</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
