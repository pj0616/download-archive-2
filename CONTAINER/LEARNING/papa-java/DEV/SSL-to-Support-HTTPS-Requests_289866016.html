<!DOCTYPE html>
<html>
    <head>
        <title>DevOps : SSL to Support HTTPS Requests</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DevOps</a></span>
                            </li>
                                                    <li>
                                <span><a href="DevOps-Home_603226548.html">DevOps Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Tutorials_278921431.html">Tutorials</a></span>
                            </li>
                                                    <li>
                                <span><a href="Spring-Boot_278888737.html">Spring Boot</a></span>
                            </li>
                                                    <li>
                                <span><a href="Eligibility_289898573.html">Eligibility</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DevOps : SSL to Support HTTPS Requests
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Nicholas Guner</span> on Apr 19, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Refer (judiciously) to following links:</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/289866016/289866023.png" data-image-src="attachments/289866016/289866023.png" data-height="181" data-width="649" data-unresolved-comment-count="0" data-linked-resource-id="289866023" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20200419-120834.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="289866016" data-linked-resource-container-version="1" data-media-id="944abb67-c78c-4052-8337-1ff758ea9b32" data-media-type="file"></span><h1 id="SSLtoSupportHTTPSRequests-Importexistingcertificateintothekeystore(IfyoualreadyhavetheSSLcertificate)">Import existing certificate into the keystore (If you already have the SSL certificate)</h1><p>If you already have an SSL certificate, you can import it into the keystore with:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 118.0px;"/><col style="width: 640.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p>Command:</p></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">keytool -import -alias eligibility -file &lt;file_name&gt;.crt -keystore eligibility.jks -storepass password</pre>
</div></div></td></tr></tbody></table></div><h1 id="SSLtoSupportHTTPSRequests-Usekeytooltogenerateasetofcrytographickeys">Use <code>keytool</code> to generate a set of crytographic keys</h1><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/289866016/289866034.png" data-image-src="attachments/289866016/289866034.png" data-height="371" data-width="891" data-unresolved-comment-count="0" data-linked-resource-id="289866034" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20200419-121008.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="289866016" data-linked-resource-container-version="1" data-media-id="5d1b1fd5-ce7f-4a19-b3bd-e44c3fd8dcf1" data-media-type="file"></span><p>Note generated file:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 107.0px;"/><col style="width: 651.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p>File:</p></td><td class="confluenceTd"><p><code>eligibility.jks</code></p></td></tr></tbody></table></div><h3 id="SSLtoSupportHTTPSRequests-Verify">Verify</h3><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td class="confluenceTd"><p>Command:</p></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">keytool -list -v -keystore eligibility.jks</pre>
</div></div></td></tr><tr><td class="confluenceTd"><p>Response:</p></td><td class="confluenceTd"><p><code>Certificate fingerprints:</code><br/><code>MD5: 64:D4:A2:C4:0C:09:2B:37:67:2E:F1:D9:82:0E:50:24</code><br/><code>SHA1: FA:90:D6:5E:5F:3E:71:6A:57:20:36:9D:B8:A4:41:50:5E:EE:F1:7A</code><br/><code>SHA256: 74:47:88:31:DD:52:1A:71:43:38:39:50:96:EC:A0:38:59:F8:26:0D:8F:4C:8B:5E:A8:62:F2:F8:3B:15:75:55</code><br/><code>Signature algorithm name: SHA256withRSA</code><br/><code>Subject Public Key Algorithm: 2048-bit RSA key</code><br/><code>Version: 3</code></p><p><code>Extensions:</code></p><p><code>#1: ObjectId: 2.5.29.14 Criticality=false</code><br/><code>SubjectKeyIdentifier [</code><br/><code>KeyIdentifier [</code><br/><code>0000: E8 55 39 F4 F1 08 D9 53 02 43 31 48 C5 82 F8 46 .U9....S.C1H...F</code><br/><code>0010: C3 52 16 AC .R..</code><br/><code>]</code><br/><code>]</code></p><p><code>...</code></p></td></tr></tbody></table></div><h3 id="SSLtoSupportHTTPSRequests-Copyeligibility.jkstothe/resourcesdirectoryofyourapplication.">Copy <code>eligibility.jks</code> to the <code>/resources</code> directory of your application.</h3><h1 id="SSLtoSupportHTTPSRequests-EnableSSL">Enable SSL</h1><p>After copying <code>eligibility.jks</code> file to the <code>resources</code> directory, add following properties:</p><p><strong>resources/application.properties</strong></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="initial" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">...
server.port=8443
server.ssl.key-store-type=JKS
server.ssl.key-store=classpath:eligibility.jks
server.ssl.key-store-password=password
server.ssl.key-alias=eligibility
...</pre>
</div></div></td></tr></tbody></table></div><h3 id="SSLtoSupportHTTPSRequests-Test">Test</h3><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 233.0px;"/><col style="width: 525.0px;"/></colgroup><tbody><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Request</strong></p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Response</strong></p></th></tr><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Request</strong></p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Response</strong></p></th></tr><tr><td class="confluenceTd"><p><a href="https://localhost:8443/rules/duties" class="external-link" rel="nofollow">https://localhost:8443/rules/duties</a></p></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">...
{
  &quot;ruleName&quot;: &quot;BigPerks-Rule&quot;,
  &quot;ruleType&quot;: &quot;Allow&quot;,
  &quot;ruleState&quot;: &quot;Draft&quot;,
  &quot;propertiesPresentation&quot;: [
    {
      &quot;propertiesId&quot;: 6,
      &quot;keyStore&quot;: {
        &quot;Level&quot;: &quot;MD&quot;
      }
    }
  ],
  &quot;links&quot;: [
    {
      &quot;rel&quot;: &quot;rule&quot;,
      &quot;href&quot;: &quot;https://localhost:8443/rules/4&quot;,
      &quot;title&quot;: &quot;BigPerks-Rule&quot;
    },
    {
      &quot;rel&quot;: &quot;self&quot;,
      &quot;href&quot;: &quot;https://localhost:8443/rules/4/duties&quot;
    },
    {
      &quot;rel&quot;: &quot;duty&quot;,
      &quot;href&quot;: &quot;https://localhost:8443/duties/3&quot;,
      &quot;title&quot;: &quot;Big Perks&quot;
    }
  ]
},
...</pre>
</div></div></td></tr><tr><td class="confluenceTd"><p><a href="http://localhost:8443/rules/duties" class="external-link" rel="nofollow">http://localhost:8443/rules/duties</a></p></td><td class="confluenceTd"><p><code>Bad Request</code><br/><code>This combination of host and port requires TLS.</code></p></td></tr></tbody></table></div><h1 id="SSLtoSupportHTTPSRequests-UsebothHTTPandHTTPS">Use both HTTP and HTTPS</h1><p>From the previous response, note that once we enable HTTPS and specify the <code>server.port</code> property, HTTP requests are no longer supported. To support both HTTP and HTTPS, we need to provide a second connector.</p><h3 id="SSLtoSupportHTTPSRequests-Modifyapplication.propertiestoaddvalueforHTTPport">Modify application.properties to add value for HTTP port</h3><p><strong>resources/application.properties</strong></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="initial" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">...
server.http.port=8081
...</pre>
</div></div></td></tr></tbody></table></div><h3 id="SSLtoSupportHTTPSRequests-Addanother@Componenttotheconfigpackage">Add another @Component to the config package</h3><p><strong>config/HttpServer.java</strong></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="initial" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Component
public class HttpServer
{
    @Bean
    public ServletWebServerFactory servletContainer(@Value(&quot;${server.http.port}&quot;) int httpPort)
    {
        Connector connector = new Connector(TomcatServletWebServerFactory.DEFAULT_PROTOCOL);
        connector.setPort(httpPort);
 
        TomcatServletWebServerFactory tomcat = new TomcatServletWebServerFactory();
        tomcat.addAdditionalTomcatConnectors(connector);
        return tomcat;
    }
}</pre>
</div></div></td></tr></tbody></table></div><h2 id="SSLtoSupportHTTPSRequests-TestHTTPandHTTPSrequests">Test HTTP and HTTPS requests</h2><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 238.0px;"/><col style="width: 520.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Request</strong></p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Response</strong></p></th></tr><tr><td class="confluenceTd"><p><a href="https://localhost:8443/rules/duties" class="external-link" rel="nofollow">https://localhost:8443/rules/duties</a></p></td><td class="confluenceTd"><p><br/></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">...
{
  &quot;ruleName&quot;: &quot;BigPerks-Rule&quot;,
  &quot;ruleType&quot;: &quot;Allow&quot;,
  &quot;ruleState&quot;: &quot;Draft&quot;,
  &quot;propertiesPresentation&quot;: [
    {
      &quot;propertiesId&quot;: 6,
      &quot;keyStore&quot;: {
        &quot;Level&quot;: &quot;MD&quot;
      }
    }
  ],
  &quot;links&quot;: [
    {
      &quot;rel&quot;: &quot;rule&quot;,
      &quot;href&quot;: &quot;https://localhost:8443/rules/4&quot;
      &quot;title&quot;: &quot;BigPerks-Rule&quot;
    },
    {
      &quot;rel&quot;: &quot;self&quot;,
      &quot;href&quot;: &quot;https://localhost:8443/rules/4/
    },
    {
      &quot;rel&quot;: &quot;duty&quot;,
      &quot;href&quot;: &quot;https://localhost:8443/duties/3
      &quot;title&quot;: &quot;Big Perks&quot;
    }
  ]
},
...</pre>
</div></div><p><br/></p></td></tr><tr><td class="confluenceTd"><p><a href="http://localhost:8081/rules/duties" class="external-link" rel="nofollow">http://localhost:8081/rules/duties</a></p></td><td class="confluenceTd"><p><br/></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">...
{
  &quot;ruleName&quot;: &quot;BigPerks-Rule&quot;,
  &quot;ruleType&quot;: &quot;Allow&quot;,
  &quot;ruleState&quot;: &quot;Draft&quot;,
  &quot;propertiesPresentation&quot;: [
    {
      &quot;propertiesId&quot;: 6,
      &quot;keyStore&quot;: {
        &quot;Level&quot;: &quot;MD&quot;
      }
    }
  ],
  &quot;links&quot;: [
    {
      &quot;rel&quot;: &quot;rule&quot;,
      &quot;href&quot;: &quot;http://localhost:8081/rules/4&quot;,
      &quot;title&quot;: &quot;BigPerks-Rule&quot;
    },
    {
      &quot;rel&quot;: &quot;self&quot;,
      &quot;href&quot;: &quot;http://localhost:8081/rules/4/dut
    },
    {
      &quot;rel&quot;: &quot;duty&quot;,
      &quot;href&quot;: &quot;http://localhost:8081/duties/3&quot;,
      &quot;title&quot;: &quot;Big Perks&quot;
    }
  ]
},
...</pre>
</div></div><p><br/></p></td></tr></tbody></table></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/289866016/289866023.png">image-20200419-120834.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/289866016/289866034.png">image-20200419-121008.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Feb 12, 2021 23:35</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
