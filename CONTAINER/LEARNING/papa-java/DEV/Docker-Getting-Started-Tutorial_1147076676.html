<!DOCTYPE html>
<html>
    <head>
        <title>DevOps : Docker Getting Started Tutorial</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DevOps</a></span>
                            </li>
                                                    <li>
                                <span><a href="DevOps-Home_603226548.html">DevOps Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Tutorials_278921431.html">Tutorials</a></span>
                            </li>
                                                    <li>
                                <span><a href="Docker_1143275557.html">Docker</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DevOps : Docker Getting Started Tutorial
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Nicholas Guner</span>, last modified on Feb 02, 2021
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Make sure to:</p><p>install Docker - <a href="https://nickguner.atlassian.net/wiki/spaces/DEV/pages/1143013377/Docker+Windows+Install+and+Uninstall+Procedures#Install" data-card-appearance="inline" rel="nofollow">https://nickguner.atlassian.net/wiki/spaces/DEV/pages/1143013377/Docker+Windows+Install+and+Uninstall+Procedures#Install</a> </p><p><a href="https://nickguner.atlassian.net/wiki/spaces/DEV/pages/1151041543/Setup+Environment+for+Docker#Intent" data-card-appearance="inline" rel="nofollow">https://nickguner.atlassian.net/wiki/spaces/DEV/pages/1151041543/Setup+Environment+for+Docker#Intent</a> </p><p /><style type='text/css'>/*<![CDATA[*/
div.rbtoc1613190984965 {padding: 0px;}
div.rbtoc1613190984965 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1613190984965 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1613190984965'>
<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-GettingStartedURL'>Getting Started URL</a>
<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-Startthetutorial'>Start the tutorial</a></li>
<li><a href='#DockerGettingStartedTutorial-DockerDashboard'>Docker Dashboard</a></li>
<li><a href='#DockerGettingStartedTutorial-Whatisacontainerimage'>What is a container image</a></li>
</ul>
</li>
<li><a href='#DockerGettingStartedTutorial-OurApplication'>Our Application</a>
<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-BuildApplicationContainerImage'>Build Application Container Image</a></li>
<li><a href='#DockerGettingStartedTutorial-StartinganAppContainer'>Starting an App Container</a>
<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-Testtheapplication'>Test the application</a></li>
</ul>
</li>
</ul>
</li>
<li><a href='#DockerGettingStartedTutorial-UpdatingourApplication'>Updating our Application</a></li>
<li><a href='#DockerGettingStartedTutorial-Sharingourapplication'>Sharing our application</a>
<ul class='toc-indentation'>

<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-LogintoDockerHub'>Login to DockerHub</a></li>
</ul>
<li><a href='#DockerGettingStartedTutorial-PushtheimagetoDockerHubrepository'>Push the image to DockerHub repository</a></li>
<li><a href='#DockerGettingStartedTutorial-RunourimageonaNewInstance'>Run our image on a New Instance</a></li>
</ul>
</li>
<li><a href='#DockerGettingStartedTutorial-PersistingourDatabase'>Persisting our Database</a>
<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-TheContainer’sFileSystem'>The Container’s FileSystem</a>
<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-Seeingthisinpractice'>Seeing this in practice</a></li>
</ul>
</li>
<li><a href='#DockerGettingStartedTutorial-ContainerVolumes'>Container Volumes</a>
<ul class='toc-indentation'>
<li><a href='#DockerGettingStartedTutorial-PersistingourToDoData'>Persisting our ToDo Data</a></li>
<li><a href='#DockerGettingStartedTutorial-Checkwherethedataisactuallystoredonthelocalhost'>Check where the data is actually stored on the local host</a></li>
</ul>
</li>
</ul>
</li>
<li><a href='#DockerGettingStartedTutorial-Usingbindmounts'>Using bind mounts</a></li>
</ul>
</div><h1 id="DockerGettingStartedTutorial-GettingStartedURL">Getting Started URL</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>URL:</strong></p></th><td class="confluenceTd"><p><a href="https://docs.docker.com/get-started/" class="external-link" rel="nofollow">https://docs.docker.com/get-started/</a></p></td></tr></tbody></table></div><h2 id="DockerGettingStartedTutorial-Startthetutorial">Start the tutorial</h2><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><td class="confluenceTd"><p><code>docker run -d -p 80:80 docker/getting-started</code></p></td></tr></tbody></table></div><p>Note: parameters (<code>-d -p</code>) may be combined, as in: <code>docker run -dp 80:80 docker/getting-started</code></p><p>In case of the following error message:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 72.0px;"/><col style="width: 686.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Error:</strong></p></th><td class="confluenceTd"><p><code>Error response from daemon: Ports are not available: listen tcp 0.0.0.0:80: bind: An attempt was made to access a socket in a way forbidden by its access permissions.</code></p></td></tr></tbody></table></div><p>The port should be 1337, not 80 as is suggested in the tutorial.</p><p>Try following command which should work:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><td class="confluenceTd"><p><code>docker run -d -p 1337:80 docker/getting-started</code></p></td></tr><tr><th class="confluenceTh"><p><strong>Expected Response:</strong></p></th><td class="confluenceTd"><p><code>97130ed6d22b13f6b5e79f8fd72bbb851c8bf126e31eb250ff6d68c4f3cb7bcd</code></p></td></tr></tbody></table></div><p>The value you see in your console might be different.</p><h2 id="DockerGettingStartedTutorial-DockerDashboard">Docker Dashboard</h2><p>Gives you a quick view of the containers running on your machine. It gives you quick access to container logs, lets you get a shell inside the container, and lets you easily manage container lifecycle (stop, remove, etc.).</p><p>You will see the running container in your Docker Dashboard. The name of your container will be different than what is shown below:</p><span class="confluence-embedded-file-wrapper image-left-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-left" width="340" loading="lazy" src="attachments/1147076676/1150877728.png?width=340" data-image-src="attachments/1147076676/1150877728.png" data-height="181" data-width="621" data-unresolved-comment-count="0" data-linked-resource-id="1150877728" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-181941.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="3ed2af28-3856-4fe8-97ca-cd492d79221b" data-media-type="file"></span><p>You now have a running <code>container</code>. A container is simply another process on your machine that has been isolated from all other processes on the host machine.</p><h2 id="DockerGettingStartedTutorial-Whatisacontainerimage">What is a container image</h2><p>When running a container, it uses an isolated filesystem. This custom filesystem is provided by a <strong>container image</strong>. Since the image contains the container’s filesystem, it must contain everything needed to run an application - all dependencies, configuration, scripts, binaries, etc. The image also contains other configuration for the container, such as environment variables, a default command to run, and other metadata.</p><h1 id="DockerGettingStartedTutorial-OurApplication">Our Application</h1><p>Follow instructions to download git repository <a href="https://github.com/docker/getting-started/tree/master/app" data-card-appearance="inline" class="external-link" rel="nofollow">https://github.com/docker/getting-started/tree/master/app</a> and extract to some directory, for example:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Directory:</strong></p></th><td class="confluenceTd"><p><code>C:\Users\nick\Docker\getting-started-master</code></p></td></tr></tbody></table></div><p>Open project in VSCode and examine <code>app/package.json</code> file</p><h2 id="DockerGettingStartedTutorial-BuildApplicationContainerImage">Build Application Container Image</h2><p>In order to build the application, we need to use a <code>Dockerfile</code></p><p>Create file named <code>Dockerfile </code>(without any extensions in the same directory as <code>package.json</code></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">FROM node:12-alpine
WORKDIR /app
COPY . .
RUN yarn install --production
CMD [&quot;node&quot;, &quot;src/index.js&quot;]</pre>
</div></div><p>Build the image from the app directory where the newly created Dockerfile resides.</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 124.0px;"/><col style="width: 634.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Action</strong></p></th><th class="confluenceTh"><p><strong>Commands</strong></p></th></tr><tr><td class="confluenceTd"><p>cd</p></td><td class="confluenceTd"><p><code>cd C:\Users\nick\Docker\getting-started-master\getting-started-master\app</code></p></td></tr><tr><td class="confluenceTd"><p>build image</p></td><td class="confluenceTd"><p><code>docker build -t getting-started .</code></p></td></tr></tbody></table></div><p>Notes:</p><p>The <code>-t</code> flag (in <code>docker build</code> command) tags our image. This simply as a human-readable name for the final image. Since we named the image <code>getting-started</code>, we can refer to that image when we run a container</p><h2 id="DockerGettingStartedTutorial-StartinganAppContainer">Starting an App Container</h2><p>An image runs within a container. Now that we have an image, let’s run the application! To do so, we will use the <code>docker run</code> command</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><td class="confluenceTd"><p><code>docker run -dp 3000:3000 getting-started</code></p></td></tr><tr><th class="confluenceTh"><p><strong>Response:</strong></p></th><td class="confluenceTd"><p><code>c64fb6e68720436c784ff2864798770c828e5cc02e44f5a6138dcb9e095beedd</code></p></td></tr></tbody></table></div><p>Note that the response value you see will be different.</p><p>Notes:</p><ol><li><p>We’re running the new container in “detached” (-d) mode (in the background) </p></li><li><p>We are creating a mapping between the host’s port 3000 to the container’s port 3000. Without the port mapping, we wouldn’t be able to access the application.</p></li></ol><h3 id="DockerGettingStartedTutorial-Testtheapplication">Test the application</h3><p>From your browser:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 209.0px;"/><col style="width: 549.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Address:</strong></p></th><th class="confluenceTh"><p><strong>Expected Response:</strong></p></th></tr><tr><td class="confluenceTd"><p> <a href="http://localhost:3000/" class="external-link" rel="nofollow">http://localhost:3000</a></p></td><td class="confluenceTd"><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/1147076676/1150451751.png" data-image-src="attachments/1147076676/1150451751.png" data-height="108" data-width="611" data-unresolved-comment-count="0" data-linked-resource-id="1150451751" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-190001.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="8fcfd551-6f52-44b4-8812-ed880faffd9e" data-media-type="file"></span><p /></td></tr></tbody></table></div><p>Use this front-end to add a few items:</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/1147076676/1150877742.png" data-image-src="attachments/1147076676/1150877742.png" data-height="213" data-width="604" data-unresolved-comment-count="0" data-linked-resource-id="1150877742" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-190110.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="1196d334-2297-4072-b493-08c787ebd8e6" data-media-type="file"></span><p>You should see this container in the Docker Dashboard:</p><span class="confluence-embedded-file-wrapper image-left-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-left" width="340" loading="lazy" src="attachments/1147076676/1147076698.png?width=340" data-image-src="attachments/1147076676/1147076698.png" data-height="73" data-width="394" data-unresolved-comment-count="0" data-linked-resource-id="1147076698" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-190317.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="be7ebd50-b651-424d-b70d-040554f49f26" data-media-type="file"></span><h1 id="DockerGettingStartedTutorial-UpdatingourApplication">Updating our Application</h1><p>Make a small change in <code>src/static/js/app.js</code> file, on line 56</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 86.0px;"/><col style="width: 672.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>From:</strong></p></th><td class="confluenceTd"><p><code>&lt;p className=&quot;text-center&quot;&gt;No items yet! Add one above!&lt;/p&gt;</code></p></td></tr><tr><th class="confluenceTh"><p><strong>To:</strong></p></th><td class="confluenceTd"><p><code>&lt;p className=&quot;text-center&quot;&gt;You have no todo items yet! Add one above!&lt;/p&gt;</code></p></td></tr></tbody></table></div><p>and rebuild the updated version of the image:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 124.0px;"/><col style="width: 634.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker build -t getting-started .</code></p></td></tr></tbody></table></div><p>Use Docker Dashboard to stop the running container:</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/1147076676/1150451759.png" data-image-src="attachments/1147076676/1150451759.png" data-height="98" data-width="993" data-unresolved-comment-count="0" data-linked-resource-id="1150451759" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-191226.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="0eefbab0-3f5d-4181-885f-c4963a7c8758" data-media-type="file"></span><p>Alternatively, you may use CLI (Command Line Interface) to stop and remove the container</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 238.0px;"/><col style="width: 522.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Action</strong></p></th><th class="confluenceTh"><p><strong>Command</strong></p></th></tr><tr><td class="confluenceTd"><p>Get List of container IDs</p></td><td class="confluenceTd"><p><code>docker ps</code></p></td></tr><tr><td class="confluenceTd"><p>Stop the container</p></td><td class="confluenceTd"><p><code>docker stop &lt;container-id&gt;</code></p></td></tr><tr><td class="confluenceTd"><p>Remove the container</p></td><td class="confluenceTd"><p><code>docker rm &lt;container-id&gt;</code></p></td></tr></tbody></table></div><p>Note:</p><ol><li><p>You can stop and remove a container in a single command by adding the “force” flag to the <code>docker rm</code> command. </p></li></ol><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">  docker rm -f &lt;container-id&gt;</pre>
</div></div><p>Start container with updated code:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 124.0px;"/><col style="width: 634.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker run -dp 3000:3000 getting-started</code></p></td></tr></tbody></table></div><p>And observe change in the browser:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 209.0px;"/><col style="width: 549.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Address:</strong></p></th><th class="confluenceTh"><p><strong>Expected Response:</strong></p></th></tr><tr><td class="confluenceTd"><p> <a href="http://localhost:3000/" class="external-link" rel="nofollow">http://localhost:3000</a></p></td><td class="confluenceTd"><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/1147076676/1151074359.png" data-image-src="attachments/1147076676/1151074359.png" data-height="113" data-width="613" data-unresolved-comment-count="0" data-linked-resource-id="1151074359" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-191408.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="79d0c9b8-6f02-4cc7-80fd-c22b11293d86" data-media-type="file"></span><p /></td></tr></tbody></table></div><h1 id="DockerGettingStartedTutorial-Sharingourapplication">Sharing our application</h1><p>To share Docker images, you have to use a Docker registry. The default registry is Docker Hub and is where all of the images we’ve used have come from.</p><h3 id="DockerGettingStartedTutorial-LogintoDockerHub">Login to DockerHub</h3><p>See <a href="https://nickguner.atlassian.net/wiki/spaces/DEV/pages/1150451717/Docker+Commands#Docker-Hub" data-card-appearance="inline" rel="nofollow">https://nickguner.atlassian.net/wiki/spaces/DEV/pages/1150451717/Docker+Commands#Docker-Hub</a> </p><p>Click button to “Create Repository”, name it “getting-started”, and make sure it is “Public”</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/1147076676/1150517292.png" data-image-src="attachments/1147076676/1150517292.png" data-height="417" data-width="761" data-unresolved-comment-count="0" data-linked-resource-id="1150517292" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-193122.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="fc2dd47f-ed8d-47e3-b2bf-cf2243178b68" data-media-type="file"></span><p>and click “Create”.</p><p /><p>Note the command to push a new tag to this repository:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><td class="confluenceTd"><p><code>docker push lonelyboy/getting-started:tagname</code></p></td></tr></tbody></table></div><h2 id="DockerGettingStartedTutorial-PushtheimagetoDockerHubrepository">Push the image to DockerHub repository</h2><p>We need to “tag” our existing image we’ve built to give it another name.</p><p>Login to dockerhub with your user name:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><td class="confluenceTd"><p><code>docker login -u lonelyboy</code></p></td></tr></tbody></table></div><p>and provide password when prompted.</p><p>Tag image to give it a new name</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><td class="confluenceTd"><p><code>docker tag getting-started lonelyboy/getting-started</code></p></td></tr></tbody></table></div><p>Push the image (we can drop to <code>tagname </code>portion. Docker will use a tag <code>latest</code>)</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 169.0px;"/><col style="width: 589.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><td class="confluenceTd"><p><code>docker push lonelyboy/getting-started</code></p></td></tr></tbody></table></div><h2 id="DockerGettingStartedTutorial-RunourimageonaNewInstance">Run our image on a New Instance</h2><p>We can use “Play with Docker” website as a new instance.</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 82.0px;"/><col style="width: 678.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>URL:</strong></p></th><td class="confluenceTd"><p><a href="http://play-with-docker.com/" class="external-link" rel="nofollow">http://play-with-docker.com/</a></p></td></tr></tbody></table></div><p>In the terminal window, start your app which will be downloaded from the DockerHub</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 124.0px;"/><col style="width: 634.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker run -dp 3000:3000 lonelyboy/getting-started</code></p></td></tr></tbody></table></div><p>Click on the 3000 badge to see your app in the browser.</p><span class="confluence-embedded-file-wrapper image-left-wrapper"><img class="confluence-embedded-image image-left" loading="lazy" src="attachments/1147076676/1150156908.png" data-image-src="attachments/1147076676/1150156908.png" data-height="41" data-width="186" data-unresolved-comment-count="0" data-linked-resource-id="1150156908" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-194705.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="933533f3-324b-48c9-a309-d88bef283a65" data-media-type="file"></span><h1 id="DockerGettingStartedTutorial-PersistingourDatabase">Persisting our Database</h1><h2 id="DockerGettingStartedTutorial-TheContainer’sFileSystem">The Container’s FileSystem</h2><p>When a container runs, it uses the various layers from an image for its filesystem. Each container also gets its own “scratch space” to create/update/remove files. Any changes won’t be seen in another container, <em>even if</em> they are using the same image.</p><h3 id="DockerGettingStartedTutorial-Seeingthisinpractice">Seeing this in practice</h3><p>We’re going to start two containers and create a file in each. What you’ll see is that the files created in one container aren’t available in another.</p><p>Start a <code>ubuntu</code> container that will create a file named <code>/data.txt</code> with a random number between 1 and 1000</p><div class="table-wrap"><table data-layout="wide" class="confluenceTable"><colgroup><col style="width: 158.0px;"/><col style="width: 802.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker run -d ubuntu bash -c &quot;shuf -i 1-10000 -n 1 -o /data.txt &amp;&amp; tail -f /dev/null&quot;</code></p></td></tr></tbody></table></div><p>We can view this container in Docker Dashboard and exec into it with CLI button</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/1147076676/1151008853.png" data-image-src="attachments/1147076676/1151008853.png" data-height="96" data-width="938" data-unresolved-comment-count="0" data-linked-resource-id="1151008853" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-195632.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="c9efa74d-6662-4a9e-90ba-9db5ddf3d6f4" data-media-type="file"></span><p>and view text in data.txt file:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 340.0px;"/><col style="width: 340.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command</strong></p></th><th class="confluenceTh"><p><strong>Response</strong></p></th></tr><tr><td class="confluenceTd"><p><code>cat /data.txt</code></p></td><td class="confluenceTd"><p>2320</p></td></tr></tbody></table></div><p>Note: the number you will see will be different.</p><p>You can also view this file from your CMD console:</p><div class="table-wrap"><table data-layout="wide" class="confluenceTable"><colgroup><col style="width: 212.0px;"/><col style="width: 327.0px;"/><col style="width: 421.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Action</strong></p></th><th class="confluenceTh"><p><strong>Command</strong></p></th><th class="confluenceTh"><p><strong>Response</strong></p></th></tr><tr><td class="confluenceTd"><p>Find Container ID</p></td><td class="confluenceTd"><p><code>docker ps</code></p></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">CONTAINER ID   IMAGE
c85a954043a5   ubuntu
3b902ca40ea4   getting-started
97130ed6d22b   docker/getting-started</pre>
</div></div></td></tr><tr><td class="confluenceTd"><p>view data in file</p></td><td class="confluenceTd"><p><code>docker exec c85a954043a5 cat /data.txt</code></p></td><td class="confluenceTd"><p>2320</p></td></tr></tbody></table></div><p>Start another ubuntu container without creating a file:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 108.0px;"/><col style="width: 650.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker run -it ubuntu ls /</code></p></td></tr><tr><th class="confluenceTh"><p>Output:</p></th><td class="confluenceTd"><p><code>bin   dev  home  lib32  libx32  mnt  proc  run   srv  tmp  var</code><br/><code>boot  etc  lib   lib64  media   opt  root  sbin  sys  usr</code></p></td></tr></tbody></table></div><p>and note that file <code>data.txt</code> does not exist in the second container.</p><p>Remove the first container with <code>docker rm -f</code> command:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 108.0px;"/><col style="width: 650.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker rm -f c85a954043a5</code></p></td></tr></tbody></table></div><h2 id="DockerGettingStartedTutorial-ContainerVolumes">Container Volumes</h2><p><a href="https://docs.docker.com/storage/volumes/" class="external-link" rel="nofollow">Volumes</a> provide the ability to connect specific filesystem paths of the container back to the host machine.</p><p>If a directory in the container is mounted, changes in that directory are also seen on the host machine. If we mount that same directory across container restarts, we’d see the same files.</p><p>There are two main types of volumes. We will eventually use both, but we will start with <strong>named volumes</strong>.</p><h3 id="DockerGettingStartedTutorial-PersistingourToDoData">Persisting our ToDo Data</h3><p>By default, the todo app stores its data in a <a href="https://www.sqlite.org/index.html" class="external-link" rel="nofollow">SQLite Database</a> at <code>/etc/todos/todo.db</code>.</p><p>With the database being a single file, if we can persist that file on the host and make it available to the next container, it should be able to pick up where the last one left off.</p><p>By creating a volume and attaching (often called “mounting”) it to the directory the data is stored in, we can persist the data. As our container writes to the <code>todo.db</code> file, it will be persisted to the host in the volume.</p><p>We are going to use a <strong>named volume</strong></p><p>Create a named volume:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 108.0px;"/><col style="width: 650.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker volume create todo-db</code></p></td></tr></tbody></table></div><p>Stop the getting-started container from the Dashboard since it is running without persistent storage.</p><p>Start the todo app container, but add the <code>-v</code> flag to specify a volume mount. We will use the named volume and mount it to <code>/etc/todos</code>, which will capture all files created at the path.</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 108.0px;"/><col style="width: 650.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker run -dp 3000:3000 -v todo-db:/etc/todos getting-started</code></p></td></tr></tbody></table></div><p>Once the container starts up, open the app and add a few items to your todo list;</p><span class="confluence-embedded-file-wrapper image-left-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-left" width="340" loading="lazy" src="attachments/1147076676/1150976047.png?width=340" data-image-src="attachments/1147076676/1150976047.png" data-height="215" data-width="608" data-unresolved-comment-count="0" data-linked-resource-id="1150976047" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-201852.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="5aecb807-f48d-421b-b291-d3782e7f38c3" data-media-type="file"></span><p>Remove the running container:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 298.0px;"/><col style="width: 460.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><th class="confluenceTh"><p><strong>Response:</strong></p></th></tr><tr><td class="confluenceTd"><p><code>docker ps</code></p></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">CONTAINER ID   IMAGE
6dae3a85d7fb   getting-started</pre>
</div></div></td></tr><tr><td class="confluenceTd"><p><code>docker rm -f 6dae3a85d7fb   </code></p></td><td class="confluenceTd"><p /></td></tr></tbody></table></div><p>Restart the container with the same command:</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 108.0px;"/><col style="width: 650.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Command:</p></th><td class="confluenceTd"><p><code>docker run -dp 3000:3000 -v todo-db:/etc/todos getting-started</code></p></td></tr></tbody></table></div><p>You should see items that were created in the previous session:</p><span class="confluence-embedded-file-wrapper image-left-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-left" width="340" loading="lazy" src="attachments/1147076676/1150976047.png?width=340" data-image-src="attachments/1147076676/1150976047.png" data-height="215" data-width="608" data-unresolved-comment-count="0" data-linked-resource-id="1150976047" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20210129-201852.png" data-base-url="https://nickguner.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1147076676" data-linked-resource-container-version="8" data-media-id="5aecb807-f48d-421b-b291-d3782e7f38c3" data-media-type="file"></span><p>Remove this container (<code>docker ps, docker rm -f &lt;container_id&gt;</code>)</p><h3 id="DockerGettingStartedTutorial-Checkwherethedataisactuallystoredonthelocalhost">Check where the data is actually stored on the local host</h3><div class="table-wrap"><table data-layout="wide" class="confluenceTable"><colgroup><col style="width: 314.0px;"/><col style="width: 646.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Command:</strong></p></th><th class="confluenceTh"><p><strong>Response:</strong></p></th></tr><tr><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">docker volume inspect todo-db</pre>
</div></div></td><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">[
    {
        &quot;CreatedAt&quot;: &quot;2021-01-29T20:18:22Z&quot;,
        &quot;Driver&quot;: &quot;local&quot;,
        &quot;Labels&quot;: {},
        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/todo-db/_data&quot;,
        &quot;Name&quot;: &quot;todo-db&quot;,
        &quot;Options&quot;: {},
        &quot;Scope&quot;: &quot;local&quot;
    }
]</pre>
</div></div></td></tr></tbody></table></div><h1 id="DockerGettingStartedTutorial-Usingbindmounts">Using bind mounts</h1><p>Named volumes are great if we simply want to store data, as we don’t have to worry about <em>where</em> the data is stored.</p><p>With <strong>bind mounts</strong>, we control the exact mountpoint on the host. We can use this to persist data, but is often used to provide additional data into containers. When working on an application, we can use a bind mount to mount our source code into the container to let it see code changes, respond, and let us see the changes right away.</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><colgroup><col style="width: 226.67px;"/><col style="width: 226.67px;"/><col style="width: 226.67px;"/></colgroup><tbody><tr><th class="confluenceTh"><p /></th><th class="confluenceTh"><p><strong>Named Volumns</strong></p></th><th class="confluenceTh"><p><strong>Bind Mounts</strong></p></th></tr><tr><th class="confluenceTh"><p>Host Location</p></th><td class="confluenceTd"><p>Docker chooses</p></td><td class="confluenceTd"><p>You control</p></td></tr><tr><th class="confluenceTh"><p>Mount Example (using <code>-v</code>)</p></th><td class="confluenceTd"><p>my-volume:/usr/local/data</p></td><td class="confluenceTd"><p>/path/to/data:/usr/local/data</p></td></tr><tr><th class="confluenceTh"><p>Populates new volume with container contents</p></th><td class="confluenceTd"><p>Yes</p></td><td class="confluenceTd"><p>No</p></td></tr><tr><th class="confluenceTh"><p>Supports Volume Drivers</p></th><td class="confluenceTd"><p>Yes</p></td><td class="confluenceTd"><p>No</p></td></tr></tbody></table></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150156856.png">image-20210129-175318.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150877728.png">image-20210129-181941.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150451751.png">image-20210129-190001.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150877742.png">image-20210129-190110.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1147076698.png">image-20210129-190317.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150451759.png">image-20210129-191226.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1151074359.png">image-20210129-191408.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150517292.png">image-20210129-193122.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150156908.png">image-20210129-194705.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1151008847.png">image-20210129-195452.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1151008853.png">image-20210129-195632.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1147076676/1150976047.png">image-20210129-201852.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Feb 12, 2021 23:36</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
