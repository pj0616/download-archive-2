<!DOCTYPE html>
<html>
    <head>
        <title>DevOps : Hydrate Database</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DevOps</a></span>
                            </li>
                                                    <li>
                                <span><a href="DevOps-Home_603226548.html">DevOps Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Tutorials_278921431.html">Tutorials</a></span>
                            </li>
                                                    <li>
                                <span><a href="Project-Profit-Application_315097089.html">Project Profit Application</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DevOps : Hydrate Database
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Nicholas Guner</span>, last modified on May 13, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="HydrateDatabase-CreateDDL">Create DDL</h1><p>Add following lines to <code>application.properties</code> file and run the application.</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.DB2Dialect
spring.jpa.properties.javax.persistence.schema-generation.create-source=metadata
spring.jpa.properties.javax.persistence.schema-generation.scripts.action=create
spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target=create.sql</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><p>Your application will not execute but you'll note a new file getting generated:</p><p>create.sql</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">create sequence hibernate_sequence start with 1 increment by 1

create table employee (id integer not null, created_by varchar(255), in_utc timestamp not null, last_modified_by varchar(255), out_utc timestamp, audit_id varchar(255), compensation double not null, employee_code varchar(255), employee_name varchar(255), primary key (id));
create table employee_subscription_map (id integer not null, created_by varchar(255), in_utc timestamp not null, last_modified_by varchar(255), out_utc timestamp, audit_id varchar(255), employee_id integer, subscription_id integer, primary key (id));
create table project (id integer not null, created_by varchar(255), in_utc timestamp not null, last_modified_by varchar(255), out_utc timestamp, audit_id varchar(255), project_description varchar(255), project_name varchar(255), revenue double not null, primary key (id));
create table project_employee_map (id integer not null, created_by varchar(255), in_utc timestamp not null, last_modified_by varchar(255), out_utc timestamp, audit_id varchar(255), employee_id integer, project_id integer, primary key (id));
create table subscription (id integer not null, created_by varchar(255), in_utc timestamp not null, last_modified_by varchar(255), out_utc timestamp, audit_id varchar(255), fees double not null, subscription_code varchar(255), subscription_name varchar(255), primary key (id));
create unique index UKcbw6ome5i54khsmaeaax2y36o on employee (audit_id, out_utc);
create unique index UK1yprxkagbl0af2g6jspfa2vdf on employee_subscription_map (audit_id, out_utc);
create unique index UK99oexpoo9pfduh5rea99s2gd7 on project (audit_id, out_utc);
create unique index UK55xplk87qs1vgjg7wvvhdwbsx on project_employee_map (audit_id, out_utc);
create unique index UKm4s2ku6sjxcnal4a8jqyalbtf on subscription (audit_id, out_utc);
alter table employee_subscription_map add constraint FKal2gm8lsbt7626jgt5bgrjlqu foreign key (employee_id) references employee;
alter table employee_subscription_map add constraint FK4w3tm95c3bre0ocyr6gccd562 foreign key (subscription_id) references subscription;
alter table project_employee_map add constraint FKo9hw3isyxdis78q1kjx6dgsx4 foreign key (employee_id) references employee;
alter table project_employee_map add constraint FKlwh46ok6c1axys3ooh2e5rwfo foreign key (project_id) references project;


alter sequence HIBERNATE_SEQUENCE restart with 101</pre>
</div></div></td></tr></tbody></table></div><p>Execute these statements in your SQL client to create DDL entities</p><p>We will need to modify our in-memory database which is currently stored in data.sql file. First, we will append ';' to the end of each line (in Notepad++, set Regular Expressions and replace $ with ;). </p><p>We also need to set time in UTC format. We can do this by replacing &quot;CURRENT_TIMESTAMP&quot; with &quot;CURRENT_TIMESTAMP - CURRENT_TIMEZONE&quot;.</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">-- PROJECT
INSERT INTO PROJECT(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_NAME, PROJECT_DESCRIPTION, REVENUE, CREATED_BY, LAST_MODIFIED_BY) VALUES(1, &#39;00000000-0000-0000-0000-000000000001&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;P-1&#39;, &#39;Project one&#39;, 1200000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_NAME, PROJECT_DESCRIPTION, REVENUE, CREATED_BY, LAST_MODIFIED_BY) VALUES(2, &#39;00000000-0000-0000-0000-000000000002&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;P-2&#39;, &#39;Project two&#39;, 700000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_NAME, PROJECT_DESCRIPTION, REVENUE, CREATED_BY, LAST_MODIFIED_BY) VALUES(3, &#39;00000000-0000-0000-0000-000000000003&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;P-3&#39;, &#39;Project three&#39;, 2300000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_NAME, PROJECT_DESCRIPTION, REVENUE, CREATED_BY, LAST_MODIFIED_BY) VALUES(4, &#39;00000000-0000-0000-0000-000000000004&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;P-4&#39;, &#39;Project four&#39;, 0.0, &#39;unknown&#39;, &#39;unknown&#39;);

-- EMPLOYEE
INSERT INTO EMPLOYEE(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_CODE, EMPLOYEE_NAME, COMPENSATION, CREATED_BY, LAST_MODIFIED_BY) VALUES(1, &#39;00000000-0000-0000-0000-000000000001&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;EC-1&#39;, &#39;One First&#39;, 120000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_CODE, EMPLOYEE_NAME, COMPENSATION, CREATED_BY, LAST_MODIFIED_BY) VALUES(2, &#39;00000000-0000-0000-0000-000000000002&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;EC-2&#39;, &#39;Two Second&#39;, 240000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_CODE, EMPLOYEE_NAME, COMPENSATION, CREATED_BY, LAST_MODIFIED_BY) VALUES(3, &#39;00000000-0000-0000-0000-000000000003&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;EC-3&#39;, &#39;Three Third&#39;, 190000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_CODE, EMPLOYEE_NAME, COMPENSATION, CREATED_BY, LAST_MODIFIED_BY) VALUES(4, &#39;00000000-0000-0000-0000-000000000004&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;EC-4&#39;, &#39;Four Forth&#39;, 85000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_CODE, EMPLOYEE_NAME, COMPENSATION, CREATED_BY, LAST_MODIFIED_BY) VALUES(5, &#39;00000000-0000-0000-0000-000000000005&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;EC-5&#39;, &#39;Five Fifth&#39;, 300000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_CODE, EMPLOYEE_NAME, COMPENSATION, CREATED_BY, LAST_MODIFIED_BY) VALUES(6, &#39;00000000-0000-0000-0000-000000000006&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;EC-6&#39;, &#39;Six Sixth&#39;, 275000.00, &#39;unknown&#39;, &#39;unknown&#39;);

-- SUBSCRIPTION
INSERT INTO SUBSCRIPTION(ID, AUDIT_ID, IN_UTC, OUT_UTC, SUBSCRIPTION_CODE, SUBSCRIPTION_NAME, FEES, CREATED_BY, LAST_MODIFIED_BY) VALUES(1, &#39;00000000-0000-0000-0000-000000000001&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;SUB-1&#39;, &#39;Subscription 1&#39;, 8000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO SUBSCRIPTION(ID, AUDIT_ID, IN_UTC, OUT_UTC, SUBSCRIPTION_CODE, SUBSCRIPTION_NAME, FEES, CREATED_BY, LAST_MODIFIED_BY) VALUES(2, &#39;00000000-0000-0000-0000-000000000002&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;SUB-2&#39;, &#39;Subscription 2&#39;, 24000.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO SUBSCRIPTION(ID, AUDIT_ID, IN_UTC, OUT_UTC, SUBSCRIPTION_CODE, SUBSCRIPTION_NAME, FEES, CREATED_BY, LAST_MODIFIED_BY) VALUES(3, &#39;00000000-0000-0000-0000-000000000003&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;SUB-3&#39;, &#39;Subscription 3&#39;, 3500.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO SUBSCRIPTION(ID, AUDIT_ID, IN_UTC, OUT_UTC, SUBSCRIPTION_CODE, SUBSCRIPTION_NAME, FEES, CREATED_BY, LAST_MODIFIED_BY) VALUES(4, &#39;00000000-0000-0000-0000-000000000004&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;SUB-4&#39;, &#39;Subscription 4&#39;, 30200.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO SUBSCRIPTION(ID, AUDIT_ID, IN_UTC, OUT_UTC, SUBSCRIPTION_CODE, SUBSCRIPTION_NAME, FEES, CREATED_BY, LAST_MODIFIED_BY) VALUES(5, &#39;00000000-0000-0000-0000-000000000005&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;SUB-5&#39;, &#39;Subscription 5&#39;, 850.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO SUBSCRIPTION(ID, AUDIT_ID, IN_UTC, OUT_UTC, SUBSCRIPTION_CODE, SUBSCRIPTION_NAME, FEES, CREATED_BY, LAST_MODIFIED_BY) VALUES(6, &#39;00000000-0000-0000-0000-000000000006&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;SUB-6&#39;, &#39;Subscription 6&#39;, 1400.00, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO SUBSCRIPTION(ID, AUDIT_ID, IN_UTC, OUT_UTC, SUBSCRIPTION_CODE, SUBSCRIPTION_NAME, FEES, CREATED_BY, LAST_MODIFIED_BY) VALUES(7, &#39;00000000-0000-0000-0000-000000000007&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, &#39;SUB-7&#39;, &#39;Subscription 7&#39;, 2200.00, &#39;unknown&#39;, &#39;unknown&#39;);


-- PROJECT-EMPLOYEE-MAP
--  PROJECT 1
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(1, &#39;00000000-0000-0000-0000-000000000001&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 1, 1, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(2, &#39;00000000-0000-0000-0000-000000000002&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 1, 3, &#39;unknown&#39;, &#39;unknown&#39;);
--  PROJECT 2
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(3, &#39;00000000-0000-0000-0000-000000000003&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 2, 2, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(4, &#39;00000000-0000-0000-0000-000000000004&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 2, 4, &#39;unknown&#39;, &#39;unknown&#39;);
-- PROJECT 3
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(5, &#39;00000000-0000-0000-0000-000000000005&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 3, 1, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(6, &#39;00000000-0000-0000-0000-000000000006&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 3, 2, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(7, &#39;00000000-0000-0000-0000-000000000007&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 3, 3, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO PROJECT_EMPLOYEE_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, PROJECT_ID, EMPLOYEE_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(8, &#39;00000000-0000-0000-0000-000000000008&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 3, 4, &#39;unknown&#39;, &#39;unknown&#39;);

-- EMPLOYEE-SUBSCRIPTION-MAP
--  EMPLOYEE-1
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(1, &#39;00000000-0000-0000-0000-000000000001&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 1, 1, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(2, &#39;00000000-0000-0000-0000-000000000002&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 1, 2, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(3, &#39;00000000-0000-0000-0000-000000000003&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 1, 3, &#39;unknown&#39;, &#39;unknown&#39;);
--  EMPLOYEE-2
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(4, &#39;00000000-0000-0000-0000-000000000004&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 2, 1, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(5, &#39;00000000-0000-0000-0000-000000000005&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 2, 2, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(6, &#39;00000000-0000-0000-0000-000000000006&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 2, 3, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(7, &#39;00000000-0000-0000-0000-000000000007&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 2, 4, &#39;unknown&#39;, &#39;unknown&#39;);
--  EMPLOYEE-3
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(8, &#39;00000000-0000-0000-0000-000000000008&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 3, 1, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(9, &#39;00000000-0000-0000-0000-000000000009&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 3, 3, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(10, &#39;00000000-0000-0000-0000-000000000010&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 3, 5, &#39;unknown&#39;, &#39;unknown&#39;);
--  EMPLOYEE-4
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(11, &#39;00000000-0000-0000-0000-000000000011&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 4, 2, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(12, &#39;00000000-0000-0000-0000-000000000012&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 4, 4, &#39;unknown&#39;, &#39;unknown&#39;);
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(13, &#39;00000000-0000-0000-0000-000000000013&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 4, 6, &#39;unknown&#39;, &#39;unknown&#39;);
--  EMPLOYEE-5
INSERT INTO EMPLOYEE_SUBSCRIPTION_MAP(ID, AUDIT_ID, IN_UTC, OUT_UTC, EMPLOYEE_ID, SUBSCRIPTION_ID, CREATED_BY, LAST_MODIFIED_BY) VALUES(14, &#39;00000000-0000-0000-0000-000000000014&#39;, CURRENT_TIMESTAMP - CURRENT_TIMEZONE, &#39;9999-12-31&#39;, 5, 1, &#39;unknown&#39;, &#39;unknown&#39;);
</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><p>Make sure to add statement to alter the HIBERNATE_SEQUENCE</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">alter sequence HIBERNATE_SEQUENCE restart with 101</pre>
</div></div></td></tr></tbody></table></div><h1 id="HydrateDatabase-AddDataSourceConfigurationclasstoconfigpackage">Add DataSource Configuration class to <code>config</code> package</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Configuration
@Profile({&quot;db2&quot;})
public class DataSourceConfig
{
    @Value(&quot;${datasource.driver-class-name}&quot;)
    private String dataSourceDriverClass;

    @Value(&quot;${datasource.url}&quot;)
    private String dataSourceUrl;

    @Value(&quot;${datasource.username}&quot;)
    private String username;

    @Value(&quot;${datasource.password}&quot;)
    private String password;

    @Bean
    public DataSource getDataSource()
    {
        return DataSourceBuilder
                .create()
                .username(username)
                .password(password)
                .url(dataSourceUrl)
                .driverClassName(dataSourceDriverClass)
                .build();
    }
}</pre>
</div></div></td></tr></tbody></table></div><h1 id="HydrateDatabase-AddDB2Dependencytopom.xml">Add DB2 Dependency to pom.xml</h1><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">&lt;dependency&gt;
   &lt;groupId&gt;com.ibm.db2&lt;/groupId&gt;
   &lt;artifactId&gt;db2jcc4&lt;/artifactId&gt;
   &lt;version&gt;10.5.7.3.69.49&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div></div></td></tr></tbody></table></div><p><br/></p><h1 id="HydrateDatabase-AddConfigurationtoRunwiththedatabase">Add Configuration to Run with the database</h1><p>Create new application properties file for running with the database</p><p>Create Run Configuration for DB</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Name:</strong></p></th><td class="confluenceTd"><p><code>db2</code></p></td></tr><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Main Class:</strong></p></th><td class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">com.spring.subscription.tracker.subscriptiontracker.SubscriptionTrackerApplication</pre>
</div></div></td></tr><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Program Args:</strong></p></th><td class="confluenceTd"><ul><li><p>-spring.profiles.active=db2</p></li></ul></td></tr></tbody></table></div><p>Note that the name of active profile must be specified in the <code>@Profile</code> annotation of the <code>DataSourceConfig</code> class</p><p><code>application-db2.properties</code></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.default_schema=SOD_OTHER
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.DB2Dialect

datasource.url=jdbc:db2://nyg13qi8-vip.ny.fw.gs.com:56834/ntrkdi02
datasource.username=promproxydb
datasource.password=AshwinR0cks!
datasource.driver-class-name=com.ibm.db2.jcc.DB2Driver</pre>
</div></div></td></tr></tbody></table></div><p>Create new property files in resources directory along with corresponding configurations:</p><p><code>application-h2.properties</code></p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">application-h2.properties</pre>
</div></div></td></tr></tbody></table></div><h1 id="HydrateDatabase-Saveuseridandpasswordinencryptedform">Save userid and password in encrypted form</h1><p>Add file with <code>main</code> method to the root level package to encrypt</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">public class SecurityEncoder
{
    private static final String SECRET = &quot;Ym55bWVsbG9uc2VjdXJpdHltYXN0ZXI=&quot;;
    private static final byte [] SALT = { (byte)0xc3, (byte)0x8a, (byte)0xfc, (byte)0x2b,  (byte)0xb1, (byte)0x3c, (byte)0xf2, (byte)0xee };
    private static final int ITERATIONS = 20;

    public static String encrypt(String input)
    {
        byte [] text = encrypt(input.getBytes());
        return encodeToBase64(text);
    }

    public static String  decrypt(String input)
    {
        byte [] encrypted = decodeBase64ForBytes(input);
        byte [] decrypted = decrypt(encrypted);
        return new String(decrypted);
    }

    private static byte[] encrypt(byte[] input)
    {
        try
        {
            PBEParameterSpec pbeParamSpec = new PBEParameterSpec(SALT, ITERATIONS);
            PBEKeySpec pbeKeySpec = new PBEKeySpec(decodeBase64(SECRET).toCharArray());

            SecretKeyFactory keyFac = SecretKeyFactory.getInstance(&quot;PBEWithMD5AndDES&quot;);
            SecretKey pbeKey = keyFac.generateSecret(pbeKeySpec);
            Cipher pbeCipher = Cipher.getInstance(&quot;PBEWithMD5AndDES&quot;);

            pbeCipher.init(Cipher.ENCRYPT_MODE, pbeKey, pbeParamSpec);

            byte[] cipherText = pbeCipher.doFinal(input);

            return cipherText;
        }
        catch(Exception e)
        {
            throw new RuntimeException(&quot;Failed to encrypt&quot;, e);
        }
    }

    private static byte[] decrypt(byte[] input)
    {
      try
      {
            PBEParameterSpec  pbeParameterSpec = new PBEParameterSpec(SALT, ITERATIONS);
            SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(&quot;PBEWithMD5AndDES&quot;);
            SecretKey key = secretKeyFactory.generateSecret(new PBEKeySpec(decodeBase64(SECRET).toCharArray()));
            Cipher cipher = Cipher.getInstance(&quot;PBEWithMD5AndDES&quot;);
            cipher.init(Cipher.DECRYPT_MODE, key, pbeParameterSpec);
            return cipher.doFinal(input);
        }
        catch(Exception e)
        {
            throw new RuntimeException(&quot;Failed to decrypt&quot;, e);
        }
    }


    private static String encodeToBase64(byte [] input)
    {
      return Base64.getEncoder().encodeToString(input);
    }

    private static String decodeBase64(String input)
    {
        return new String(Base64.getDecoder().decode(input.getBytes()));
    }

    private static byte [] decodeBase64ForBytes(String input)
    {
      return Base64.getDecoder().decode(input.getBytes());
    }

    public static void main(String [] args)
    {
        SecurityEncoder encoder = new SecurityEncoder();

        String encrypted = encoder.encrypt(args[0]);
        System.out.println(encrypted);

        String decrypted = encoder.decrypt(encrypted);
        System.out.println(decrypted);
    }
}</pre>
</div></div></td></tr></tbody></table></div><p>Execute this file and supply userid and password as args.</p><p>Encrypt userId and Password</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><br/></p></th><td class="confluenceTd"><p>Actual</p></td><td class="confluenceTd"><p>Encrypted</p></td></tr><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>User ID</strong></p></th><td class="confluenceTd"><p><code>promproxydb</code></p></td><td class="confluenceTd"><p><code>tMkX5NSQ4E//Q7u+0GDAbw==</code></p></td></tr><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Password</strong></p></th><td class="confluenceTd"><p><code>AshwinR0cks!</code></p></td><td class="confluenceTd"><p><code>Q770LtFMSBYr7SA4AIx78A==</code></p></td></tr></tbody></table></div><p>Modify <code>application-db2.properties</code> to use encrypted userId and password</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">spring.jpa.properties.hibernate.default_schema=SOD_OTHER
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.DB2Dialect

datasource.url=jdbc:db2://nyg13qi8-vip.ny.fw.gs.com:56834/ntrkdi02
datasource.username=tMkX5NSQ4E//Q7u+0GDAbw==
datasource.password=Q770LtFMSBYr7SA4AIx78A==

datasource.driver-class-name=com.ibm.db2.jcc.DB2Driver</pre>
</div></div></td></tr></tbody></table></div><p>Modify DataSourceConfig to decrypt userId and password.</p><div class="table-wrap"><table data-layout="default" class="confluenceTable"><tbody><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">@Configuration
@Profile({&quot;db2&quot;})
public class DataSourceConfig
{
    @Value(&quot;${datasource.driver-class-name}&quot;)
    private String dataSourceDriverClass;

    @Value(&quot;${datasource.url}&quot;)
    private String dataSourceUrl;

    @Value(&quot;${datasource.username}&quot;)
    private String username;

    @Value(&quot;${datasource.password}&quot;)
    private String password;

    @Bean
    public DataSource getDataSource()
    {
        String username = SecurityEncoder.decrypt(this.username);
        String password = SecurityEncoder.decrypt(this.password);

        return DataSourceBuilder
                .create()
                .username(username)
                .password(password)
                .url(dataSourceUrl)
                .driverClassName(dataSourceDriverClass)
                .build();
    }
}</pre>
</div></div></td></tr></tbody></table></div><p />
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Feb 12, 2021 23:36</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
